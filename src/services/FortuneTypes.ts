/**
 * 다양한 운세 종류 생성기
 * 각 운세는 출처가 명확한 전통 자료를 기반으로 합니다.
 */

// ============================================
// 공통: 용신 기반 행운 정보 (하도낙서 河圖洛書 기반)
// ============================================

// 오행별 행운 숫자 (하도낙서 기반)
const ELEMENT_LUCKY_NUMBERS: Record<string, string> = {
  '목': '3, 8',
  '화': '2, 7',
  '토': '5, 10',
  '금': '4, 9',
  '수': '1, 6',
};

// 오행별 행운 색상
const ELEMENT_LUCKY_COLORS: Record<string, string> = {
  '목': '초록색',
  '화': '빨간색',
  '토': '노란색',
  '금': '흰색',
  '수': '검은색',
};

// 오행별 행운 방향
const ELEMENT_LUCKY_DIRECTIONS: Record<string, string> = {
  '목': '동쪽',
  '화': '남쪽',
  '토': '중앙',
  '금': '서쪽',
  '수': '북쪽',
};

// 천간에서 오행 추출
const STEM_TO_ELEMENT: Record<string, string> = {
  '갑': '목', '을': '목', '병': '화', '정': '화', '무': '토',
  '기': '토', '경': '금', '신': '금', '임': '수', '계': '수',
};

// 오행 상생 관계
const FIVE_ELEMENTS_GENERATES: Record<string, string> = {
  '목': '화', '화': '토', '토': '금', '금': '수', '수': '목',
};

/**
 * 일간(dayMaster)에서 용신을 계산하고 해당 오행의 행운 정보 반환
 * 억부용신(抑扶用神) 간소화 버전: 일간이 강하면 설기, 약하면 생조
 */
export function getYongsinBasedLuckyInfo(dayMaster: string): {
  yongsinElement: string;
  number: string;
  color: string;
  direction: string;
} {
  const dayMasterElement = STEM_TO_ELEMENT[dayMaster] || '목';

  // 간소화된 용신 결정: 일간 오행을 생해주는 오행이 용신 (생조 방식)
  // 실제로는 사주 전체 분석이 필요하지만, 여기서는 일관성을 위해 생조 방식 사용
  const generatesMe = Object.keys(FIVE_ELEMENTS_GENERATES).find(
    k => FIVE_ELEMENTS_GENERATES[k] === dayMasterElement
  ) || '수';

  return {
    yongsinElement: generatesMe,
    number: ELEMENT_LUCKY_NUMBERS[generatesMe] || '5, 10',
    color: ELEMENT_LUCKY_COLORS[generatesMe] || '노란색',
    direction: ELEMENT_LUCKY_DIRECTIONS[generatesMe] || '중앙',
  };
}

// ============================================
// 신년운세 (명리학 대운/세운론 기반)
// ============================================

// 60갑자 천간지지 순환 (년도 계산용)
const HEAVENLY_STEMS_CYCLE = ['갑', '을', '병', '정', '무', '기', '경', '신', '임', '계'];
const EARTHLY_BRANCHES_CYCLE = ['자', '축', '인', '묘', '진', '사', '오', '미', '신', '유', '술', '해'];
const BRANCH_ANIMALS = ['쥐', '소', '호랑이', '토끼', '용', '뱀', '말', '양', '원숭이', '닭', '개', '돼지'];
const BRANCH_HANJA = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
const STEM_HANJA = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];

// 현재 연도의 천간지지 계산
function getYearGanji(year: number): { stem: string; branch: string; stemHanja: string; branchHanja: string; animal: string } {
  const stemIndex = (year - 4) % 10;
  const branchIndex = (year - 4) % 12;
  return {
    stem: HEAVENLY_STEMS_CYCLE[stemIndex],
    branch: EARTHLY_BRANCHES_CYCLE[branchIndex],
    stemHanja: STEM_HANJA[stemIndex],
    branchHanja: BRANCH_HANJA[branchIndex],
    animal: BRANCH_ANIMALS[branchIndex],
  };
}

// 천간 오행
const STEM_ELEMENTS: Record<string, string> = {
  '갑': '목', '을': '목', '병': '화', '정': '화', '무': '토',
  '기': '토', '경': '금', '신': '금', '임': '수', '계': '수',
};

// 십신 관계 계산
function getTenGodRelation(myStem: string, yearStem: string): string {
  const myElement = STEM_ELEMENTS[myStem];
  const yearElement = STEM_ELEMENTS[yearStem];

  const generates: Record<string, string> = { '목': '화', '화': '토', '토': '금', '금': '수', '수': '목' };
  const controls: Record<string, string> = { '목': '토', '토': '수', '수': '화', '화': '금', '금': '목' };

  const myYin = ['을', '정', '기', '신', '계'].includes(myStem);
  const yearYin = ['을', '정', '기', '신', '계'].includes(yearStem);
  const samePolarity = myYin === yearYin;

  if (myElement === yearElement) return samePolarity ? '비견' : '겁재';
  if (generates[myElement] === yearElement) return samePolarity ? '식신' : '상관';
  if (generates[yearElement] === myElement) return samePolarity ? '정인' : '편인';
  if (controls[myElement] === yearElement) return samePolarity ? '정재' : '편재';
  if (controls[yearElement] === myElement) return samePolarity ? '정관' : '편관';
  return '비견';
}

// 십신별 운세 해석 (대폭 확장)
const TEN_GOD_FORTUNES: Record<string, {
  summary: string;
  score: number;
  advice: string;
  detailed: {
    overall: string;
    wealth: string;
    career: string;
    love: string;
    health: string;
    relationships: string;
    caution: string;
  };
  luckyMonths: number[];
  cautionMonths: number[];
}> = {
  '비견': {
    summary: '동료나 형제와의 협력이 중요한 해입니다. 비견은 나와 같은 오행으로, 경쟁자이자 동반자의 기운을 의미합니다.',
    score: 75,
    advice: '혼자서 무리하기보다 주변의 도움을 받으세요. 협력이 경쟁보다 더 큰 성과를 가져옵니다.',
    detailed: {
      overall: '올해는 나와 비슷한 성향의 사람들과의 인연이 많아지는 해입니다. 형제자매, 동료, 친구와의 관계가 중요해지며, 함께 협력하면 혼자서는 이루지 못할 큰 일을 성취할 수 있습니다. 다만 같은 것을 두고 경쟁하는 상황도 생길 수 있으니 조율 능력이 필요합니다.',
      wealth: '재물운은 보통입니다. 큰 횡재보다는 꾸준한 수입이 예상됩니다. 동업이나 공동 투자는 신중하게 판단해야 합니다. 파트너와의 이익 분배 문제로 갈등이 생길 수 있으니 처음부터 명확히 정하세요.',
      career: '직장에서 동료들과의 팀워크가 중요합니다. 혼자만의 성과보다 팀 전체의 성공에 기여할 때 오히려 더 큰 인정을 받게 됩니다. 경쟁자가 나타날 수 있지만, 적대시하기보다 건전한 경쟁으로 함께 성장하세요.',
      love: '비슷한 취미나 관심사를 가진 사람과의 인연이 생길 수 있습니다. 같은 목표를 향해 함께 나아가는 동반자적 관계가 좋습니다. 기존 연인과는 친구 같은 편안함이 깊어집니다.',
      health: '건강은 전반적으로 양호하나, 과로에 주의하세요. 동료들과 함께하는 운동이나 단체 활동이 건강에 도움이 됩니다.',
      relationships: '형제자매나 절친한 친구와의 관계가 깊어집니다. 다만 이해관계가 얽힌 상황에서는 갈등이 생길 수 있으니 미리 조율하세요.',
      caution: '지나친 자존심이나 고집은 갈등의 원인이 됩니다. 때로는 양보하는 것이 더 현명합니다.',
    },
    luckyMonths: [3, 6, 9],
    cautionMonths: [4, 10],
  },
  '겁재': {
    summary: '경쟁과 도전의 해입니다. 겁재는 나의 재물을 빼앗는 기운으로, 강한 경쟁심과 추진력을 상징합니다.',
    score: 72,
    advice: '과한 경쟁심은 줄이고 협력을 모색하세요. 지는 것이 이기는 것일 때도 있습니다.',
    detailed: {
      overall: '올해는 경쟁이 치열해지고 도전 과제가 많아지는 해입니다. 겁재의 기운은 강한 추진력과 승부욕을 불러일으키지만, 동시에 손실이나 갈등의 위험도 있습니다. 큰 욕심을 부리기보다 현실적인 목표를 세우고 한 발씩 나아가세요.',
      wealth: '재물의 변동이 큰 해입니다. 뜻하지 않게 돈이 나갈 일이 생기거나, 투자에서 손실을 볼 수 있습니다. 보증이나 대출은 절대 피하세요. 특히 친한 사람과의 금전 거래는 관계를 해칠 수 있으니 삼가세요.',
      career: '직장에서 경쟁자가 나타나거나 압박감이 커질 수 있습니다. 하지만 이를 자극제로 삼아 더 열심히 노력하면 오히려 성장의 기회가 됩니다. 무리하게 성과를 내려 하기보다 실력을 쌓는 데 집중하세요.',
      love: '연애에서도 경쟁 상황이 생길 수 있습니다. 삼각관계나 라이벌의 등장에 주의하세요. 기존 연인과는 사소한 일로 다툼이 생기기 쉬우니 양보하는 마음이 필요합니다.',
      health: '스트레스로 인한 건강 악화에 주의하세요. 경쟁심이 과하면 심장, 혈압에 무리가 갈 수 있습니다. 이완과 휴식을 통해 마음의 여유를 찾으세요.',
      relationships: '친구나 동료와의 관계에서 갈등이 생기기 쉽습니다. 같은 것을 두고 경쟁하는 상황을 피하고, 서로 다른 영역을 추구하세요.',
      caution: '욕심을 버리세요. 지나친 욕심은 손실을 부르고, 무리한 도전은 실패를 초래합니다.',
    },
    luckyMonths: [2, 5],
    cautionMonths: [1, 7, 11],
  },
  '식신': {
    summary: '건강운과 식복이 좋은 해입니다. 식신은 먹는 복과 표현력, 창조력을 상징하는 길한 별입니다.',
    score: 83,
    advice: '건강관리에 투자하면 좋은 결과가 있습니다. 맛있는 음식과 좋은 사람들과 함께하세요.',
    detailed: {
      overall: '올해는 식복이 풍성하고 건강운이 좋은 대길한 해입니다. 식신은 명리학에서 가장 온화하고 길한 별 중 하나로, 먹는 것에 복이 있고 표현력과 재능이 발휘됩니다. 여유롭고 풍요로운 한 해가 예상되며, 정신적으로도 안정됩니다.',
      wealth: '안정적인 수입이 예상됩니다. 음식, 요식업, 콘텐츠, 교육 관련 분야에서 특히 좋은 성과가 있습니다. 큰 투기보다는 꾸준한 저축과 안정적인 투자가 좋습니다.',
      career: '창의적인 일이나 사람을 가르치는 일에서 빛을 발합니다. 직장에서는 원만한 인간관계를 유지하며 순탄하게 업무를 처리할 수 있습니다. 새로운 아이디어나 기획이 좋은 평가를 받습니다.',
      love: '연애운이 좋습니다. 함께 맛있는 음식을 먹고 여유로운 시간을 보내면 관계가 더욱 깊어집니다. 새로운 인연도 음식점, 문화 행사 등에서 만날 수 있습니다.',
      health: '식신의 해에는 먹는 것과 소화기 건강이 중요합니다. 맛있는 것을 많이 먹게 되지만, 과식은 피하세요. 규칙적인 식사와 가벼운 운동이 건강의 비결입니다.',
      relationships: '대인관계가 원만하고 사람들과의 교류가 즐겁습니다. 모임이나 파티에서 좋은 시간을 보내게 됩니다.',
      caution: '게으름에 빠지기 쉬운 해이기도 합니다. 너무 편안함에 안주하면 성장이 멈출 수 있습니다.',
    },
    luckyMonths: [1, 4, 7, 10],
    cautionMonths: [6],
  },
  '상관': {
    summary: '표현력이 좋아지며 예술이나 창작 활동에 좋은 해입니다. 상관은 파격과 자유, 독창성을 상징합니다.',
    score: 78,
    advice: '긍정적인 표현으로 좋은 인연을 만드세요. 말조심은 필수입니다.',
    detailed: {
      overall: '올해는 표현력이 극대화되고 창의성이 폭발하는 해입니다. 상관은 기존의 틀을 깨고 새로운 것을 창조하는 힘을 가지고 있습니다. 예술, 글쓰기, 공연, 디자인 등 창작 분야에서 뛰어난 성과를 낼 수 있습니다. 다만 입이 가벼워지기 쉬우니 말조심이 필요합니다.',
      wealth: '창의적인 활동을 통해 수입을 올릴 수 있습니다. 프리랜서, 크리에이터, 예술가에게 좋은 해입니다. 다만 충동적인 지출에 주의하세요. 기분에 따라 돈을 쓰면 나중에 후회할 수 있습니다.',
      career: '직장에서는 독창적인 아이디어로 주목받을 수 있습니다. 하지만 상사나 기존 체계와 마찰이 생길 수도 있습니다. 새로운 것을 제안할 때는 방법을 신중하게 선택하세요. 이직이나 독립을 고려해 볼 수 있는 시기입니다.',
      love: '매력이 빛나는 해입니다. 자유분방하고 재미있는 모습이 이성에게 어필합니다. 다만 가벼운 말이 오해를 불러올 수 있으니 진심은 진지하게 전하세요.',
      health: '정신적 스트레스가 신체에 영향을 줄 수 있습니다. 특히 호흡기, 피부에 주의하세요. 예술 활동이나 표현을 통해 스트레스를 해소하면 좋습니다.',
      relationships: '솔직한 표현이 장점이지만, 지나치면 관계를 해칠 수 있습니다. 특히 윗사람에게는 언행을 조심하세요.',
      caution: '말 한마디가 큰 파장을 일으킬 수 있는 해입니다. 생각한 것의 절반만 말하고, 그것도 한 번 더 생각한 후에 말하세요.',
    },
    luckyMonths: [3, 8, 11],
    cautionMonths: [2, 5, 9],
  },
  '정재': {
    summary: '재물운이 좋으며 투자나 사업에서 좋은 성과가 기대됩니다. 정재는 정당한 노력의 대가, 안정적인 수입을 상징합니다.',
    score: 90,
    advice: '안정적인 투자가 큰 수익으로 돌아옵니다. 정도를 걸으면 복이 옵니다.',
    detailed: {
      overall: '올해는 재물운이 크게 상승하는 대길한 해입니다. 정재는 명리학에서 가장 길한 재물의 별로, 정당한 노력으로 얻는 안정적인 수입을 의미합니다. 꾸준히 해온 일에서 결실을 거두고, 재물이 모이는 좋은 시기입니다.',
      wealth: '재물운이 매우 좋습니다. 월급, 사업 수익, 투자 수익 등 정당한 방법으로 돈이 들어옵니다. 저축, 부동산, 장기 투자에 좋은 시기입니다. 다만 욕심을 부리지 말고 안정적으로 운용하세요.',
      career: '직장에서 인정받고 보상을 받습니다. 승진이나 성과급의 기회가 있으며, 사업자는 안정적인 거래처가 생기거나 매출이 증가합니다. 성실한 자세가 좋은 결과를 가져옵니다.',
      love: '경제적으로 안정되면서 연애나 결혼에도 긍정적인 영향을 미칩니다. 결혼을 고려하거나 가정을 꾸리기에 좋은 시기입니다. 물질적 여유가 관계의 안정으로 이어집니다.',
      health: '마음의 여유가 건강에도 좋은 영향을 줍니다. 건강 관리에 투자하면 효과가 배가됩니다. 건강검진, 운동, 좋은 음식에 돈을 쓰세요.',
      relationships: '주변 사람들에게 베풀 수 있는 여유가 생깁니다. 관계가 더욱 풍성해지고, 귀인이 나타날 수 있습니다.',
      caution: '재물이 들어오는 해일수록 겸손해야 합니다. 자만하거나 과시하면 시기를 받을 수 있습니다.',
    },
    luckyMonths: [1, 5, 9, 12],
    cautionMonths: [7],
  },
  '편재': {
    summary: '부수입이나 부업에서 좋은 성과가 있을 수 있습니다. 편재는 횡재, 투기, 비정기적 수입을 상징합니다.',
    score: 82,
    advice: '새로운 수입원을 적극적으로 모색하세요. 다만 도박은 금물입니다.',
    detailed: {
      overall: '올해는 예상치 못한 수입이나 부수입의 기회가 있는 해입니다. 편재는 정기적인 월급 외에 부업, 투자, 횡재 등을 의미합니다. 기회를 잘 잡으면 큰 수익을 올릴 수 있지만, 변동성도 크니 주의가 필요합니다.',
      wealth: '본업 외에 부수입을 올릴 기회가 많습니다. 부업, 투자, 재테크에 관심을 가져보세요. 다만 투기성이 강한 것은 피하고, 분산 투자로 위험을 줄이세요. 도박이나 무리한 투자는 절대 금물입니다.',
      career: '직장 외에 다른 일을 병행하거나 새로운 사업 아이템을 발견할 수 있습니다. 활동적이고 다재다능한 면이 빛을 발합니다. 다만 본업에 소홀하지 않도록 주의하세요.',
      love: '자유롭고 활동적인 연애를 즐기게 됩니다. 여러 사람을 만나며 인연을 탐색할 수 있습니다. 다만 너무 많은 이성과 교류하면 복잡해질 수 있으니 적절히 정리하세요.',
      health: '활동량이 많아지면서 체력 소모에 주의하세요. 불규칙한 생활 패턴이 건강에 영향을 줄 수 있습니다.',
      relationships: '다양한 사람들과 인연을 맺게 됩니다. 사교성이 좋아지고 네트워크가 넓어집니다.',
      caution: '편재는 들어오는 것만큼 나가는 것도 많을 수 있습니다. 들어온 돈을 쓰기 전에 일부는 반드시 저축하세요.',
    },
    luckyMonths: [2, 6, 10],
    cautionMonths: [4, 8],
  },
  '정관': {
    summary: '직장운이 좋으며 승진이나 취업에 유리한 해입니다. 정관은 명예, 지위, 정당한 권위를 상징합니다.',
    score: 88,
    advice: '책임감 있는 자세가 좋은 결과를 가져옵니다. 규칙을 지키면 복이 옵니다.',
    detailed: {
      overall: '올해는 사회적 지위가 높아지고 명예가 상승하는 대길한 해입니다. 정관은 정당한 권위와 직장, 승진, 합격을 상징합니다. 시험, 취업, 승진에서 좋은 결과가 기대되며, 사회적으로 인정받는 시기입니다.',
      wealth: '안정적인 수입이 예상됩니다. 직장에서의 보상이나 성과급이 있을 수 있습니다. 무리한 투자보다 안정적인 저축이 좋습니다.',
      career: '직장에서 인정받고 승진할 기회가 있습니다. 취업 준비생은 좋은 회사에 합격할 가능성이 높습니다. 공무원, 대기업, 전문직 등 안정적인 직업에 유리합니다. 책임감 있는 자세가 중요합니다.',
      love: '결혼을 고려하거나 진지한 관계로 발전하기 좋은 시기입니다. 상대방이나 상대방 가족에게 좋은 인상을 줄 수 있습니다. 품격 있는 행동이 매력으로 작용합니다.',
      health: '규칙적인 생활이 건강에 도움이 됩니다. 스트레스 관리에 신경 쓰고, 정기 검진을 받으세요.',
      relationships: '윗사람이나 권위자와의 관계가 좋아집니다. 귀인을 만나 도움을 받을 수 있습니다.',
      caution: '규칙을 어기거나 탈법적인 행동은 큰 화를 부릅니다. 정도를 걷는 것이 가장 안전합니다.',
    },
    luckyMonths: [1, 3, 7, 11],
    cautionMonths: [5],
  },
  '편관': {
    summary: '변화와 도약의 기회가 있는 해입니다. 편관(칠살)은 도전, 압박, 변혁을 상징합니다.',
    score: 72,
    advice: '변화를 기회로 삼아 적극적으로 도전하세요. 준비된 자에게는 비상의 기회입니다.',
    detailed: {
      overall: '올해는 변화와 도전이 많은 해입니다. 편관(칠살)은 강한 압박과 경쟁, 그리고 그것을 뚫고 나가는 변혁의 힘을 상징합니다. 힘든 상황이 생길 수 있지만, 이를 극복하면 크게 성장합니다. 준비되지 않으면 힘든 해가 될 수 있으니 마음의 준비를 하세요.',
      wealth: '재물의 변동이 있을 수 있습니다. 예상치 못한 지출이나 투자 손실에 주의하세요. 안정적인 것을 지키는 데 집중하고, 새로운 투자는 신중하게 하세요.',
      career: '직장에서 압박감이 커지거나 도전적인 업무가 주어질 수 있습니다. 하지만 이를 잘 해내면 크게 인정받습니다. 이직이나 전직의 기회가 생길 수도 있으니 준비해두세요.',
      love: '연애에서 갈등이 생기기 쉽습니다. 서로의 의견 차이로 다툼이 있을 수 있으니 인내심이 필요합니다. 너무 강하게 밀어붙이면 역효과가 납니다.',
      health: '스트레스로 인한 건강 문제에 주의하세요. 특히 심장, 혈압, 근육에 무리가 갈 수 있습니다. 격한 운동보다 이완 운동이 좋습니다.',
      relationships: '주변에서 압박을 받거나 경쟁자가 나타날 수 있습니다. 감정적으로 대응하지 말고 이성적으로 판단하세요.',
      caution: '올해는 몸을 사리고 무리하지 않는 것이 중요합니다. 위험한 일, 모험적인 투자는 피하세요.',
    },
    luckyMonths: [4, 8],
    cautionMonths: [1, 3, 6, 10, 12],
  },
  '정인': {
    summary: '학업운과 학습운이 좋으며 자격증이나 공부에 좋은 시기입니다. 정인은 학문, 어머니, 보호자를 상징합니다.',
    score: 85,
    advice: '배움에 투자하면 좋은 결실을 맺을 수 있습니다. 공부하기 최적의 해입니다.',
    detailed: {
      overall: '올해는 학업과 자기계발에 최적의 해입니다. 정인은 어머니의 보살핌처럼 당신을 보호하고 지원해주는 기운입니다. 새로운 것을 배우고 지식을 쌓기에 좋으며, 시험이나 자격증 취득에도 좋은 결과가 있습니다.',
      wealth: '직접적인 재물보다 지식과 능력 향상을 통해 장기적인 부를 쌓는 해입니다. 교육이나 자기계발에 투자하면 나중에 큰 수익으로 돌아옵니다.',
      career: '학습이 필요한 직종에서 성과가 좋습니다. 자격증, 승진 시험, 전문 교육 등에서 좋은 결과가 있습니다. 멘토나 귀인의 도움을 받기 쉽습니다.',
      love: '정신적인 교감이 깊어지는 해입니다. 지적인 대화나 함께 공부하는 활동이 관계를 돈독하게 합니다. 어머니 같은 따뜻한 사람과 인연이 생길 수 있습니다.',
      health: '정신적으로 안정되고 여유가 생깁니다. 마음이 편안하면 몸도 건강해집니다. 명상, 독서, 산책 등이 도움이 됩니다.',
      relationships: '어머니나 여성 어른과의 관계가 좋아집니다. 스승이나 멘토를 만나 배움을 얻을 수 있습니다.',
      caution: '너무 책만 보고 세상과 동떨어지지 않도록 주의하세요. 이론과 실천의 균형이 필요합니다.',
    },
    luckyMonths: [2, 5, 8, 11],
    cautionMonths: [7],
  },
  '편인': {
    summary: '창의적인 아이디어가 빛나는 해로 예술과 문화 분야에서 좋은 성과가 기대됩니다. 편인은 독창성과 직관을 상징합니다.',
    score: 80,
    advice: '새로운 분야에 도전해보세요. 남들과 다른 방식이 성공의 열쇠입니다.',
    detailed: {
      overall: '올해는 독창적인 생각과 창의성이 빛을 발하는 해입니다. 편인은 정통적인 학문보다 비주류, 대안, 창작, 영적인 분야를 상징합니다. 예술, 철학, 심리학, 점술, 대체 의학 등에 관심이 생기고 재능을 발휘할 수 있습니다.',
      wealth: '정통적인 방법보다 창의적이고 독특한 방법으로 수익을 올릴 수 있습니다. 예술 작품, 특허, 콘텐츠 등에서 가능성이 있습니다. 다만 안정적인 수입보다 변동이 있을 수 있습니다.',
      career: '창의적인 직종에서 빛을 발합니다. 예술가, 작가, 디자이너, 상담사, 대안 분야 전문가 등에게 좋은 해입니다. 직장에서는 색다른 아이디어로 주목받을 수 있습니다.',
      love: '독특한 사람에게 끌리거나 특별한 방식의 연애를 하게 될 수 있습니다. 정신적 교감이 중요하며, 평범한 데이트보다 특별한 경험을 함께 나누면 좋습니다.',
      health: '정신 건강에 신경 쓰세요. 창의적 활동이 스트레스 해소에 도움이 됩니다. 명상, 요가, 예술 치료 등이 좋습니다.',
      relationships: '독특하거나 예술적인 사람들과 인연이 생깁니다. 주류보다 비주류 그룹에서 좋은 인연을 만날 수 있습니다.',
      caution: '현실과 동떨어지지 않도록 주의하세요. 너무 이상에 치우치면 생활 기반이 흔들릴 수 있습니다.',
    },
    luckyMonths: [3, 6, 9, 12],
    cautionMonths: [1, 4],
  },
};

// 월별 운세 생성 (12운성 기반)
function generateMonthlyFortune(): Array<{month: number; content: string; luck: 'good' | 'normal' | 'bad'}> {
  const monthly = [];
  const monthlyHints = [
    { luck: 'good' as const, content: '새로운 시작에 좋은 달입니다. 계획했던 일을 추진하세요.' },
    { luck: 'normal' as const, content: '평온한 달입니다. 내실을 다지기 좋습니다.' },
    { luck: 'good' as const, content: '인간관계가 활발해지는 달입니다. 네트워킹에 좋습니다.' },
    { luck: 'normal' as const, content: '안정적인 달입니다. 큰 변화는 피하세요.' },
    { luck: 'good' as const, content: '재물운이 좋은 달입니다. 투자에 좋은 시기입니다.' },
    { luck: 'bad' as const, content: '주의가 필요한 달입니다. 건강관리에 신경쓰세요.' },
    { luck: 'good' as const, content: '직장운이 좋은 달입니다. 승진이나 이직에 좋습니다.' },
    { luck: 'normal' as const, content: '평화로운 달입니다. 가족과 시간을 보내세요.' },
    { luck: 'good' as const, content: '학업운이 좋은 달입니다. 공부나 자격증에 좋습니다.' },
    { luck: 'bad' as const, content: '구설수에 주의하세요. 말조심이 필요합니다.' },
    { luck: 'good' as const, content: '하반기 마무리에 좋은 달입니다. 성과를 정리하세요.' },
    { luck: 'normal' as const, content: '새해 준비에 좋은 달입니다. 계획을 세우세요.' },
  ];

  for (let i = 1; i <= 12; i++) {
    monthly.push({
      month: i,
      ...monthlyHints[i - 1],
    });
  }

  return monthly;
}

export function generateYearlyFortune(birthDate: string, dayMaster: string, targetDate: Date = new Date()) {
  const currentYear = targetDate.getFullYear();
  const yearInfo = getYearGanji(currentYear);
  const yearName = `${yearInfo.stem}${yearInfo.branch}년(${yearInfo.stemHanja}${yearInfo.branchHanja}年)`;
  const animalName = `${yearInfo.animal}띠 해`;

  // 십신 관계 계산
  const tenGod = getTenGodRelation(dayMaster, yearInfo.stem);
  const fortune = TEN_GOD_FORTUNES[tenGod] || TEN_GOD_FORTUNES['비견'];

  // 지지 오행 (올해 띠의 오행)
  const branchElements: Record<string, string> = {
    '자': '수', '축': '토', '인': '목', '묘': '목', '진': '토', '사': '화',
    '오': '화', '미': '토', '신': '금', '유': '금', '술': '토', '해': '수',
  };
  const yearElement = branchElements[yearInfo.branch] || '토';
  const elementNames: Record<string, string> = { '목': '木', '화': '火', '토': '土', '금': '金', '수': '水' };

  // 용신 색상
  const elementColors: Record<string, string> = { '목': '초록색', '화': '빨간색', '토': '노란색', '금': '흰색', '수': '검은색' };
  const elementNumbers: Record<string, string> = { '목': '3, 8', '화': '2, 7', '토': '5, 10', '금': '4, 9', '수': '1, 6' };
  const elementDirections: Record<string, string> = { '목': '동쪽', '화': '남쪽', '토': '중앙', '금': '서쪽', '수': '북쪽' };
  const elementItems: Record<string, string> = { '목': '식물', '화': '조명', '토': '도자기', '금': '금속 장신구', '수': '수정' };

  return {
    summary: `${currentYear}년 ${yearName}은 ${dayMaster} 일간에게 ${tenGod}(${tenGod === '비견' || tenGod === '겁재' ? '比劫' : tenGod})의 해입니다. ${fortune.summary}`,
    score: fortune.score,
    yearInfo: {
      year: currentYear,
      name: yearName,
      animal: animalName,
      tenGod: tenGod,
    },
    categories: [
      {
        emoji: '💰',
        title: '재물운',
        content: `${yearName}은 ${yearElement}(${elementNames[yearElement]})의 기운이 강한 해입니다. ${tenGod === '정재' || tenGod === '편재' ? '재물운이 특히 좋아 투자나 사업에서 좋은 성과가 기대됩니다.' : '재물의 흐름이 활발해지며, 꾸준한 노력이 결실을 맺습니다.'}`,
        score: tenGod === '정재' ? 90 : tenGod === '편재' ? 85 : 78,
        advice: '안정적인 재테크가 큰 수익으로 돌아옵니다.',
      },
      {
        emoji: '💼',
        title: '직장/사업운',
        content: `${tenGod === '정관' || tenGod === '편관' ? '직장운이 특히 좋은 해입니다. 승진이나 이직에 유리한 시기입니다.' : '변화의 기운이 있는 해입니다. 새로운 기회가 찾아올 수 있으니 준비하세요.'}`,
        score: tenGod === '정관' ? 88 : tenGod === '편관' ? 80 : 78,
        advice: '준비된 기회에 도전하면 좋은 결과가 있습니다.',
      },
      {
        emoji: '❤️',
        title: '애정운',
        content: '인연을 만나기 좋은 해입니다. 적극적으로 활동하면 좋은 만남이 있습니다. 연인이 있다면 관계가 더욱 깊어질 수 있습니다.',
        score: 75 + (fortune.score % 10),
        advice: '상대방의 이야기에 귀 기울이면 관계가 더 좋아집니다.',
      },
      {
        emoji: '🏥',
        title: '건강운',
        content: `${yearElement}(${elementNames[yearElement]}) 기운이 강한 해이므로 ${yearElement === '화' ? '심장, 혈압' : yearElement === '목' ? '간, 눈' : yearElement === '금' ? '폐, 피부' : yearElement === '수' ? '신장, 뼈' : '소화기'} 관련 건강에 신경 쓰세요.`,
        score: 72 + (fortune.score % 8),
        advice: '규칙적인 운동과 충분한 휴식이 건강의 비결입니다.',
      },
      {
        emoji: '👨‍👩‍👧‍👦',
        title: '형제/동료운',
        content: `${tenGod === '비견' || tenGod === '겁재' ? '형제자매나 동료와의 관계가 특히 중요한 해입니다. 협력하면 큰 성과를 얻을 수 있습니다.' : '주변 사람들과의 조화가 좋은 해입니다. 네트워킹이 새로운 기회를 가져옵니다.'}`,
        score: tenGod === '비견' ? 78 : 70 + (fortune.score % 10),
        advice: '협력과 배려가 좋은 관계를 만듭니다.',
      },
    ],
    monthly: generateMonthlyFortune(),
    luckyInfo: {
      ...getYongsinBasedLuckyInfo(dayMaster),
      item: elementItems[getYongsinBasedLuckyInfo(dayMaster).yongsinElement] || '도자기',
    },
    tip: `${currentYear}년은 ${yearInfo.animal}의 해입니다. ${fortune.advice}`,
  };
}

// ============================================
// 토정비결 (조선시대 토정 이지함 선생 저술 기반)
// ============================================

// 토정비결 괘(卦) 해석 (64괘 중 대표적인 것들)
const TOJEONG_FORTUNES: Array<{
  name: string;
  fortune: string;
  advice: string;
  lucky: 'great' | 'good' | 'normal' | 'caution';
}> = [
  {
    name: '건위천(乾爲天)',
    fortune: '하늘이 높고 넓으니 만사형통하는 상입니다. 적극적으로 나아가면 좋은 결과가 있을 것입니다.',
    advice: '겸손을 잃지 않으면 더 큰 복이 옵니다.',
    lucky: 'great',
  },
  {
    name: '곤위지(坤爲地)',
    fortune: '땅처럼 낮은 자세로 내실을 다지는 것이 좋은 해입니다. 욕심을 버리고 충실하게 생활하세요.',
    advice: '인내하면 때가 오니 조급해하지 마세요.',
    lucky: 'good',
  },
  {
    name: '수뢰둔(水雷屯)',
    fortune: '초창기의 어려움이 있으나 꾸준히 나아가면 결국 성공할 수 있습니다.',
    advice: '어려울 때일수록 기본에 충실하세요.',
    lucky: 'normal',
  },
  {
    name: '산수몽(山水蒙)',
    fortune: '배움의 해입니다. 새로운 것을 배우거나 실력을 쌓기에 좋은 해입니다.',
    advice: '스승이나 선배의 조언을 귀담아 들으세요.',
    lucky: 'good',
  },
  {
    name: '화천대유(火天大有)',
    fortune: '크게 얻는 상입니다. 재물운과 명예운이 함께 좋아지는 대길한 해입니다.',
    advice: '베풀면 더 큰 복이 돌아옵니다.',
    lucky: 'great',
  },
  {
    name: '지산겸(地山謙)',
    fortune: '겸손하면 복이 오는 해입니다. 낮은 자세로 일하면 인정받을 수 있습니다.',
    advice: '자만하지 말고 한결같이 노력하세요.',
    lucky: 'good',
  },
  {
    name: '택지췌(澤地萃)',
    fortune: '모이는 상입니다. 사람들이 모이고 기회가 모이니 적극적으로 활동하세요.',
    advice: '좋은 인연을 소중히 하세요.',
    lucky: 'great',
  },
  {
    name: '산지박(山地剝)',
    fortune: '주의가 필요한 해입니다. 무리하지 말고 현상 유지에 집중하세요.',
    advice: '새로운 일은 미루고 기존 일에 충실하세요.',
    lucky: 'caution',
  },
];

export function generateTojeongFortune(birthDate: string, dayMaster: string = '갑') {
  // 생년월일로 괘 결정 (간단한 해시 함수 사용)
  const dateHash = birthDate.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
  const fortuneIndex = dateHash % TOJEONG_FORTUNES.length;
  const fortune = TOJEONG_FORTUNES[fortuneIndex];

  return {
    summary: fortune.fortune,
    score: fortune.lucky === 'great' ? 90 : fortune.lucky === 'good' ? 78 : fortune.lucky === 'normal' ? 65 : 50,
    categories: [
      {
        emoji: '📜',
        title: '괘상 해석',
        content: `당신의 올해 괘는 "${fortune.name}"입니다.\n\n${fortune.fortune}`,
        advice: fortune.advice,
      },
      {
        emoji: '💰',
        title: '재물운',
        content: fortune.lucky === 'great' ? '재물이 모이는 상입니다. 투자나 저축에 좋은 해입니다.' :
                 fortune.lucky === 'good' ? '안정적인 재물운입니다. 무리하지 않으면 좋은 결과가 있습니다.' :
                 fortune.lucky === 'normal' ? '보통의 재물운입니다. 절약하고 검소하게 생활하세요.' :
                 '재물 손실에 주의하세요. 투자보다 저축이 좋습니다.',
        score: fortune.lucky === 'great' ? 88 : fortune.lucky === 'good' ? 75 : fortune.lucky === 'normal' ? 60 : 45,
      },
      {
        emoji: '👔',
        title: '직업운',
        content: fortune.lucky === 'great' ? '승진이나 성공의 기회가 많습니다. 적극적으로 도전하세요.' :
                 fortune.lucky === 'good' ? '안정적인 직업운입니다. 꾸준히 노력하면 인정받습니다.' :
                 fortune.lucky === 'normal' ? '무난한 직업운입니다. 현재 위치에서 최선을 다하세요.' :
                 '직장 생활에 어려움이 있을 수 있습니다. 인내가 필요합니다.',
        score: fortune.lucky === 'great' ? 90 : fortune.lucky === 'good' ? 78 : fortune.lucky === 'normal' ? 62 : 48,
      },
      {
        emoji: '❤️',
        title: '가정/인연운',
        content: fortune.lucky === 'great' ? '가정에 경사가 있을 수 있습니다. 좋은 인연도 기대됩니다.' :
                 fortune.lucky === 'good' ? '가족 간 화목한 해입니다. 인연운도 좋습니다.' :
                 fortune.lucky === 'normal' ? '평화로운 가정운입니다. 감사하는 마음을 갖으세요.' :
                 '가족 간 갈등에 주의하세요. 대화로 풀어가세요.',
        score: fortune.lucky === 'great' ? 85 : fortune.lucky === 'good' ? 72 : fortune.lucky === 'normal' ? 58 : 42,
      },
    ],
    luckyInfo: getYongsinBasedLuckyInfo(dayMaster),
    tip: fortune.lucky === 'caution'
      ? '올해는 내실을 다지는 해입니다. 차근차근 준비하면 다음 해에 더 큰 성과를 얻을 수 있습니다.'
      : '좋은 운에 겸손과 감사가 더해지면 복이 배가 됩니다.',
  };
}

// ============================================
// 별자리 운세 (서양 점성술 기반)
// ============================================

const ZODIAC_SIGNS: Record<string, {
  name: string;
  emoji: string;
  element: string;
  dates: [number, number, number, number]; // [시작월, 시작일, 끝월, 끝일]
}> = {
  aries: { name: '양자리', emoji: '♈', element: '불', dates: [3, 21, 4, 19] },
  taurus: { name: '황소자리', emoji: '♉', element: '흙', dates: [4, 20, 5, 20] },
  gemini: { name: '쌍둥이자리', emoji: '♊', element: '공기', dates: [5, 21, 6, 20] },
  cancer: { name: '게자리', emoji: '♋', element: '물', dates: [6, 21, 7, 22] },
  leo: { name: '사자자리', emoji: '♌', element: '불', dates: [7, 23, 8, 22] },
  virgo: { name: '처녀자리', emoji: '♍', element: '흙', dates: [8, 23, 9, 22] },
  libra: { name: '천칭자리', emoji: '♎', element: '공기', dates: [9, 23, 10, 22] },
  scorpio: { name: '전갈자리', emoji: '♏', element: '물', dates: [10, 23, 11, 21] },
  sagittarius: { name: '사수자리', emoji: '♐', element: '불', dates: [11, 22, 12, 21] },
  capricorn: { name: '염소자리', emoji: '♑', element: '흙', dates: [12, 22, 1, 19] },
  aquarius: { name: '물병자리', emoji: '♒', element: '공기', dates: [1, 20, 2, 18] },
  pisces: { name: '물고기자리', emoji: '♓', element: '물', dates: [2, 19, 3, 20] },
};

const ZODIAC_FORTUNES: Record<string, {
  overall: string;
  love: string;
  money: string;
  health: string;
  advice: string;
  detailedPersonality: string;
  strengths: string[];
  weaknesses: string[];
  luckyNumbers: number[];
  luckyColors: string[];
  luckyDay: string;
  compatibleSigns: string[];
  incompatibleSigns: string[];
  careerAptitude: string;
  loveStyle: string;
  monthlyFortune: Record<number, string>;
}> = {
  aries: {
    overall: '새로운 도전에 적합한 시기입니다. 용기를 갖고 앞으로 나아가세요.',
    love: '적극적인 표현이 좋은 결과를 가져옵니다.',
    money: '충동적인 소비를 자제하면 재물운이 좋아집니다.',
    health: '격한 운동보다 균형 잡힌 운동이 좋습니다.',
    advice: '성급한 판단은 피하세요.',
    detailedPersonality: '양자리는 12궁의 첫 번째 별자리로, 선구자적 기질과 강한 리더십을 가지고 있습니다. 화성의 지배를 받아 열정적이고 에너지가 넘치며, 새로운 일을 시작하는 것을 좋아합니다. 직접적이고 솔직한 성격으로 말과 행동이 빠르며, 두려움 없이 도전하는 용기가 있습니다. 다만 인내심이 부족하고 충동적인 면이 있어 장기 프로젝트에서는 끈기를 기르는 것이 중요합니다.',
    strengths: ['강한 리더십과 추진력', '용감하고 모험적인 정신', '솔직하고 직접적인 의사소통', '빠른 판단력과 행동력', '독립적이고 자기 확신이 강함'],
    weaknesses: ['인내심 부족', '충동적인 결정', '경쟁심이 지나칠 수 있음', '타인의 감정에 둔감할 수 있음', '쉽게 지루함을 느낌'],
    luckyNumbers: [1, 9, 17],
    luckyColors: ['빨간색', '주황색', '골드'],
    luckyDay: '화요일',
    compatibleSigns: ['사자자리', '사수자리', '쌍둥이자리', '물병자리'],
    incompatibleSigns: ['게자리', '염소자리'],
    careerAptitude: '기업가, 운동선수, 군인, 외과의사, 소방관, 영업직, 탐험가 등 도전적이고 활동적인 직업에 적합합니다. 리더 역할을 맡거나 새로운 분야를 개척하는 일에서 두각을 나타냅니다.',
    loveStyle: '열정적이고 직접적으로 사랑을 표현합니다. 상대방을 정복하는 것을 좋아하며, 연애 초기에 매우 적극적입니다. 독립적인 파트너를 원하며, 지루함을 느끼면 관계에 흥미를 잃을 수 있습니다.',
    monthlyFortune: {
      1: '새해와 함께 새로운 시작의 에너지가 강합니다. 목표를 세우고 추진하기 좋은 달입니다.',
      2: '대인관계에서 갈등이 생길 수 있으니 말과 행동에 주의하세요.',
      3: '양자리 시즌! 생일 전후로 행운이 따르며, 새로운 기회가 찾아옵니다.',
      4: '재정 관리에 신경 써야 할 시기입니다. 충동 구매를 자제하세요.',
      5: '커뮤니케이션 운이 좋습니다. 중요한 협상이나 발표에 적합합니다.',
      6: '가정과 가족에 관한 일에 집중하게 되는 시기입니다.',
      7: '창의력이 발휘되는 달입니다. 취미나 연애에서 즐거움을 찾으세요.',
      8: '건강과 일상 루틴을 점검하기 좋은 시기입니다.',
      9: '파트너십과 협력 관계가 중요해지는 달입니다.',
      10: '깊은 변화와 성장의 시기입니다. 내면을 돌아보세요.',
      11: '학습과 여행에 좋은 운이 있습니다. 시야를 넓히세요.',
      12: '커리어와 사회적 지위에 관한 기회가 찾아옵니다.',
    },
  },
  taurus: {
    overall: '안정을 추구하며 실속을 챙기기 좋은 시기입니다.',
    love: '진실한 마음이 상대에게 전해집니다.',
    money: '착실한 저축이 빛을 발합니다.',
    health: '규칙적인 생활이 건강의 비결입니다.',
    advice: '변화를 두려워하지 마세요.',
    detailedPersonality: '황소자리는 금성의 지배를 받아 아름다움과 편안함을 추구합니다. 안정적이고 신뢰할 수 있으며, 한번 결정하면 끝까지 밀고 나가는 끈기가 있습니다. 물질적 풍요와 감각적 즐거움을 중시하며, 미식가인 경우가 많습니다. 실용적이고 현실적인 사고를 하며, 급격한 변화보다는 점진적인 발전을 선호합니다.',
    strengths: ['뛰어난 인내력과 끈기', '현실적이고 실용적인 사고', '신뢰할 수 있는 성격', '감각적 심미안', '재정 관리 능력'],
    weaknesses: ['고집이 세고 융통성이 부족함', '변화를 싫어함', '소유욕이 강할 수 있음', '게으름을 부릴 때가 있음', '물질에 집착할 수 있음'],
    luckyNumbers: [2, 6, 15, 24],
    luckyColors: ['녹색', '분홍색', '하늘색'],
    luckyDay: '금요일',
    compatibleSigns: ['처녀자리', '염소자리', '게자리', '물고기자리'],
    incompatibleSigns: ['사자자리', '물병자리'],
    careerAptitude: '금융, 부동산, 요리사, 음악가, 화가, 인테리어 디자이너, 농업, 조경사 등 안정적이면서 감각을 활용하는 직업에 적합합니다.',
    loveStyle: '헌신적이고 충실한 파트너입니다. 사랑에 빠지면 오래 지속하며, 물질적으로나 정서적으로 상대방을 돌봅니다. 다만 질투심이 강하고 소유욕이 나타날 수 있습니다.',
    monthlyFortune: {
      1: '재정 계획을 세우기 좋은 시기입니다. 새해 예산을 검토하세요.',
      2: '대인관계가 활발해지며, 새로운 인연을 만날 수 있습니다.',
      3: '내면의 성찰이 필요한 시기입니다. 충분한 휴식을 취하세요.',
      4: '황소자리 시즌! 개인적인 목표를 추진하기에 최적의 시기입니다.',
      5: '재물운이 상승합니다. 부수입의 기회를 잡으세요.',
      6: '커뮤니케이션이 활발해지며, 학습에 좋은 시기입니다.',
      7: '가정과 가족 관련 일에 집중하게 됩니다.',
      8: '로맨스와 창의력이 빛나는 달입니다.',
      9: '건강과 일상 루틴을 재정비하기 좋습니다.',
      10: '파트너십에서 중요한 결정을 내릴 수 있습니다.',
      11: '깊은 변화의 시기입니다. 재정적 문제를 정리하세요.',
      12: '여행과 학습에 좋은 운이 있습니다.',
    },
  },
  gemini: {
    overall: '다양한 경험과 배움의 기회가 많습니다.',
    love: '소통이 원활해져 관계가 좋아집니다.',
    money: '다양한 수입원을 고려해보세요.',
    health: '정신 건강에도 관심을 기울이세요.',
    advice: '한 가지에 집중하는 연습이 필요합니다.',
    detailedPersonality: '쌍둥이자리는 수성의 지배를 받아 커뮤니케이션과 지적 호기심이 뛰어납니다. 빠른 두뇌 회전과 다재다능함이 특징이며, 여러 가지 일을 동시에 처리할 수 있습니다. 사교적이고 유머 감각이 뛰어나 사람들과 쉽게 어울립니다. 새로운 정보와 아이디어에 관심이 많고, 변화와 다양성을 즐깁니다.',
    strengths: ['뛰어난 의사소통 능력', '빠른 학습 능력', '다재다능함', '적응력이 좋음', '유머 감각'],
    weaknesses: ['집중력이 분산될 수 있음', '일관성이 부족할 수 있음', '표면적인 관계에 그칠 수 있음', '결정을 자주 바꿈', '불안정해 보일 수 있음'],
    luckyNumbers: [3, 5, 12, 23],
    luckyColors: ['노란색', '연두색', '밝은 파란색'],
    luckyDay: '수요일',
    compatibleSigns: ['천칭자리', '물병자리', '양자리', '사자자리'],
    incompatibleSigns: ['처녀자리', '물고기자리'],
    careerAptitude: '작가, 저널리스트, 번역가, 교사, 마케터, 세일즈, 방송인, IT 전문가 등 커뮤니케이션과 정보를 다루는 직업에 적합합니다.',
    loveStyle: '지적인 대화를 중시하며, 재미있고 자극적인 연애를 좋아합니다. 자유로움을 원하며, 너무 집착하는 파트너는 부담스러워합니다. 다양한 관심사를 공유할 수 있는 상대를 선호합니다.',
    monthlyFortune: {
      1: '새로운 아이디어와 계획을 세우기 좋은 시기입니다.',
      2: '재정적인 기회가 찾아올 수 있습니다. 준비하세요.',
      3: '커뮤니케이션이 활발해지며, 네트워킹에 좋습니다.',
      4: '내면의 휴식이 필요한 시기입니다.',
      5: '쌍둥이자리 시즌! 새로운 시작에 최적의 시기입니다.',
      6: '재물운이 상승하며, 가치를 재평가하게 됩니다.',
      7: '배움과 교류가 활발한 달입니다.',
      8: '가정과 가족에 관심이 집중됩니다.',
      9: '창의력과 로맨스가 빛나는 시기입니다.',
      10: '건강과 일상에 신경 써야 합니다.',
      11: '인간관계와 파트너십이 중요해집니다.',
      12: '깊은 성찰과 변화의 시기입니다.',
    },
  },
  cancer: {
    overall: '가정과 관계된 일에서 행복을 느낄 수 있습니다.',
    love: '감정을 표현하는 것이 관계에 도움이 됩니다.',
    money: '가족을 위한 지출에 보람을 느낍니다.',
    health: '스트레스 관리가 중요합니다.',
    advice: '과거에 연연하지 말고 앞으로 나아가세요.',
    detailedPersonality: '게자리는 달의 지배를 받아 감정이 풍부하고 직관력이 뛰어납니다. 가정과 가족을 매우 중요시하며, 보호본능이 강합니다. 타인의 감정을 잘 이해하고 공감하는 능력이 있어 주변 사람들에게 정서적 지지를 제공합니다. 기억력이 좋고 과거를 소중히 여기며, 전통과 추억을 간직하는 것을 좋아합니다.',
    strengths: ['강한 공감 능력', '보호 본능', '뛰어난 직관력', '충실한 성격', '요리나 육아 등 돌봄 능력'],
    weaknesses: ['감정 기복이 있을 수 있음', '과거에 집착할 수 있음', '지나친 방어적 태도', '변화를 두려워함', '상처받기 쉬움'],
    luckyNumbers: [2, 7, 11, 16],
    luckyColors: ['은색', '흰색', '연보라색'],
    luckyDay: '월요일',
    compatibleSigns: ['전갈자리', '물고기자리', '황소자리', '처녀자리'],
    incompatibleSigns: ['양자리', '천칭자리'],
    careerAptitude: '간호사, 심리상담사, 요리사, 유치원 교사, 역사학자, 부동산업, 골동품 수집상 등 돌봄과 보호, 과거와 관련된 직업에 적합합니다.',
    loveStyle: '헌신적이고 보호적인 파트너입니다. 안정적이고 깊은 유대감을 원하며, 가정을 중시합니다. 상대방을 돌보는 것을 좋아하지만, 때로는 지나친 보호가 상대방을 답답하게 만들 수 있습니다.',
    monthlyFortune: {
      1: '가족과의 시간이 중요한 달입니다.',
      2: '재정 계획을 검토하고 저축을 늘리세요.',
      3: '커뮤니케이션과 단거리 여행에 좋은 시기입니다.',
      4: '가정 환경을 개선하거나 이사를 고려할 수 있습니다.',
      5: '창의적인 프로젝트에 집중하기 좋습니다.',
      6: '건강 관리에 특별히 신경 써야 합니다.',
      7: '게자리 시즌! 생일을 맞아 새로운 시작을 하세요.',
      8: '재물운이 좋아지며, 가치관을 재정립합니다.',
      9: '배움과 소통이 활발한 달입니다.',
      10: '가정과 직장 사이의 균형을 찾아야 합니다.',
      11: '로맨스와 자녀 관련 행운이 있습니다.',
      12: '일상 루틴을 정비하고 건강을 점검하세요.',
    },
  },
  leo: {
    overall: '리더십을 발휘할 기회가 많습니다.',
    love: '자신감이 매력이 됩니다.',
    money: '큰 투자보다 작은 성과가 더 값집니다.',
    health: '과로하지 말고 휴식을 취하세요.',
    advice: '겸손함이 더 큰 존경을 받습니다.',
    detailedPersonality: '사자자리는 태양의 지배를 받아 자신감과 카리스마가 넘칩니다. 타고난 리더십과 창의력을 가지고 있으며, 주목받는 것을 좋아합니다. 관대하고 따뜻한 마음을 가지고 있어 주변 사람들에게 영감을 줍니다. 자존심이 강하고 인정받고 싶어하는 욕구가 있으며, 드라마틱한 표현을 좋아합니다.',
    strengths: ['강한 리더십', '창의력', '관대함', '자신감', '충성심'],
    weaknesses: ['자존심이 지나칠 수 있음', '독선적으로 보일 수 있음', '인정 욕구가 강함', '비판에 민감함', '사치스러울 수 있음'],
    luckyNumbers: [1, 4, 10, 19],
    luckyColors: ['금색', '주황색', '보라색'],
    luckyDay: '일요일',
    compatibleSigns: ['양자리', '사수자리', '쌍둥이자리', '천칭자리'],
    incompatibleSigns: ['황소자리', '전갈자리'],
    careerAptitude: 'CEO, 배우, 정치인, 패션 디자이너, 이벤트 플래너, 연예인, 코치 등 리더십을 발휘하고 주목받는 직업에 적합합니다.',
    loveStyle: '로맨틱하고 열정적인 연애를 합니다. 상대방에게 관대하고 선물을 좋아하며, 드라마틱한 제스처로 사랑을 표현합니다. 자신의 노력이 인정받기를 원하며, 충성스러운 파트너를 원합니다.',
    monthlyFortune: {
      1: '새해 목표를 세우고 리더십을 발휘하세요.',
      2: '인간관계가 확장되며, 네트워킹에 좋습니다.',
      3: '내면의 성찰과 휴식이 필요한 시기입니다.',
      4: '사회적 활동이 활발해지고, 그룹 활동에 적극적으로 참여하세요.',
      5: '창의적인 프로젝트를 시작하기 좋습니다.',
      6: '재물운이 상승하며, 수입이 늘어날 수 있습니다.',
      7: '배움과 소통의 달입니다.',
      8: '사자자리 시즌! 당신이 주인공인 시기입니다.',
      9: '재정 관리에 집중하세요.',
      10: '커뮤니케이션과 단거리 여행에 좋습니다.',
      11: '가정과 가족에 관심이 집중됩니다.',
      12: '로맨스와 창의력이 빛나는 시기입니다.',
    },
  },
  virgo: {
    overall: '세심한 계획이 성과로 이어집니다.',
    love: '상대방의 작은 것에도 관심을 보이세요.',
    money: '절약과 계획적인 소비가 좋습니다.',
    health: '건강 검진을 받아보세요.',
    advice: '완벽을 추구하기보다 진행을 선택하세요.',
    detailedPersonality: '처녀자리는 수성의 지배를 받아 분석적이고 세밀한 성격을 가집니다. 실용적이고 체계적이며, 디테일에 강합니다. 봉사 정신이 있고 타인을 돕는 것을 좋아하며, 청결과 질서를 중시합니다. 완벽주의적 성향이 있어 높은 기준을 가지고 있으며, 비판적 사고 능력이 뛰어납니다.',
    strengths: ['분석력과 비판적 사고', '체계적이고 조직적임', '봉사 정신', '세심한 주의력', '실용성'],
    weaknesses: ['지나친 완벽주의', '비판적으로 보일 수 있음', '걱정이 많을 수 있음', '융통성이 부족할 수 있음', '자기 비하 경향'],
    luckyNumbers: [5, 14, 23, 32],
    luckyColors: ['베이지', '갈색', '네이비'],
    luckyDay: '수요일',
    compatibleSigns: ['황소자리', '염소자리', '게자리', '전갈자리'],
    incompatibleSigns: ['쌍둥이자리', '사수자리'],
    careerAptitude: '의사, 연구원, 편집자, 회계사, 영양사, 건강 관련 직종, 품질 관리자 등 세밀함과 분석력이 요구되는 직업에 적합합니다.',
    loveStyle: '헌신적이고 실용적인 방식으로 사랑을 표현합니다. 상대방의 일상적인 필요를 챙기고, 건강과 생활을 돌봅니다. 완벽한 관계를 추구하여 때로는 비판적으로 보일 수 있지만, 마음은 진실합니다.',
    monthlyFortune: {
      1: '건강 습관을 점검하고 개선하기 좋은 시기입니다.',
      2: '창의적인 프로젝트에서 성과를 낼 수 있습니다.',
      3: '파트너십에 대한 고민이 있을 수 있습니다.',
      4: '재정적 변화나 공동 자산 관련 일이 있습니다.',
      5: '여행이나 학습에 좋은 운이 있습니다.',
      6: '커리어에서 중요한 기회가 찾아옵니다.',
      7: '네트워킹과 그룹 활동이 활발해집니다.',
      8: '휴식과 재충전이 필요한 시기입니다.',
      9: '처녀자리 시즌! 새로운 시작을 하세요.',
      10: '재물운이 상승하며, 가치관을 재정립합니다.',
      11: '커뮤니케이션이 활발해집니다.',
      12: '가정과 가족에 집중하는 시기입니다.',
    },
  },
  libra: {
    overall: '인간관계에서 균형을 찾는 시기입니다.',
    love: '조화로운 관계가 행복의 열쇠입니다.',
    money: '공정한 거래가 신뢰를 쌓습니다.',
    health: '균형 잡힌 식단이 중요합니다.',
    advice: '결정을 미루지 마세요.',
    detailedPersonality: '천칭자리는 금성의 지배를 받아 조화와 아름다움을 추구합니다. 공정함과 균형을 중시하며, 분쟁을 조정하는 데 능합니다. 사교적이고 매력적이며, 예술적 감각이 뛰어납니다. 타인과의 관계를 중시하고 협력을 잘하지만, 결정을 내리는 데 어려움을 겪을 수 있습니다.',
    strengths: ['조화와 균형 감각', '외교적 능력', '공정함', '사교성', '예술적 감각'],
    weaknesses: ['우유부단함', '갈등 회피', '타인에게 의존할 수 있음', '자기 의견을 굽힐 수 있음', '피상적으로 보일 수 있음'],
    luckyNumbers: [6, 15, 24, 33],
    luckyColors: ['파스텔 블루', '핑크', '라벤더'],
    luckyDay: '금요일',
    compatibleSigns: ['쌍둥이자리', '물병자리', '사자자리', '사수자리'],
    incompatibleSigns: ['게자리', '염소자리'],
    careerAptitude: '변호사, 외교관, 중재자, 패션 디자이너, 인테리어 디자이너, 웨딩 플래너, 갤러리 큐레이터 등 조화와 미적 감각이 필요한 직업에 적합합니다.',
    loveStyle: '로맨틱하고 파트너를 중시합니다. 조화로운 관계를 원하며, 갈등을 피하려 합니다. 상대방을 기쁘게 하려고 노력하지만, 자신의 필요를 표현하는 것이 중요합니다.',
    monthlyFortune: {
      1: '인간관계와 파트너십을 돌아보는 시기입니다.',
      2: '깊은 변화와 재정 정리가 필요합니다.',
      3: '여행과 학습에 좋은 운이 있습니다.',
      4: '커리어에서 성과를 낼 수 있습니다.',
      5: '그룹 활동과 네트워킹에 좋습니다.',
      6: '휴식과 재충전이 필요합니다.',
      7: '개인적인 목표에 집중하세요.',
      8: '재물운이 상승합니다.',
      9: '커뮤니케이션이 활발해지는 달입니다.',
      10: '천칭자리 시즌! 새로운 시작의 에너지가 넘칩니다.',
      11: '재정 관리와 가치관 정립에 좋습니다.',
      12: '배움과 소통의 기회가 많습니다.',
    },
  },
  scorpio: {
    overall: '깊이 있는 통찰력이 빛나는 시기입니다.',
    love: '진정한 감정을 공유하면 관계가 깊어집니다.',
    money: '투자에 대한 감이 좋습니다.',
    health: '감정을 억누르지 마세요.',
    advice: '집착을 버리면 더 많은 것이 옵니다.',
    detailedPersonality: '전갈자리는 명왕성과 화성의 지배를 받아 강렬하고 열정적입니다. 깊은 통찰력과 집중력을 가지고 있으며, 표면 아래의 진실을 꿰뚫어 봅니다. 변화와 재생의 에너지를 가지고 있어 어려움을 극복하는 힘이 있습니다. 비밀을 잘 지키고, 신뢰하는 사람에게는 매우 충실합니다.',
    strengths: ['깊은 통찰력', '결단력', '충성심', '재생과 변화 능력', '집중력'],
    weaknesses: ['질투심이 강할 수 있음', '비밀스러움', '복수심', '지나친 의심', '컨트롤 욕구'],
    luckyNumbers: [8, 11, 18, 22],
    luckyColors: ['검정', '진홍색', '진한 보라'],
    luckyDay: '화요일',
    compatibleSigns: ['게자리', '물고기자리', '처녀자리', '염소자리'],
    incompatibleSigns: ['사자자리', '물병자리'],
    careerAptitude: '탐정, 심리학자, 외과의사, 연구원, 금융 분석가, 장례 지도사, 위기 관리 전문가 등 깊이와 집중력이 필요한 직업에 적합합니다.',
    loveStyle: '깊고 강렬한 관계를 원합니다. 올인하는 스타일로, 반쪽짜리 사랑은 용납하지 않습니다. 상대방에게 매우 충실하지만, 배신에는 용서하기 어렵습니다.',
    monthlyFortune: {
      1: '깊은 변화와 재정 정리의 시기입니다.',
      2: '여행과 학습에서 영감을 얻습니다.',
      3: '커리어에서 중요한 진전이 있습니다.',
      4: '그룹 활동과 미래 계획에 집중하세요.',
      5: '휴식과 내면 성찰이 필요합니다.',
      6: '개인적인 목표와 이미지에 집중합니다.',
      7: '재물운이 상승하는 시기입니다.',
      8: '커뮤니케이션과 학습에 좋습니다.',
      9: '가정과 가족에 관심이 집중됩니다.',
      10: '로맨스와 창의력이 빛납니다.',
      11: '전갈자리 시즌! 변화와 새로운 시작의 에너지입니다.',
      12: '재정 관리와 자산 증식에 좋습니다.',
    },
  },
  sagittarius: {
    overall: '모험과 탐험에 좋은 시기입니다.',
    love: '자유로운 연애가 즐겁습니다.',
    money: '예상치 못한 수입이 있을 수 있습니다.',
    health: '야외 활동이 건강에 좋습니다.',
    advice: '현실적인 계획도 필요합니다.',
    detailedPersonality: '사수자리는 목성의 지배를 받아 낙관적이고 모험정신이 강합니다. 자유를 사랑하고 새로운 경험과 지식을 추구합니다. 철학적 사고를 좋아하며, 인생의 의미를 탐구합니다. 솔직하고 직설적이며, 유머 감각이 뛰어납니다.',
    strengths: ['낙관적 태도', '모험 정신', '철학적 사고', '솔직함', '자유로운 영혼'],
    weaknesses: ['무책임하게 보일 수 있음', '세부 사항을 놓칠 수 있음', '과도한 약속', '참을성 부족', '직설적인 말이 상처가 될 수 있음'],
    luckyNumbers: [3, 9, 12, 21],
    luckyColors: ['보라색', '인디고', '터키색'],
    luckyDay: '목요일',
    compatibleSigns: ['양자리', '사자자리', '천칭자리', '물병자리'],
    incompatibleSigns: ['처녀자리', '물고기자리'],
    careerAptitude: '여행 가이드, 교수, 작가, 철학자, 방송인, 국제 비즈니스, 스포츠 관련 직종 등 자유롭고 확장적인 직업에 적합합니다.',
    loveStyle: '자유롭고 열린 관계를 원합니다. 지적으로 자극받기를 원하며, 함께 모험을 떠날 파트너를 찾습니다. 구속을 싫어하며, 너무 진지한 관계는 부담스러워할 수 있습니다.',
    monthlyFortune: {
      1: '여행과 학습에 좋은 운이 있습니다.',
      2: '커리어에서 진전이 있을 수 있습니다.',
      3: '그룹 활동과 네트워킹에 활발한 시기입니다.',
      4: '내면 성찰과 휴식이 필요합니다.',
      5: '새로운 시작을 하기에 좋습니다.',
      6: '재물운이 상승하며, 가치관을 돌아봅니다.',
      7: '커뮤니케이션이 활발해지는 달입니다.',
      8: '가정과 가족에 집중합니다.',
      9: '로맨스와 창의력이 빛나는 시기입니다.',
      10: '건강 관리와 일상 루틴에 신경 쓰세요.',
      11: '파트너십에서 중요한 결정을 내립니다.',
      12: '사수자리 시즌! 낙관과 확장의 에너지가 넘칩니다.',
    },
  },
  capricorn: {
    overall: '목표를 향해 꾸준히 나아가는 시기입니다.',
    love: '진지한 관계가 안정을 줍니다.',
    money: '장기 투자가 좋은 결과를 낳습니다.',
    health: '무리하지 말고 적절한 휴식을 취하세요.',
    advice: '때로는 유연함도 필요합니다.',
    detailedPersonality: '염소자리는 토성의 지배를 받아 책임감 있고 야심 찹니다. 목표 지향적이며, 꾸준히 노력하여 성과를 이루는 타입입니다. 전통과 구조를 중시하고, 실용적이며 현실적입니다. 자기 통제력이 강하고 인내심이 있습니다.',
    strengths: ['책임감', '야망', '끈기', '자기 통제력', '현실적 사고'],
    weaknesses: ['일중독이 될 수 있음', '융통성 부족', '비관적일 수 있음', '감정 표현이 서투름', '지나친 보수성'],
    luckyNumbers: [4, 8, 13, 22],
    luckyColors: ['검정', '갈색', '카키'],
    luckyDay: '토요일',
    compatibleSigns: ['황소자리', '처녀자리', '전갈자리', '물고기자리'],
    incompatibleSigns: ['양자리', '천칭자리'],
    careerAptitude: '경영자, 정치인, 건축가, 엔지니어, 금융 전문가, 법조인, 행정가 등 목표 지향적이고 체계적인 직업에 적합합니다.',
    loveStyle: '진지하고 헌신적인 관계를 원합니다. 천천히 마음을 열지만, 일단 사랑에 빠지면 오래 지속합니다. 안정적인 관계를 중시하며, 파트너와 함께 목표를 향해 나아가기를 원합니다.',
    monthlyFortune: {
      1: '염소자리 시즌! 새해와 함께 새로운 목표를 세우세요.',
      2: '재물운이 상승하며, 수입 증가의 기회입니다.',
      3: '커뮤니케이션과 학습에 좋은 시기입니다.',
      4: '가정과 가족에 관심이 집중됩니다.',
      5: '창의력과 로맨스가 빛나는 달입니다.',
      6: '건강 관리와 일상 루틴을 점검하세요.',
      7: '파트너십에서 중요한 결정이 있습니다.',
      8: '깊은 변화와 재정 정리의 시기입니다.',
      9: '여행과 학습에 좋은 운이 있습니다.',
      10: '커리어에서 중요한 성과를 낼 수 있습니다.',
      11: '네트워킹과 그룹 활동이 활발해집니다.',
      12: '휴식과 재충전이 필요한 시기입니다.',
    },
  },
  aquarius: {
    overall: '독창적인 아이디어가 빛나는 시기입니다.',
    love: '특별한 인연을 만날 수 있습니다.',
    money: '혁신적인 방법으로 수익을 창출할 수 있습니다.',
    health: '새로운 건강 습관을 시작해보세요.',
    advice: '너무 이상에만 치우치지 마세요.',
    detailedPersonality: '물병자리는 천왕성과 토성의 지배를 받아 독창적이고 진보적입니다. 인도주의적 가치를 중시하고 사회 개혁에 관심이 많습니다. 독립적이고 개성이 강하며, 관습에 얽매이지 않습니다. 미래 지향적 사고를 하고 혁신적인 아이디어가 많습니다.',
    strengths: ['독창성', '인도주의적 가치관', '독립심', '진보적 사고', '객관적 시각'],
    weaknesses: ['감정적으로 거리감이 있을 수 있음', '고집이 셀 수 있음', '예측 불가능', '실용성이 부족할 수 있음', '반항적일 수 있음'],
    luckyNumbers: [4, 7, 11, 22],
    luckyColors: ['전기 블루', '터키색', '실버'],
    luckyDay: '토요일',
    compatibleSigns: ['쌍둥이자리', '천칭자리', '양자리', '사수자리'],
    incompatibleSigns: ['황소자리', '전갈자리'],
    careerAptitude: '과학자, 발명가, IT 전문가, 사회활동가, 항공우주 관련, 디자이너, 미래학자 등 혁신적이고 독창적인 직업에 적합합니다.',
    loveStyle: '친구 같은 관계를 원합니다. 정신적인 연결을 중시하며, 개인의 자유와 공간을 존중해주는 파트너를 원합니다. 전통적인 로맨스보다는 독특하고 자유로운 관계를 추구합니다.',
    monthlyFortune: {
      1: '개인적인 목표와 새로운 시작에 집중하세요.',
      2: '물병자리 시즌! 혁신과 변화의 에너지가 넘칩니다.',
      3: '재물운이 상승하며, 새로운 수입원을 찾습니다.',
      4: '커뮤니케이션과 학습에 좋은 시기입니다.',
      5: '가정과 가족에 관심이 집중됩니다.',
      6: '창의력과 로맨스가 빛나는 달입니다.',
      7: '건강 관리와 일상 루틴을 점검하세요.',
      8: '파트너십에서 중요한 결정을 내립니다.',
      9: '깊은 변화와 재정 정리의 시기입니다.',
      10: '여행과 학습에 좋은 운이 있습니다.',
      11: '커리어에서 성과를 낼 수 있습니다.',
      12: '그룹 활동과 네트워킹이 활발해집니다.',
    },
  },
  pisces: {
    overall: '직관이 강해지는 시기입니다.',
    love: '감정적 교류가 깊어집니다.',
    money: '예술적 활동에서 수익을 찾을 수 있습니다.',
    health: '명상이나 요가가 도움이 됩니다.',
    advice: '현실도 놓치지 마세요.',
    detailedPersonality: '물고기자리는 해왕성과 목성의 지배를 받아 상상력이 풍부하고 감수성이 예민합니다. 예술적 재능이 있으며, 공감 능력이 뛰어납니다. 영적인 것에 관심이 많고 직관력이 강합니다. 희생 정신이 있고 타인을 돕고 싶어하지만, 현실과 이상의 경계가 모호해질 수 있습니다.',
    strengths: ['풍부한 상상력', '공감 능력', '예술적 재능', '직관력', '희생 정신'],
    weaknesses: ['현실 회피 경향', '쉽게 상처받음', '우유부단함', '경계가 약할 수 있음', '의존적일 수 있음'],
    luckyNumbers: [3, 7, 12, 16],
    luckyColors: ['바다색', '연보라', '민트'],
    luckyDay: '목요일',
    compatibleSigns: ['게자리', '전갈자리', '황소자리', '염소자리'],
    incompatibleSigns: ['쌍둥이자리', '사수자리'],
    careerAptitude: '예술가, 음악가, 영화감독, 간호사, 심리치료사, 성직자, 자선단체 활동가 등 창의적이고 돌봄이 필요한 직업에 적합합니다.',
    loveStyle: '로맨틱하고 헌신적인 사랑을 합니다. 상대방과 깊이 교감하기를 원하며, 이상적인 사랑을 꿈꿉니다. 상대방을 위해 희생하지만, 때로는 현실적인 판단도 필요합니다.',
    monthlyFortune: {
      1: '휴식과 재충전이 필요한 시기입니다.',
      2: '내면 성찰과 영적 성장에 집중하세요.',
      3: '물고기자리 시즌! 새로운 시작의 에너지가 넘칩니다.',
      4: '재물운이 상승하며, 가치관을 돌아봅니다.',
      5: '커뮤니케이션과 학습에 좋은 시기입니다.',
      6: '가정과 가족에 관심이 집중됩니다.',
      7: '창의력과 로맨스가 빛나는 달입니다.',
      8: '건강 관리와 일상 루틴을 점검하세요.',
      9: '파트너십에서 중요한 결정을 내립니다.',
      10: '깊은 변화와 재정 정리의 시기입니다.',
      11: '여행과 학습에 좋은 운이 있습니다.',
      12: '커리어에서 성과를 낼 수 있습니다.',
    },
  },
};

function getZodiacSign(birthDate: string): string {
  const [, month, day] = birthDate.split('-').map(Number);

  for (const [key, sign] of Object.entries(ZODIAC_SIGNS)) {
    const [startMonth, startDay, endMonth, endDay] = sign.dates;

    if (startMonth === 12 && endMonth === 1) {
      // 염소자리 (12/22 ~ 1/19)
      if ((month === 12 && day >= startDay) || (month === 1 && day <= endDay)) {
        return key;
      }
    } else if (
      (month === startMonth && day >= startDay) ||
      (month === endMonth && day <= endDay)
    ) {
      return key;
    }
  }

  return 'aries'; // 기본값
}

export function generateZodiacFortune(birthDate: string, dayMaster: string = '갑', targetDate: Date = new Date()) {
  const signKey = getZodiacSign(birthDate);
  const sign = ZODIAC_SIGNS[signKey];
  const fortune = ZODIAC_FORTUNES[signKey];

  // 생년월일 기반 해시로 일관된 점수 생성
  const dateHash = birthDate.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
  const todayHash = targetDate.getDate() + targetDate.getMonth() * 31 + targetDate.getFullYear();
  const combinedHash = dateHash + todayHash;

  return {
    summary: `${sign.emoji} ${sign.name} (${sign.element} 원소)\n\n${fortune.overall}`,
    score: 75 + (combinedHash % 15),
    categories: [
      {
        emoji: '🌟',
        title: '오늘의 총운',
        content: fortune.overall,
        score: 75 + ((combinedHash + 1) % 15),
        advice: fortune.advice,
      },
      {
        emoji: '❤️',
        title: '애정운',
        content: fortune.love,
        score: 70 + ((combinedHash + 2) % 20),
      },
      {
        emoji: '💰',
        title: '금전운',
        content: fortune.money,
        score: 68 + ((combinedHash + 3) % 22),
      },
      {
        emoji: '🏥',
        title: '건강운',
        content: fortune.health,
        score: 72 + ((combinedHash + 4) % 18),
      },
    ],
    luckyInfo: getYongsinBasedLuckyInfo(dayMaster),
  };
}

// ============================================
// 꿈풀이 (전통 해몽서/주공해몽 기반)
// ============================================

interface DreamItem {
  name: string;
  meaning: string;
  luck: 'good' | 'normal' | 'bad';
}

interface DreamCategory {
  emoji: string;
  title: string;
  items: DreamItem[];
}

export function generateDreamFortune(dayMaster: string = '갑') {
  const dreamCategories: DreamCategory[] = [
    {
      emoji: '🐉',
      title: '동물 꿈',
      items: [
        { name: '용꿈', meaning: '큰 행운과 성공을 상징합니다. 승진, 합격, 당첨 등 좋은 소식이 있을 수 있습니다. 용이 하늘로 오르면 대성할 징조이고, 용이 물에서 나오면 기회가 찾아옵니다.', luck: 'good' },
        { name: '뱀꿈', meaning: '재물운을 상징합니다. 특히 큰 뱀은 큰 재물을, 뱀이 집에 들어오면 재물이 들어옴을 의미합니다. 흰 뱀은 특히 길하며 횡재수가 있습니다.', luck: 'good' },
        { name: '돼지꿈', meaning: '재물과 복을 상징합니다. 돼지가 크고 살쪘을수록 더 큰 재물을 의미합니다. 돼지 떼는 풍요를, 새끼 돼지는 소소한 행복을 뜻합니다.', luck: 'good' },
        { name: '개꿈', meaning: '충성과 우정을 상징합니다. 개가 짖으면 주변의 경고를, 개가 꼬리치면 좋은 소식을 의미합니다. 검은 개는 수호를, 흰 개는 순수한 인연을 뜻합니다.', luck: 'normal' },
        { name: '호랑이꿈', meaning: '권위와 힘을 상징합니다. 호랑이를 타면 승진이나 성공을, 호랑이에게 쫓기면 어려움이 있을 수 있습니다. 흰 호랑이는 신성한 보호를 의미합니다.', luck: 'good' },
        { name: '쥐꿈', meaning: '다산과 부지런함을 상징합니다. 쥐가 곡식을 물어가면 재물이 모이고, 쥐가 도망가면 작은 손해가 있을 수 있습니다.', luck: 'normal' },
        { name: '소꿈', meaning: '근면과 재물을 상징합니다. 소가 밭을 갈면 노력이 결실을 맺고, 소가 집에 들어오면 재물이 들어옵니다. 누런 소는 특히 길합니다.', luck: 'good' },
        { name: '말꿈', meaning: '성공과 명예를 상징합니다. 말을 타고 달리면 출세하고, 흰 말은 귀인을 만날 징조입니다. 말이 우는 것은 기쁜 소식을 뜻합니다.', luck: 'good' },
        { name: '토끼꿈', meaning: '다산과 행운을 상징합니다. 흰 토끼는 특히 길하며 좋은 인연을 만날 수 있습니다. 토끼가 뛰어다니면 활기찬 시기가 옵니다.', luck: 'good' },
        { name: '고양이꿈', meaning: '직관과 신비를 상징합니다. 검은 고양이는 오해와 달리 행운을 가져올 수 있습니다. 고양이가 다가오면 숨겨진 진실이 드러납니다.', luck: 'normal' },
        { name: '잉어꿈', meaning: '출세와 등용을 상징합니다. 잉어가 뛰어오르면 합격이나 승진을, 금색 잉어는 큰 재물을 뜻합니다. 잉어가 용으로 변하면 대성합니다.', luck: 'good' },
        { name: '닭꿈', meaning: '새벽과 시작을 상징합니다. 닭이 울면 좋은 소식이 오고, 수탉은 명예를, 암탉은 다산을 의미합니다.', luck: 'good' },
        { name: '학꿈', meaning: '장수와 귀함을 상징합니다. 학이 날아오르면 승진이나 합격을, 학이 춤추면 경사가 있습니다. 흰 학은 특히 대길합니다.', luck: 'good' },
        { name: '거북이꿈', meaning: '장수와 안정을 상징합니다. 거북이가 나타나면 건강과 장수를 약속하고, 거북이 등에 타면 안전한 보호를 받습니다.', luck: 'good' },
        { name: '나비꿈', meaning: '변화와 아름다움을 상징합니다. 화려한 나비는 기쁜 소식을, 나비 떼는 인연이 찾아옴을 의미합니다.', luck: 'good' },
        { name: '독수리꿈', meaning: '권력과 성공을 상징합니다. 독수리가 하늘 높이 날면 큰 뜻을 이루고, 독수리가 먹이를 잡으면 기회를 얻습니다.', luck: 'good' },
        { name: '까마귀꿈', meaning: '경고와 변화를 상징합니다. 까마귀가 울면 주의가 필요하고, 까마귀 떼는 큰 변화를 예고합니다. 하지만 까마귀가 떠나면 어려움이 지나갑니다.', luck: 'normal' },
        { name: '벌꿈', meaning: '근면과 협동을 상징합니다. 꿀벌은 재물을, 벌집은 가정의 화목을 의미합니다. 벌에 쏘이면 작은 시련 후 좋은 결과가 있습니다.', luck: 'good' },
      ],
    },
    {
      emoji: '💧',
      title: '자연 꿈',
      items: [
        { name: '물꿈', meaning: '맑은 물은 행운을, 탁한 물은 어려움을 상징합니다. 물이 넘치면 풍요를, 마르면 어려운 시기를 뜻합니다. 물을 마시면 지혜를 얻습니다.', luck: 'normal' },
        { name: '불꿈', meaning: '정열과 변화를 상징합니다. 불에 타는 꿈은 걱정 해소를 의미합니다. 밝게 타오르는 불은 성공을, 활활 타는 집은 새출발을 뜻합니다.', luck: 'good' },
        { name: '산꿈', meaning: '높은 산을 오르면 성공을, 내려오면 안정을 의미합니다. 산 정상에 서면 큰 뜻을 이루고, 푸른 산은 건강과 장수를 뜻합니다.', luck: 'good' },
        { name: '바다꿈', meaning: '무한한 가능성을 상징합니다. 잔잔한 바다는 평화를, 파도가 높으면 변화가 클 수 있습니다. 바다에서 해가 떠오르면 대길합니다.', luck: 'good' },
        { name: '하늘꿈', meaning: '맑은 하늘은 행운을, 구름 낀 하늘은 고민을 의미합니다. 하늘을 나는 꿈은 자유와 성공을, 별이 빛나는 밤하늘은 희망을 뜻합니다.', luck: 'good' },
        { name: '비꿈', meaning: '시련 후 좋은 결과를 상징합니다. 비 개인 후 무지개는 대길합니다. 소나기는 짧은 어려움을, 장마비는 인내가 필요함을 뜻합니다.', luck: 'normal' },
        { name: '눈꿈', meaning: '순수와 정화를 상징합니다. 하얀 눈이 내리면 새로운 시작을, 눈밭을 걷으면 어려움 속에서도 희망이 있음을 의미합니다.', luck: 'good' },
        { name: '번개꿈', meaning: '통찰과 계시를 상징합니다. 번개가 치면 갑작스러운 깨달음이나 기회가 옵니다. 번개에 맞으면 큰 변화가 찾아옵니다.', luck: 'normal' },
        { name: '무지개꿈', meaning: '희망과 행운을 상징합니다. 무지개를 보면 소원이 이루어지고, 무지개 다리를 건너면 새로운 세계로 나아갑니다.', luck: 'good' },
        { name: '태양꿈', meaning: '성공과 영광을 상징합니다. 해가 떠오르면 희망찬 시작을, 빛나는 태양은 명예를 얻음을 뜻합니다. 해를 삼키면 귀한 자녀를 얻습니다.', luck: 'good' },
        { name: '달꿈', meaning: '여성성과 직관을 상징합니다. 보름달은 풍요와 완성을, 초승달은 새로운 시작을 의미합니다. 달을 삼키면 귀한 딸을 얻습니다.', luck: 'good' },
        { name: '별꿈', meaning: '희망과 안내를 상징합니다. 별이 빛나면 목표를 향해 나아가고, 유성을 보면 소원이 이루어집니다. 북극성은 귀인을 뜻합니다.', luck: 'good' },
        { name: '구름꿈', meaning: '변화와 불확실함을 상징합니다. 흰 구름은 행운을, 검은 구름은 일시적 어려움을 의미합니다. 구름 위를 걷으면 높은 경지에 오릅니다.', luck: 'normal' },
        { name: '바람꿈', meaning: '변화와 자유를 상징합니다. 순풍은 일이 잘 풀림을, 강풍은 큰 변화를 뜻합니다. 바람에 날리면 새로운 방향으로 나아갑니다.', luck: 'normal' },
        { name: '지진꿈', meaning: '근본적인 변화를 상징합니다. 지진이 나면 삶의 기반이 흔들리지만, 무너지지 않으면 더 강해집니다.', luck: 'normal' },
        { name: '강/하천꿈', meaning: '인생의 흐름을 상징합니다. 맑은 강물은 순탄한 삶을, 강을 건너면 새로운 단계로 넘어감을 의미합니다.', luck: 'good' },
        { name: '폭포꿈', meaning: '에너지와 정화를 상징합니다. 폭포를 보면 활력을 얻고, 폭포 아래 서면 스트레스가 씻겨나갑니다.', luck: 'good' },
        { name: '꽃밭꿈', meaning: '행복과 번영을 상징합니다. 꽃밭에서 노닐면 즐거운 일이 생기고, 꽃을 꺾으면 기회를 잡습니다.', luck: 'good' },
        { name: '숲꿈', meaning: '성장과 자아탐색을 상징합니다. 울창한 숲은 잠재력을, 숲에서 길을 찾으면 자아발견을 의미합니다.', luck: 'good' },
      ],
    },
    {
      emoji: '👨‍👩‍👧‍👦',
      title: '사람 꿈',
      items: [
        { name: '돌아가신 분 꿈', meaning: '조상의 보호를 상징합니다. 좋은 모습이면 길조이고, 음식을 주시면 복을 주십니다. 말씀을 하시면 그 내용에 귀 기울이세요.', luck: 'good' },
        { name: '아기 꿈', meaning: '새로운 시작과 희망을 상징합니다. 태몽일 수도 있습니다. 아기가 웃으면 기쁜 소식이, 아기를 안으면 새로운 일이 시작됩니다.', luck: 'good' },
        { name: '연인 꿈', meaning: '관계의 발전을 상징합니다. 다투는 꿈은 오히려 화해를, 함께 걷는 꿈은 관계의 진전을 의미합니다.', luck: 'normal' },
        { name: '낯선 사람 꿈', meaning: '새로운 인연을 상징합니다. 친절한 낯선 사람은 귀인을, 무서운 낯선 사람은 내면의 두려움을 반영합니다.', luck: 'normal' },
        { name: '유명인 꿈', meaning: '그 사람의 특성을 닮고 싶은 욕구를 의미합니다. 함께하면 그 특성을 얻고, 악수하면 인정받습니다.', luck: 'good' },
        { name: '친구 꿈', meaning: '그 친구와의 관계나 자신의 일부를 반영합니다. 친구가 웃으면 좋은 인연이, 도움을 주면 협력이 있습니다.', luck: 'normal' },
        { name: '부모님 꿈', meaning: '보호와 안내를 상징합니다. 부모님이 웃으시면 가정에 경사가, 걱정하시면 건강에 주의하세요.', luck: 'good' },
        { name: '선생님 꿈', meaning: '가르침과 성장을 상징합니다. 선생님께 칭찬받으면 인정받고, 꾸중듣으면 개선이 필요합니다.', luck: 'normal' },
        { name: '의사 꿈', meaning: '치유와 건강을 상징합니다. 의사를 만나면 건강을 점검하고, 치료받으면 문제가 해결됩니다.', luck: 'normal' },
        { name: '경찰 꿈', meaning: '질서와 정의를 상징합니다. 경찰이 보호해주면 안전하고, 잡히면 양심의 가책을 반영합니다.', luck: 'normal' },
        { name: '왕/여왕 꿈', meaning: '권위와 존경을 상징합니다. 왕을 만나면 귀인을 만나고, 왕이 되면 리더십을 발휘합니다.', luck: 'good' },
        { name: '천사 꿈', meaning: '보호와 축복을 상징합니다. 천사가 나타나면 어려움이 해결되고, 천사의 노래를 들으면 평화가 찾아옵니다.', luck: 'good' },
        { name: '어린 시절의 나 꿈', meaning: '순수한 마음과 근원을 상징합니다. 어린 나와 놀면 내면의 치유가, 대화하면 중요한 깨달음이 있습니다.', luck: 'good' },
        { name: '임신/출산 꿈', meaning: '창조와 새로운 시작을 상징합니다. 실제 임신일 수도, 새 프로젝트나 아이디어의 탄생일 수도 있습니다.', luck: 'good' },
        { name: '결혼식 꿈', meaning: '결합과 약속을 상징합니다. 자신의 결혼식은 새로운 시작을, 타인의 결혼식은 경사를 의미합니다.', luck: 'good' },
        { name: '장례식 꿈', meaning: '끝과 새로운 시작을 상징합니다. 누군가의 장례식은 그 관계의 변화를, 자신의 장례식은 재탄생을 의미합니다.', luck: 'normal' },
      ],
    },
    {
      emoji: '🎁',
      title: '행운 상징 꿈',
      items: [
        { name: '금/보석 꿈', meaning: '재물운 상승을 상징합니다. 금을 줍거나 받으면 횡재가, 보석을 발견하면 숨겨진 가치를 찾습니다. 금관을 쓰면 큰 명예를 얻습니다.', luck: 'good' },
        { name: '꽃꿈', meaning: '기쁜 소식과 행복을 상징합니다. 꽃다발을 받으면 좋은 일이, 꽃을 심으면 새로운 시작이 있습니다. 만개한 꽃은 성공을 뜻합니다.', luck: 'good' },
        { name: '과일 꿈', meaning: '풍요와 수확을 상징합니다. 익은 과일은 성공을, 과일을 따면 목표 달성을 의미합니다. 특히 복숭아와 석류는 대길합니다.', luck: 'good' },
        { name: '시험 합격 꿈', meaning: '실제로 좋은 결과를 얻을 징조입니다. 합격증을 받으면 인정받고, 축하받으면 성취감을 느낍니다.', luck: 'good' },
        { name: '결혼 꿈', meaning: '싱글은 인연을, 기혼은 화목을 상징합니다. 아름다운 결혼식은 행복한 변화를, 반지를 끼면 약속이 이루어집니다.', luck: 'good' },
        { name: '승진/성공 꿈', meaning: '실제 성취를 예고하는 길몽입니다. 높은 곳에 오르거나 상을 받으면 실제로 인정받습니다.', luck: 'good' },
        { name: '돈 꿈', meaning: '재물과 가치를 상징합니다. 돈을 받으면 이익이, 돈을 세면 재물이 모입니다. 지폐보다 동전이 더 확실한 재물을 뜻합니다.', luck: 'good' },
        { name: '복권 당첨 꿈', meaning: '뜻밖의 행운을 상징합니다. 복권에 당첨되면 예상치 못한 좋은 일이, 번호가 보이면 그 숫자를 기억하세요.', luck: 'good' },
        { name: '선물 꿈', meaning: '사랑과 축복을 상징합니다. 선물을 받으면 예상치 못한 기쁨이, 선물을 주면 베푼 만큼 돌아옵니다.', luck: 'good' },
        { name: '밥/음식 꿈', meaning: '풍요와 행복을 상징합니다. 맛있는 음식을 먹으면 만족스러운 일이, 상을 차리면 경사가 있습니다.', luck: 'good' },
        { name: '새 집 꿈', meaning: '새로운 시작과 안정을 상징합니다. 새 집으로 이사하면 상황이 좋아지고, 넓은 집은 넉넉한 삶을 뜻합니다.', luck: 'good' },
        { name: '새 차 꿈', meaning: '발전과 이동을 상징합니다. 새 차를 타면 일이 잘 풀리고, 빠른 차는 빠른 성공을 의미합니다.', luck: 'good' },
        { name: '날개 꿈', meaning: '자유와 상승을 상징합니다. 날개가 생겨 날면 한계를 극복하고, 높이 날수록 더 큰 성취를 이룹니다.', luck: 'good' },
        { name: '보물 꿈', meaning: '숨겨진 가치를 상징합니다. 보물을 발견하면 자신의 잠재력을, 보물상자를 열면 기회를 잡습니다.', luck: 'good' },
        { name: '등불/빛 꿈', meaning: '깨달음과 희망을 상징합니다. 밝은 빛은 앞길이 밝음을, 촛불은 소원 성취를 의미합니다.', luck: 'good' },
      ],
    },
    {
      emoji: '⚠️',
      title: '주의 상징 꿈',
      items: [
        { name: '이빨 빠지는 꿈', meaning: '가족의 건강이나 재물 손실에 주의하세요. 하지만 새 이가 나면 오히려 길조입니다. 윗니는 윗사람을, 아랫니는 아랫사람을 상징합니다.', luck: 'bad' },
        { name: '쫓기는 꿈', meaning: '현실의 압박감을 반영합니다. 스트레스 관리가 필요합니다. 하지만 도망쳐 피하면 어려움을 극복합니다.', luck: 'bad' },
        { name: '떨어지는 꿈', meaning: '불안감을 반영합니다. 자신감을 가지세요. 착지에 성공하면 문제를 해결하고, 날아오르면 역전합니다.', luck: 'bad' },
        { name: '길을 잃는 꿈', meaning: '방향성 상실을 의미합니다. 계획을 재점검하세요. 길을 찾으면 해답을 얻고, 도움을 받으면 귀인이 나타납니다.', luck: 'normal' },
        { name: '시험 망치는 꿈', meaning: '준비 부족에 대한 불안입니다. 더 열심히 준비하세요. 역설적으로 실제 시험은 잘 볼 수 있습니다.', luck: 'normal' },
        { name: '물에 빠지는 꿈', meaning: '감정적 어려움을 상징합니다. 주변에 도움을 구하세요. 헤엄쳐 나오면 극복하고, 구출되면 도움을 받습니다.', luck: 'bad' },
        { name: '죽음 꿈', meaning: '끝과 재탄생을 상징합니다. 자신이 죽으면 오히려 새로운 시작을, 타인이 죽으면 관계의 변화를 의미합니다.', luck: 'normal' },
        { name: '싸움 꿈', meaning: '갈등과 스트레스를 반영합니다. 이기면 문제를 해결하고, 화해하면 관계가 좋아집니다.', luck: 'normal' },
        { name: '벌거벗은 꿈', meaning: '취약함을 느끼고 있음을 반영합니다. 자신감을 회복하세요. 부끄럽지 않으면 당당함을 뜻합니다.', luck: 'normal' },
        { name: '지각하는 꿈', meaning: '시간 압박과 불안을 반영합니다. 여유를 가지세요. 결국 도착하면 일이 잘 풀립니다.', luck: 'normal' },
        { name: '도둑 꿈', meaning: '손실과 배신을 주의하세요. 도둑을 잡으면 손실을 막고, 도둑이 도망가면 회복합니다.', luck: 'bad' },
        { name: '화재 꿈', meaning: '감정의 격동을 상징합니다. 불을 끄면 문제를 해결하고, 무사히 탈출하면 위기를 모면합니다.', luck: 'bad' },
        { name: '교통사고 꿈', meaning: '삶의 충돌을 경고합니다. 속도를 줄이고 신중히 행동하세요. 무사하면 위험을 피합니다.', luck: 'bad' },
        { name: '칼/무기 꿈', meaning: '공격성과 방어를 상징합니다. 칼을 들면 결단력을, 칼에 찔리면 비판에 상처받음을 의미합니다.', luck: 'normal' },
        { name: '병원 꿈', meaning: '치유의 필요성을 상징합니다. 건강을 점검하세요. 퇴원하면 회복을, 치료받으면 문제가 해결됩니다.', luck: 'normal' },
        { name: '감옥 꿈', meaning: '구속감과 제한을 상징합니다. 현재 상황에서 답답함을 느끼고 있습니다. 탈출하면 자유를 얻습니다.', luck: 'bad' },
      ],
    },
    {
      emoji: '🏠',
      title: '장소 꿈',
      items: [
        { name: '집 꿈', meaning: '자아와 가정을 상징합니다. 깨끗한 집은 안정을, 넓은 집은 발전을, 무너지는 집은 변화를 의미합니다.', luck: 'good' },
        { name: '학교 꿈', meaning: '배움과 성장을 상징합니다. 학교에 가면 새로운 것을 배우고, 졸업하면 한 단계 성장합니다.', luck: 'normal' },
        { name: '직장 꿈', meaning: '일과 책임을 상징합니다. 직장에서 일하면 현실의 과제를, 승진하면 성취를 의미합니다.', luck: 'normal' },
        { name: '시장/상점 꿈', meaning: '거래와 기회를 상징합니다. 물건을 사면 얻음을, 팔면 내보냄을 의미합니다.', luck: 'normal' },
        { name: '절/교회 꿈', meaning: '영성과 평화를 상징합니다. 기도하면 소원이 이루어지고, 종소리를 들으면 좋은 소식이 옵니다.', luck: 'good' },
        { name: '병원 꿈', meaning: '치유와 회복을 상징합니다. 병원에 가면 문제를 해결하고, 퇴원하면 완전히 회복합니다.', luck: 'normal' },
        { name: '공항/역 꿈', meaning: '변화와 여행을 상징합니다. 출발하면 새로운 시작을, 도착하면 목표 달성을 의미합니다.', luck: 'good' },
        { name: '바다/해변 꿈', meaning: '무의식과 감정을 상징합니다. 해변에서 쉬면 휴식이 필요하고, 파도를 타면 감정을 잘 다루고 있습니다.', luck: 'good' },
        { name: '산 정상 꿈', meaning: '성취와 목표를 상징합니다. 정상에 오르면 목표를 달성하고, 경치를 보면 넓은 시야를 얻습니다.', luck: 'good' },
        { name: '지하실/동굴 꿈', meaning: '무의식과 숨겨진 것을 상징합니다. 탐험하면 자아를 발견하고, 빛을 찾으면 깨달음을 얻습니다.', luck: 'normal' },
        { name: '다리 꿈', meaning: '연결과 전환을 상징합니다. 다리를 건너면 새로운 단계로 넘어가고, 무너지면 주의가 필요합니다.', luck: 'normal' },
        { name: '엘리베이터 꿈', meaning: '상승과 하강을 상징합니다. 올라가면 발전을, 내려가면 내면 탐구를 의미합니다. 고장 나면 정체를 뜻합니다.', luck: 'normal' },
      ],
    },
    {
      emoji: '🎭',
      title: '행동/상황 꿈',
      items: [
        { name: '날아다니는 꿈', meaning: '자유와 해방을 상징합니다. 높이 날수록 높은 이상을 향하고, 쉽게 날면 일이 순조롭습니다.', luck: 'good' },
        { name: '수영하는 꿈', meaning: '감정을 다루는 능력을 상징합니다. 쉽게 수영하면 감정 조절을 잘하고, 물이 맑으면 마음이 맑습니다.', luck: 'good' },
        { name: '운전하는 꿈', meaning: '인생의 방향을 상징합니다. 순조롭게 운전하면 잘 나아가고, 길을 잃으면 방향 재설정이 필요합니다.', luck: 'normal' },
        { name: '노래하는 꿈', meaning: '자기표현을 상징합니다. 아름답게 노래하면 인정받고, 청중이 있으면 사회적 성공을 뜻합니다.', luck: 'good' },
        { name: '춤추는 꿈', meaning: '기쁨과 조화를 상징합니다. 춤을 잘 추면 삶이 조화롭고, 파트너와 춤추면 협력이 좋습니다.', luck: 'good' },
        { name: '요리하는 꿈', meaning: '창조와 준비를 상징합니다. 맛있게 요리하면 일이 잘 풀리고, 음식을 대접하면 베풂의 기쁨이 있습니다.', luck: 'good' },
        { name: '청소하는 꿈', meaning: '정화와 정리를 상징합니다. 깨끗이 청소하면 문제가 해결되고, 먼지를 털면 걱정이 사라집니다.', luck: 'good' },
        { name: '공부하는 꿈', meaning: '성장과 준비를 상징합니다. 열심히 공부하면 실력이 향상되고, 이해가 되면 깨달음을 얻습니다.', luck: 'good' },
        { name: '웃는 꿈', meaning: '기쁨과 긍정을 상징합니다. 크게 웃으면 스트레스가 해소되고, 함께 웃으면 인간관계가 좋아집니다.', luck: 'good' },
        { name: '우는 꿈', meaning: '감정의 해소를 상징합니다. 실컷 울면 마음이 가벼워지고, 눈물이 그치면 희망이 보입니다.', luck: 'normal' },
        { name: '달리는 꿈', meaning: '추진력과 목표를 상징합니다. 빨리 달리면 목표에 빨리 도달하고, 지치면 휴식이 필요합니다.', luck: 'normal' },
        { name: '숨는 꿈', meaning: '회피와 보호를 상징합니다. 안전하게 숨으면 어려움을 피하고, 발견되면 직면이 필요합니다.', luck: 'normal' },
      ],
    },
    {
      emoji: '💰',
      title: '재물/숫자 꿈',
      items: [
        { name: '돈다발 꿈', meaning: '큰 재물을 상징합니다. 돈다발을 받으면 횡재가, 세면 재산이 늘어납니다.', luck: 'good' },
        { name: '금괴 꿈', meaning: '확실한 재물을 상징합니다. 금괴를 얻으면 안정적인 수입이, 금고에 넣으면 저축이 좋습니다.', luck: 'good' },
        { name: '숫자 3 꿈', meaning: '창조와 완성을 상징합니다. 3이 보이면 일이 완성되고, 세 번 반복되면 확실한 징조입니다.', luck: 'good' },
        { name: '숫자 7 꿈', meaning: '행운과 완전함을 상징합니다. 7이 보이면 행운이 따르고, 7개가 있으면 완벽한 상황입니다.', luck: 'good' },
        { name: '숫자 8 꿈', meaning: '풍요와 무한을 상징합니다. 8이 보이면 재물운이 좋고, 88은 특히 대길합니다.', luck: 'good' },
        { name: '동전 꿈', meaning: '소소한 행운을 상징합니다. 동전을 줍으면 작은 기쁨이, 많은 동전은 적은 것이 모여 큰 것이 됨을 뜻합니다.', luck: 'good' },
        { name: '지갑 꿈', meaning: '재정 상태를 상징합니다. 두툼한 지갑은 풍요를, 잃어버리면 지출에 주의하세요.', luck: 'normal' },
        { name: '은행 꿈', meaning: '재정 관리를 상징합니다. 은행에 가면 재정을 점검하고, 저축하면 미래가 안전합니다.', luck: 'good' },
        { name: '주식/투자 꿈', meaning: '기회와 위험을 상징합니다. 오르면 이익을, 내리면 주의를 의미합니다.', luck: 'normal' },
        { name: '보험 꿈', meaning: '안전과 준비를 상징합니다. 보험에 가입하면 미래에 대비하고 있습니다.', luck: 'good' },
        { name: '세금 꿈', meaning: '의무와 책임을 상징합니다. 세금을 내면 의무를 다하고, 환급받으면 보상을 받습니다.', luck: 'normal' },
        { name: '경매 꿈', meaning: '경쟁과 가치를 상징합니다. 낙찰받으면 원하는 것을 얻고, 놓치면 다른 기회를 찾으세요.', luck: 'normal' },
      ],
    },
  ];

  return {
    summary: '꿈은 무의식이 보내는 메시지입니다. 전통 해몽서의 지혜로 꿈의 의미를 풀어드립니다.',
    dreamCategories,
    luckyInfo: {
      ...getYongsinBasedLuckyInfo(dayMaster),
      item: '달맞이꽃',
    },
  };
}

// ============================================
// 띠 운세 (12지 동물띠 기반)
// ============================================

const ZODIAC_ANIMALS: Record<number, {
  name: string;
  emoji: string;
  element: string;
  personality: string;
  detailedPersonality: string;
  strengths: string[];
  weaknesses: string[];
  luckyNumbers: number[];
  luckyColors: string[];
  luckyDirection: string;
  compatibleSigns: string[];
  incompatibleSigns: string[];
  careerAptitude: string;
  loveStyle: string;
  healthAdvice: string;
}> = {
  0: {
    name: '원숭이띠',
    emoji: '🐵',
    element: '금(金)',
    personality: '영리하고 재치 있으며 다재다능합니다.',
    detailedPersonality: '원숭이띠는 총명하고 영리하여 어떤 상황에서도 기지를 발휘합니다. 호기심이 강하고 새로운 것을 배우는 데 빠르며, 유머 감각이 뛰어나 주변을 즐겁게 합니다. 다재다능하여 여러 분야에서 능력을 발휘하지만, 가끔 끈기가 부족할 수 있습니다.',
    strengths: ['지능이 높고 학습 능력이 뛰어남', '임기응변에 능함', '유머러스하고 사교적', '창의적이고 혁신적', '문제 해결 능력이 탁월'],
    weaknesses: ['끈기가 부족할 수 있음', '가끔 교활하게 보일 수 있음', '한 가지에 집중하기 어려움', '과신하는 경향'],
    luckyNumbers: [1, 7, 8],
    luckyColors: ['흰색', '금색', '파란색'],
    luckyDirection: '서쪽',
    compatibleSigns: ['쥐띠', '용띠'],
    incompatibleSigns: ['호랑이띠', '돼지띠'],
    careerAptitude: '컨설턴트, 변호사, 영업, 엔터테이너, 프로그래머, 마케터 등 두뇌를 활용하는 직종에 적합합니다.',
    loveStyle: '재미있고 유쾌한 연애를 즐기며, 상대를 웃게 만드는 재주가 있습니다. 다만 진지해지기까지 시간이 걸릴 수 있습니다.',
    healthAdvice: '신경계와 피부 건강에 주의하세요. 스트레스 관리가 중요합니다.',
  },
  1: {
    name: '닭띠',
    emoji: '🐔',
    element: '금(金)',
    personality: '부지런하고 성실하며 자신감이 있습니다.',
    detailedPersonality: '닭띠는 부지런하고 성실하여 맡은 일은 반드시 완수합니다. 시간 관념이 철저하고 계획적이며, 외모와 이미지를 중시합니다. 자신감이 넘치고 솔직하지만, 가끔 비판적으로 보일 수 있습니다.',
    strengths: ['부지런하고 성실함', '시간 약속을 철저히 지킴', '꼼꼼하고 세심함', '자신감과 용기가 있음', '솔직하고 정직함'],
    weaknesses: ['지나치게 비판적일 수 있음', '자기주장이 강함', '완벽주의 성향', '가끔 허영심이 있음'],
    luckyNumbers: [5, 7, 8],
    luckyColors: ['금색', '갈색', '노란색'],
    luckyDirection: '서쪽',
    compatibleSigns: ['소띠', '뱀띠'],
    incompatibleSigns: ['토끼띠', '개띠'],
    careerAptitude: '회계사, 연구원, 작가, 언론인, 디자이너, 공무원 등 세밀함이 필요한 직종에 적합합니다.',
    loveStyle: '낭만적이고 헌신적인 연인이지만, 상대에게도 높은 기준을 요구할 수 있습니다.',
    healthAdvice: '호흡기와 피부 건강에 주의하세요. 충분한 휴식이 필요합니다.',
  },
  2: {
    name: '개띠',
    emoji: '🐕',
    element: '토(土)',
    personality: '충직하고 정의로우며 의리가 있습니다.',
    detailedPersonality: '개띠는 충직하고 의리가 있어 한 번 맺은 인연을 소중히 합니다. 정의감이 강하고 불의를 보면 참지 못하며, 가족과 친구를 위해 헌신합니다. 솔직하고 진실되지만, 가끔 비관적이거나 걱정이 많을 수 있습니다.',
    strengths: ['충성심이 강함', '정의롭고 공정함', '책임감이 강함', '믿음직스러움', '용감하고 보호 본능이 있음'],
    weaknesses: ['걱정이 많음', '가끔 비관적', '고집이 셀 수 있음', '변화를 싫어함'],
    luckyNumbers: [3, 4, 9],
    luckyColors: ['초록색', '빨간색', '보라색'],
    luckyDirection: '동쪽',
    compatibleSigns: ['호랑이띠', '말띠', '토끼띠'],
    incompatibleSigns: ['용띠', '양띠', '닭띠'],
    careerAptitude: '경찰, 군인, 사회복지사, 변호사, 교사, 의료인 등 정의와 봉사가 필요한 직종에 적합합니다.',
    loveStyle: '한 사람에게 충실하고 헌신적인 연인입니다. 신뢰를 중시하며, 배신에는 쉽게 용서하지 않습니다.',
    healthAdvice: '소화기와 비장 건강에 주의하세요. 스트레스로 인한 위장 장애에 조심하세요.',
  },
  3: {
    name: '돼지띠',
    emoji: '🐷',
    element: '수(水)',
    personality: '낙천적이고 순수하며 복이 많습니다.',
    detailedPersonality: '돼지띠는 낙천적이고 순수하여 주변을 밝게 합니다. 성격이 좋고 인정이 많아 사람들에게 사랑받으며, 물질적 복이 많아 풍요로운 삶을 살 가능성이 높습니다. 다만 순진해서 가끔 이용당할 수 있으니 주의가 필요합니다.',
    strengths: ['낙천적이고 긍정적', '순수하고 선량함', '관대하고 너그러움', '인내심이 강함', '물질적 복이 많음'],
    weaknesses: ['순진하여 이용당할 수 있음', '게으름 피울 수 있음', '충동적인 소비 성향', '우유부단할 수 있음'],
    luckyNumbers: [2, 5, 8],
    luckyColors: ['노란색', '회색', '갈색'],
    luckyDirection: '북쪽',
    compatibleSigns: ['양띠', '토끼띠'],
    incompatibleSigns: ['뱀띠', '원숭이띠'],
    careerAptitude: '요리사, 예술가, 음악가, 접객업, 자선사업, 농업 등 사람을 즐겁게 하는 직종에 적합합니다.',
    loveStyle: '다정다감하고 포용력이 넓어 좋은 연인이 됩니다. 상대를 편안하게 해주는 능력이 있습니다.',
    healthAdvice: '신장과 방광 건강에 주의하세요. 과식과 과음을 피하고 규칙적인 운동을 하세요.',
  },
  4: {
    name: '쥐띠',
    emoji: '🐀',
    element: '수(水)',
    personality: '똑똒하고 기민하며 적응력이 뛰어납니다.',
    detailedPersonality: '쥐띠는 영리하고 기민하여 어떤 환경에서도 적응을 잘합니다. 관찰력이 뛰어나고 기회를 빨리 포착하며, 알뜰하고 저축 정신이 강합니다. 사교적이지만 가끔 계산적으로 보일 수 있습니다.',
    strengths: ['영리하고 총명함', '적응력이 뛰어남', '알뜰하고 절약 정신이 강함', '기회 포착 능력이 탁월', '사교성이 좋음'],
    weaknesses: ['가끔 계산적으로 보임', '소심할 수 있음', '비밀이 많음', '집착하는 경향'],
    luckyNumbers: [2, 3],
    luckyColors: ['파란색', '금색', '초록색'],
    luckyDirection: '북쪽',
    compatibleSigns: ['원숭이띠', '용띠', '소띠'],
    incompatibleSigns: ['말띠', '양띠'],
    careerAptitude: '금융업, 상업, 작가, 변호사, 정치인, 연구원 등 두뇌를 활용하는 직종에 적합합니다.',
    loveStyle: '세심하고 다정하지만, 질투심이 있을 수 있습니다. 상대의 작은 변화도 빨리 알아챕니다.',
    healthAdvice: '신장과 방광 건강에 주의하세요. 충분한 수분 섭취가 중요합니다.',
  },
  5: {
    name: '소띠',
    emoji: '🐂',
    element: '토(土)',
    personality: '근면 성실하고 인내심이 강합니다.',
    detailedPersonality: '소띠는 근면 성실하여 묵묵히 자신의 길을 갑니다. 인내심이 강하고 책임감이 투철하며, 가족을 위해 헌신합니다. 신뢰할 수 있는 사람이지만, 가끔 고집이 세고 융통성이 부족할 수 있습니다.',
    strengths: ['근면 성실함', '인내심이 강함', '책임감이 투철', '신뢰할 수 있음', '가족을 소중히 여김'],
    weaknesses: ['고집이 셀 수 있음', '융통성이 부족', '표현력이 부족', '변화에 느린 적응'],
    luckyNumbers: [1, 4],
    luckyColors: ['흰색', '노란색', '초록색'],
    luckyDirection: '남쪽',
    compatibleSigns: ['쥐띠', '뱀띠', '닭띠'],
    incompatibleSigns: ['양띠', '말띠', '개띠'],
    careerAptitude: '농업, 부동산, 은행업, 교육, 의료, 엔지니어 등 꾸준함이 필요한 직종에 적합합니다.',
    loveStyle: '진지하고 헌신적인 연인입니다. 천천히 사랑에 빠지지만 한 번 빠지면 깊이 사랑합니다.',
    healthAdvice: '소화기와 비장 건강에 주의하세요. 규칙적인 식사가 중요합니다.',
  },
  6: {
    name: '호랑이띠',
    emoji: '🐯',
    element: '목(木)',
    personality: '용맹하고 자존심이 강하며 리더십이 있습니다.',
    detailedPersonality: '호랑이띠는 용맹하고 당당하여 타고난 리더입니다. 자존심이 강하고 정의감이 있으며, 도전을 두려워하지 않습니다. 카리스마가 있지만, 가끔 성급하거나 독단적일 수 있습니다.',
    strengths: ['용감하고 당당함', '리더십이 뛰어남', '정의감이 강함', '도전 정신이 있음', '카리스마가 있음'],
    weaknesses: ['성급할 수 있음', '독단적인 경향', '고집이 셈', '감정 기복이 있을 수 있음'],
    luckyNumbers: [1, 3, 4],
    luckyColors: ['파란색', '회색', '오렌지색'],
    luckyDirection: '동쪽',
    compatibleSigns: ['말띠', '개띠'],
    incompatibleSigns: ['원숭이띠', '뱀띠'],
    careerAptitude: '경영인, 군인, 운동선수, 정치인, 모험가, 탐험가 등 리더십이 필요한 직종에 적합합니다.',
    loveStyle: '열정적이고 보호 본능이 강한 연인입니다. 상대를 향한 헌신이 크지만 독점욕도 있습니다.',
    healthAdvice: '간과 담낭 건강에 주의하세요. 분노 조절이 건강에 중요합니다.',
  },
  7: {
    name: '토끼띠',
    emoji: '🐰',
    element: '목(木)',
    personality: '온순하고 상냥하며 예술적 감각이 있습니다.',
    detailedPersonality: '토끼띠는 온순하고 상냥하여 누구에게나 사랑받습니다. 예술적 감각이 뛰어나고 아름다운 것을 좋아하며, 평화를 사랑합니다. 외교적이고 세련되지만, 가끔 우유부단하거나 소심할 수 있습니다.',
    strengths: ['온순하고 상냥함', '예술적 감각이 뛰어남', '외교적이고 세련됨', '평화를 사랑함', '직관력이 좋음'],
    weaknesses: ['우유부단할 수 있음', '갈등을 피하는 성향', '소심할 수 있음', '현실 도피 경향'],
    luckyNumbers: [3, 4, 6],
    luckyColors: ['빨간색', '분홍색', '보라색', '파란색'],
    luckyDirection: '동쪽',
    compatibleSigns: ['양띠', '돼지띠', '개띠'],
    incompatibleSigns: ['닭띠'],
    careerAptitude: '예술가, 디자이너, 음악가, 외교관, 상담사, 작가 등 감성이 필요한 직종에 적합합니다.',
    loveStyle: '로맨틱하고 다정한 연인입니다. 편안하고 아름다운 관계를 추구합니다.',
    healthAdvice: '간과 눈 건강에 주의하세요. 스트레스 관리가 중요합니다.',
  },
  8: {
    name: '용띠',
    emoji: '🐲',
    element: '토(土)',
    personality: '카리스마 있고 야망이 크며 운이 좋습니다.',
    detailedPersonality: '용띠는 카리스마가 넘치고 야망이 커서 큰 꿈을 꿉니다. 동양에서 가장 상서로운 동물로, 타고난 운이 좋습니다. 자신감이 넘치고 에너지가 강하지만, 가끔 오만하거나 완벽주의적일 수 있습니다.',
    strengths: ['카리스마가 있음', '야망이 크고 목표 지향적', '운이 좋음', '자신감이 넘침', '에너지와 열정이 강함'],
    weaknesses: ['오만해 보일 수 있음', '완벽주의 성향', '독선적인 경향', '쉽게 분노할 수 있음'],
    luckyNumbers: [1, 6, 7],
    luckyColors: ['금색', '은색', '회색'],
    luckyDirection: '동쪽',
    compatibleSigns: ['쥐띠', '원숭이띠', '닭띠'],
    incompatibleSigns: ['개띠', '토끼띠'],
    careerAptitude: '기업가, 정치인, 연예인, 운동선수, CEO, 예술가 등 큰 무대가 필요한 직종에 적합합니다.',
    loveStyle: '열정적이고 관대한 연인입니다. 상대에게 최고의 것을 주려 하지만 기대도 큽니다.',
    healthAdvice: '소화기와 비장 건강에 주의하세요. 스트레스로 인한 위장 장애에 조심하세요.',
  },
  9: {
    name: '뱀띠',
    emoji: '🐍',
    element: '화(火)',
    personality: '지혜롭고 신중하며 직관력이 뛰어납니다.',
    detailedPersonality: '뱀띠는 지혜롭고 신중하여 깊은 사고력을 가지고 있습니다. 직관력이 뛰어나고 통찰력이 있으며, 겉으로는 차분하지만 내면은 열정적입니다. 신비로운 매력이 있지만, 가끔 의심이 많거나 질투심이 생길 수 있습니다.',
    strengths: ['지혜롭고 통찰력이 있음', '직관력이 뛰어남', '신중하고 계획적', '차분하고 침착함', '신비로운 매력'],
    weaknesses: ['의심이 많을 수 있음', '질투심이 있음', '비밀스러움', '가끔 냉정해 보임'],
    luckyNumbers: [2, 8, 9],
    luckyColors: ['빨간색', '밝은 노란색', '검은색'],
    luckyDirection: '남쪽',
    compatibleSigns: ['소띠', '닭띠'],
    incompatibleSigns: ['호랑이띠', '돼지띠'],
    careerAptitude: '철학자, 연구원, 심리학자, 탐정, 의사, 점술가 등 깊은 통찰이 필요한 직종에 적합합니다.',
    loveStyle: '깊고 강렬한 사랑을 합니다. 신비로운 매력으로 상대를 끌어당기지만 독점욕이 강합니다.',
    healthAdvice: '심장과 소장 건강에 주의하세요. 명상이나 요가가 도움이 됩니다.',
  },
  10: {
    name: '말띠',
    emoji: '🐴',
    element: '화(火)',
    personality: '활발하고 사교적이며 자유를 사랑합니다.',
    detailedPersonality: '말띠는 활발하고 에너지가 넘쳐 어디서나 분위기 메이커입니다. 사교적이고 외향적이며, 자유를 사랑하고 모험을 즐깁니다. 열정적이지만, 가끔 끈기가 부족하거나 충동적일 수 있습니다.',
    strengths: ['활발하고 에너지가 넘침', '사교적이고 외향적', '자유롭고 독립적', '열정적이고 긍정적', '모험심이 강함'],
    weaknesses: ['끈기가 부족할 수 있음', '충동적인 경향', '인내심이 부족', '과시욕이 있을 수 있음'],
    luckyNumbers: [2, 3, 7],
    luckyColors: ['노란색', '초록색'],
    luckyDirection: '남쪽',
    compatibleSigns: ['호랑이띠', '양띠', '개띠'],
    incompatibleSigns: ['쥐띠', '소띠'],
    careerAptitude: '여행가, 운동선수, 세일즈, 엔터테이너, 기자, 마케터 등 활동적인 직종에 적합합니다.',
    loveStyle: '자유롭고 열정적인 연애를 즐깁니다. 구속받는 것을 싫어하며 상대의 독립성도 존중합니다.',
    healthAdvice: '심장과 소장 건강에 주의하세요. 과로를 피하고 충분한 휴식이 필요합니다.',
  },
  11: {
    name: '양띠',
    emoji: '🐑',
    element: '토(土)',
    personality: '온화하고 예술적이며 동정심이 많습니다.',
    detailedPersonality: '양띠는 온화하고 부드러워 사람들에게 편안함을 줍니다. 예술적 감각이 뛰어나고 창의력이 있으며, 동정심이 많아 남을 잘 돕습니다. 다만 너무 착해서 이용당하거나 우유부단할 수 있습니다.',
    strengths: ['온화하고 부드러움', '예술적 감각이 뛰어남', '창의력이 있음', '동정심과 공감 능력이 높음', '적응력이 좋음'],
    weaknesses: ['우유부단할 수 있음', '의존적인 경향', '걱정이 많음', '비관적일 수 있음'],
    luckyNumbers: [2, 7],
    luckyColors: ['초록색', '빨간색', '보라색'],
    luckyDirection: '남쪽',
    compatibleSigns: ['토끼띠', '말띠', '돼지띠'],
    incompatibleSigns: ['소띠', '개띠'],
    careerAptitude: '예술가, 디자이너, 간호사, 상담사, 교사, 자선사업 등 감성과 봉사가 필요한 직종에 적합합니다.',
    loveStyle: '따뜻하고 헌신적인 연인입니다. 상대에게 편안함과 안정을 주며, 낭만적인 사랑을 합니다.',
    healthAdvice: '소화기와 비장 건강에 주의하세요. 균형 잡힌 식사가 중요합니다.',
  },
};

// 2026년 병오년(말띠 해) 기준 띠별 운세
// 병(丙)은 화(火), 오(午)는 말띠이며 화(火)의 기운
// 오(午)와의 관계: 삼합(인오술-화국), 육합(미), 상충(자), 상해(축), 상형(오-자형)
const ANIMAL_YEARLY_FORTUNE: Record<number, {
  overall: string;
  score: number;
  wealth: { content: string; score: number };
  career: { content: string; score: number };
  love: { content: string; score: number };
  health: { content: string; score: number };
  advice: string;
}> = {
  0: { // 원숭이띠 (申) - 오(午)와 특별한 관계 없음
    overall: '2026년은 원숭이띠에게 안정적인 해입니다. 지혜를 발휘하여 기회를 잡을 수 있습니다.',
    score: 75,
    wealth: { content: '안정적인 재물운입니다. 신중한 투자가 좋은 결과를 가져옵니다.', score: 73 },
    career: { content: '꾸준한 노력이 인정받습니다. 급하게 서두르지 마세요.', score: 75 },
    love: { content: '기존 관계가 더욱 돈독해질 수 있습니다.', score: 72 },
    health: { content: '스트레스 관리에 신경 쓰세요.', score: 70 },
    advice: '차분하게 계획을 세우고 실행하세요.',
  },
  1: { // 닭띠 (酉) - 오(午)와 특별한 관계 없음
    overall: '2026년은 닭띠에게 도전의 해입니다. 새로운 기회에 적극적으로 임하세요.',
    score: 76,
    wealth: { content: '노력한 만큼 결실이 있습니다. 부수입의 기회가 있을 수 있습니다.', score: 74 },
    career: { content: '능력을 보여줄 기회가 많습니다. 자신감을 가지세요.', score: 78 },
    love: { content: '솔직한 대화가 관계 발전의 열쇠입니다.', score: 72 },
    health: { content: '규칙적인 생활이 건강 유지에 도움됩니다.', score: 70 },
    advice: '완벽주의보다 실행력이 중요한 해입니다.',
  },
  2: { // 개띠 (戌) - 오술(午戌) 반합(화국의 일부)
    overall: '2026년은 개띠에게 발전의 해입니다. 오술 반합으로 화(火)의 좋은 기운이 있습니다.',
    score: 82,
    wealth: { content: '재물운이 상승합니다. 투자에 좋은 시기입니다.', score: 80 },
    career: { content: '승진이나 새로운 기회가 찾아옵니다. 적극적으로 도전하세요.', score: 85 },
    love: { content: '열정적인 만남이 기대됩니다. 인연운이 좋습니다.', score: 80 },
    health: { content: '활력이 넘치지만 과로에 주의하세요.', score: 75 },
    advice: '적극적인 자세가 행운을 부릅니다.',
  },
  3: { // 돼지띠 (亥) - 오(午)와 특별한 관계 없음
    overall: '2026년은 돼지띠에게 평온한 해입니다. 안정 속에서 준비하는 시간으로 삼으세요.',
    score: 72,
    wealth: { content: '큰 변동 없이 안정적인 재물운입니다. 저축을 권합니다.', score: 70 },
    career: { content: '현재 위치에서 실력을 다지세요.', score: 72 },
    love: { content: '편안한 관계가 이어집니다.', score: 74 },
    health: { content: '소화기 건강에 신경 쓰세요.', score: 68 },
    advice: '무리하지 말고 내실을 다지는 해로 삼으세요.',
  },
  4: { // 쥐띠 (子) - 오자충(午子冲) 상충!
    overall: '2026년은 쥐띠에게 주의가 필요한 해입니다. 오자충(午子冲)으로 말띠 해와 상충합니다.',
    score: 58,
    wealth: { content: '재물 손실에 주의하세요. 무리한 투자나 보증은 피하세요.', score: 55 },
    career: { content: '직장에서 변동이 있을 수 있습니다. 신중하게 대처하세요.', score: 58 },
    love: { content: '갈등이 생기기 쉽습니다. 대화로 풀어가세요.', score: 55 },
    health: { content: '건강 관리에 특히 신경 쓰세요. 정기 검진을 권합니다.', score: 52 },
    advice: '올해는 큰 결정을 미루고, 겸손하게 처신하세요. 붉은색 소품이 액막이에 도움됩니다.',
  },
  5: { // 소띠 (丑) - 오축상해(午丑相害)
    overall: '2026년은 소띠에게 인내가 필요한 해입니다. 오축상해로 갈등의 기운이 있습니다.',
    score: 62,
    wealth: { content: '재물 관리에 신중하세요. 예상치 못한 지출이 있을 수 있습니다.', score: 60 },
    career: { content: '인간관계에서 오해가 생길 수 있습니다. 신중하게 처신하세요.', score: 62 },
    love: { content: '오해를 풀기 위한 대화가 필요합니다.', score: 58 },
    health: { content: '스트레스 관리에 힘쓰세요.', score: 60 },
    advice: '참을 인(忍)자를 새기세요. 겸손과 인내가 필요한 해입니다.',
  },
  6: { // 호랑이띠 (寅) - 인오술 삼합(화국)!
    overall: '2026년은 호랑이띠에게 대길의 해입니다! 인오술 삼합으로 화(火)의 강한 기운이 돕습니다.',
    score: 88,
    wealth: { content: '재물운이 크게 상승합니다. 투자나 사업 확장에 좋은 시기입니다.', score: 88 },
    career: { content: '승진, 성공의 기회가 많습니다. 리더십을 발휘하세요.', score: 90 },
    love: { content: '열정적인 만남이 기대됩니다. 결혼운도 좋습니다.', score: 85 },
    health: { content: '활력이 넘칩니다. 에너지를 잘 활용하세요.', score: 82 },
    advice: '올해는 적극적으로 도전하세요! 큰 성과를 거둘 수 있습니다.',
  },
  7: { // 토끼띠 (卯) - 오(午)와 특별한 관계 없음
    overall: '2026년은 토끼띠에게 순조로운 해입니다. 차분하게 목표를 향해 나아가세요.',
    score: 74,
    wealth: { content: '안정적인 수입이 이어집니다. 저축에 좋은 해입니다.', score: 72 },
    career: { content: '꾸준한 노력이 결실을 맺습니다.', score: 75 },
    love: { content: '부드러운 관계가 이어집니다. 소통을 중시하세요.', score: 76 },
    health: { content: '전반적으로 양호합니다.', score: 74 },
    advice: '급하지 않게, 자신의 페이스를 유지하세요.',
  },
  8: { // 용띠 (辰) - 오(午)와 특별한 관계 없음
    overall: '2026년은 용띠에게 안정적인 해입니다. 작년의 성과를 다지는 시간으로 삼으세요.',
    score: 76,
    wealth: { content: '안정적인 재물운입니다. 무리한 확장보다 내실을 다지세요.', score: 74 },
    career: { content: '기존 업무에서 좋은 성과가 있습니다.', score: 78 },
    love: { content: '관계가 더욱 깊어질 수 있습니다.', score: 75 },
    health: { content: '규칙적인 생활을 유지하세요.', score: 72 },
    advice: '내실을 다지며 다음 도약을 준비하세요.',
  },
  9: { // 뱀띠 (巳) - 오(午)와 특별한 관계 없음
    overall: '2026년은 뱀띠에게 발전의 해입니다. 지혜를 발휘할 기회가 많습니다.',
    score: 78,
    wealth: { content: '재물운이 좋습니다. 신중한 투자가 수익을 가져옵니다.', score: 77 },
    career: { content: '전문성이 인정받습니다. 자신감을 가지세요.', score: 80 },
    love: { content: '깊은 인연을 만날 수 있습니다.', score: 75 },
    health: { content: '전반적으로 양호하나 과로에 주의하세요.', score: 72 },
    advice: '지혜롭게 기회를 포착하세요.',
  },
  10: { // 말띠 (午) - 본명년!
    overall: '2026년은 말띠에게 본명년입니다. 자기 자신을 돌아보고 새롭게 시작하는 해입니다.',
    score: 68,
    wealth: { content: '본명년에는 재물의 변동이 있을 수 있습니다. 보수적으로 관리하세요.', score: 65 },
    career: { content: '큰 변화보다 내실을 다지는 것이 좋습니다.', score: 68 },
    love: { content: '자신을 먼저 돌보세요. 관계도 더 깊어질 수 있습니다.', score: 70 },
    health: { content: '건강 관리에 특히 신경 쓰세요. 정기 검진을 권합니다.', score: 62 },
    advice: '본명년에는 붉은색 소품을 지니면 액막이가 됩니다. 겸손하게 처신하세요.',
  },
  11: { // 양띠 (未) - 오미육합(午未合)!
    overall: '2026년은 양띠에게 대길의 해입니다! 오미육합으로 말띠 해와 합하여 좋은 기운이 가득합니다.',
    score: 86,
    wealth: { content: '재물운이 크게 상승합니다. 협력을 통한 이익이 큽니다.', score: 85 },
    career: { content: '인정받고 승진하는 기회가 많습니다. 적극적으로 임하세요.', score: 88 },
    love: { content: '좋은 인연이 찾아옵니다. 결혼운도 좋습니다.', score: 85 },
    health: { content: '마음이 편안하여 건강도 좋습니다.', score: 80 },
    advice: '올해의 좋은 기운을 적극 활용하세요! 큰 성과가 기대됩니다.',
  },
};

function getAnimalSign(birthYear: number): number {
  return birthYear % 12;
}

// 천간에 따른 띠 색상 (전통 명칭)
const STEM_ZODIAC_COLORS: Record<string, string> = {
  '갑': '푸른', '을': '푸른',   // 목(木) = 청색/푸른색
  '병': '붉은', '정': '붉은',   // 화(火) = 적색/붉은색
  '무': '노란', '기': '노란',   // 토(土) = 황색/노란색
  '경': '흰', '신': '흰',       // 금(金) = 백색/흰색
  '임': '검은', '계': '검은',   // 수(水) = 흑색/검은색
};

export function generateAnimalFortune(birthDate: string, dayMaster: string = '갑') {
  const year = parseInt(birthDate.split('-')[0], 10);
  const animalIndex = getAnimalSign(year);
  const animal = ZODIAC_ANIMALS[animalIndex];
  const fortune = ANIMAL_YEARLY_FORTUNE[animalIndex];

  // 년간(천간)으로부터 띠 색상 결정
  const yearGanji = getYearGanji(year);
  const zodiacColor = STEM_ZODIAC_COLORS[yearGanji.stem] || '';
  const fullZodiacName = `${zodiacColor}${animal.name.replace('띠', '')}띠`;  // 예: 푸른쥐띠
  const yearHanja = `${yearGanji.stemHanja}${yearGanji.branchHanja}`;  // 예: 甲子

  return {
    summary: `${animal.emoji} ${fullZodiacName} (${yearHanja})\n${animal.personality}\n\n${fortune.overall}`,
    score: fortune.score,
    animalInfo: {
      name: fullZodiacName,  // 푸른쥐띠 형식으로 변경
      emoji: animal.emoji,
      element: `${STEM_ELEMENTS[yearGanji.stem]}(${yearGanji.stemHanja})`,  // 년간 오행 표시
      personality: animal.personality,
      yearHanja: yearHanja,  // 甲子 등 한자 정보 추가
      originalName: animal.name,  // 원래 띠 이름 보존
    },
    categories: [
      {
        emoji: '💰',
        title: '재물운',
        content: fortune.wealth.content,
        score: fortune.wealth.score,
      },
      {
        emoji: '💼',
        title: '직장/사업운',
        content: fortune.career.content,
        score: fortune.career.score,
      },
      {
        emoji: '❤️',
        title: '애정운',
        content: fortune.love.content,
        score: fortune.love.score,
      },
      {
        emoji: '🏥',
        title: '건강운',
        content: fortune.health.content,
        score: fortune.health.score,
      },
    ],
    luckyInfo: getYongsinBasedLuckyInfo(dayMaster),
    caution: fortune.advice,
  };
}

// ============================================
// 오늘의 길운 (Lucky Info - 명리학 용신론 기반)
// ============================================

// 일간(日干)별 용신 색상 - 명리학 용신론 기반
const YONGSHIN_COLORS: Record<string, { color: string; element: string; reason: string }> = {
  '갑': { color: '초록색', element: '목(木)', reason: '갑목 일간에게 목(木) 기운이 자신을 돕는 색입니다.' },
  '을': { color: '연두색', element: '목(木)', reason: '을목 일간에게 부드러운 목(木) 기운이 어울립니다.' },
  '병': { color: '빨간색', element: '화(火)', reason: '병화 일간에게 화(火) 기운이 활력을 더합니다.' },
  '정': { color: '분홍색', element: '화(火)', reason: '정화 일간에게 부드러운 화(火) 기운이 어울립니다.' },
  '무': { color: '노란색', element: '토(土)', reason: '무토 일간에게 토(土) 기운이 안정을 줍니다.' },
  '기': { color: '갈색', element: '토(土)', reason: '기토 일간에게 부드러운 토(土) 기운이 어울립니다.' },
  '경': { color: '흰색', element: '금(金)', reason: '경금 일간에게 금(金) 기운이 결단력을 더합니다.' },
  '신': { color: '은색', element: '금(金)', reason: '신금 일간에게 부드러운 금(金) 기운이 어울립니다.' },
  '임': { color: '검은색', element: '수(水)', reason: '임수 일간에게 수(水) 기운이 지혜를 더합니다.' },
  '계': { color: '파란색', element: '수(水)', reason: '계수 일간에게 부드러운 수(水) 기운이 어울립니다.' },
};

// 일간별 행운의 방향 - 오행 방위론 기반
const YONGSHIN_DIRECTIONS: Record<string, { direction: string; reason: string }> = {
  '갑': { direction: '동쪽', reason: '목(木) 기운은 동쪽에서 옵니다.' },
  '을': { direction: '동쪽', reason: '목(木) 기운은 동쪽에서 옵니다.' },
  '병': { direction: '남쪽', reason: '화(火) 기운은 남쪽에서 옵니다.' },
  '정': { direction: '남쪽', reason: '화(火) 기운은 남쪽에서 옵니다.' },
  '무': { direction: '중앙', reason: '토(土) 기운은 중앙에서 옵니다.' },
  '기': { direction: '중앙', reason: '토(土) 기운은 중앙에서 옵니다.' },
  '경': { direction: '서쪽', reason: '금(金) 기운은 서쪽에서 옵니다.' },
  '신': { direction: '서쪽', reason: '금(金) 기운은 서쪽에서 옵니다.' },
  '임': { direction: '북쪽', reason: '수(水) 기운은 북쪽에서 옵니다.' },
  '계': { direction: '북쪽', reason: '수(水) 기운은 북쪽에서 옵니다.' },
};

// 일간별 행운의 물건 - 오행 상생 기반
const YONGSHIN_ITEMS: Record<string, { item: string; reason: string }> = {
  '갑': { item: '관엽식물, 나무 소품', reason: '목(木) 기운을 북돋아 주는 물건입니다.' },
  '을': { item: '꽃다발, 허브화분', reason: '부드러운 목(木) 기운을 더해주는 물건입니다.' },
  '병': { item: '조명, 양초', reason: '화(火) 기운을 활성화하는 물건입니다.' },
  '정': { item: '향초, 따뜻한 음료', reason: '부드러운 화(火) 기운을 더해주는 물건입니다.' },
  '무': { item: '도자기, 흙 화분', reason: '토(土) 기운을 안정시키는 물건입니다.' },
  '기': { item: '크리스탈, 천연석', reason: '부드러운 토(土) 기운을 더해주는 물건입니다.' },
  '경': { item: '금속 장신구, 시계', reason: '금(金) 기운을 강화하는 물건입니다.' },
  '신': { item: '은 액세서리, 동전', reason: '부드러운 금(金) 기운을 더해주는 물건입니다.' },
  '임': { item: '수정, 어항', reason: '수(水) 기운을 활성화하는 물건입니다.' },
  '계': { item: '분수, 수반', reason: '부드러운 수(水) 기운을 더해주는 물건입니다.' },
};

// 일간별 피해야 할 것들 - 오행 상극 기반 (기신)
const GISHIN_WARNINGS: Record<string, { color: string; direction: string; reason: string }> = {
  '갑': { color: '흰색/은색', direction: '서쪽', reason: '금(金)이 목(木)을 극합니다.' },
  '을': { color: '흰색/은색', direction: '서쪽', reason: '금(金)이 목(木)을 극합니다.' },
  '병': { color: '검은색/파란색', direction: '북쪽', reason: '수(水)가 화(火)를 극합니다.' },
  '정': { color: '검은색/파란색', direction: '북쪽', reason: '수(水)가 화(火)를 극합니다.' },
  '무': { color: '초록색', direction: '동쪽', reason: '목(木)이 토(土)를 극합니다.' },
  '기': { color: '초록색', direction: '동쪽', reason: '목(木)이 토(土)를 극합니다.' },
  '경': { color: '빨간색', direction: '남쪽', reason: '화(火)가 금(金)을 극합니다.' },
  '신': { color: '빨간색', direction: '남쪽', reason: '화(火)가 금(金)을 극합니다.' },
  '임': { color: '노란색/갈색', direction: '중앙', reason: '토(土)가 수(水)를 극합니다.' },
  '계': { color: '노란색/갈색', direction: '중앙', reason: '토(土)가 수(水)를 극합니다.' },
};

// ============================================
// 5신 체계 (용신/희신/기신/구신/한신) - 명리학 핵심 이론
// 출처: 적천수(滴天髓), 자평진전(子平眞詮)
// ============================================

/**
 * 5신 체계 설명
 * - 용신(用神): 사주에서 가장 필요한 오행, 사주의 균형을 맞추는 핵심
 * - 희신(喜神): 용신을 돕는 오행, 용신을 생하거나 도움
 * - 기신(忌神): 용신을 극하거나 방해하는 오행
 * - 구신(仇神): 기신을 돕는 오행, 기신을 생함
 * - 한신(閑神): 사주에 영향이 미미한 중립적 오행
 */

// 오행 상극 관계
const FIVE_ELEMENTS_CONTROLS: Record<string, string> = {
  '목': '토', // 목극토
  '토': '수', // 토극수
  '수': '화', // 수극화
  '화': '금', // 화극금
  '금': '목', // 금극목
};

// 오행별 한자
const ELEMENT_HANJA: Record<string, string> = {
  '목': '木', '화': '火', '토': '土', '금': '金', '수': '水',
};

// 5신 분류 결과 타입
interface FiveSpiritAnalysis {
  yongsin: { element: string; hanja: string; description: string };
  heesin: { element: string; hanja: string; description: string };
  gisin: { element: string; hanja: string; description: string };
  gusin: { element: string; hanja: string; description: string };
  hansin: { element: string; hanja: string; description: string };
  summary: string;
  advice: string;
}

/**
 * 5신 분석 함수
 * 일간 오행과 사주 오행 분포를 기반으로 용신/희신/기신/구신/한신 분석
 * @param dayMasterElement 일간 오행 (목/화/토/금/수)
 * @param elements 사주 오행 분포 { 목: n, 화: n, 토: n, 금: n, 수: n }
 */
export function analyzeFiveSpirits(
  dayMasterElement: string,
  elements: Record<string, number>
): FiveSpiritAnalysis {
  // 일간이 강한지 약한지 판단 (비겁+인성 vs 식상+재성+관성)
  const myElement = dayMasterElement;
  const generatesMe = Object.keys(FIVE_ELEMENTS_GENERATES).find(
    k => FIVE_ELEMENTS_GENERATES[k] === myElement
  ) || '수';
  const iGenerate = FIVE_ELEMENTS_GENERATES[myElement];
  const iControl = FIVE_ELEMENTS_CONTROLS[myElement];
  const controlsMe = Object.keys(FIVE_ELEMENTS_CONTROLS).find(
    k => FIVE_ELEMENTS_CONTROLS[k] === myElement
  ) || '금';

  // 나를 돕는 세력 (비겁: 같은 오행, 인성: 나를 생하는 오행)
  const helpForce = (elements[myElement] || 0) + (elements[generatesMe] || 0);
  // 나를 약화시키는 세력 (식상, 재성, 관성)
  const weakenForce = (elements[iGenerate] || 0) + (elements[iControl] || 0) + (elements[controlsMe] || 0);

  const isStrong = helpForce > weakenForce;

  // 용신 결정 (억부용신 기준 - 적천수 이론)
  // 강하면 설기(식상/재성) 필요, 약하면 생조(인성/비겁) 필요
  let yongsinElement: string;
  let heesinElement: string;
  let gisinElement: string;
  let gusinElement: string;
  let hansinElement: string;

  if (isStrong) {
    // 일간이 강하면: 용신 = 식상(내가 생하는 것) 또는 재성(내가 극하는 것)
    yongsinElement = iGenerate; // 식상 (설기)
    heesinElement = iControl; // 재성 (용신 도움)
    gisinElement = generatesMe; // 인성 (용신 방해)
    gusinElement = myElement; // 비겁 (기신 도움)
    hansinElement = controlsMe; // 관성 (중립)
  } else {
    // 일간이 약하면: 용신 = 인성(나를 생하는 것) 또는 비겁(같은 오행)
    yongsinElement = generatesMe; // 인성 (생조)
    heesinElement = myElement; // 비겁 (용신 도움)
    gisinElement = controlsMe; // 관성 (용신 방해)
    gusinElement = iControl; // 재성 (기신 도움)
    hansinElement = iGenerate; // 식상 (중립)
  }

  return {
    yongsin: {
      element: yongsinElement,
      hanja: ELEMENT_HANJA[yongsinElement],
      description: `${yongsinElement}(${ELEMENT_HANJA[yongsinElement]}) - 사주에서 가장 필요한 오행입니다. 이 기운이 강해지면 운이 좋아집니다.`,
    },
    heesin: {
      element: heesinElement,
      hanja: ELEMENT_HANJA[heesinElement],
      description: `${heesinElement}(${ELEMENT_HANJA[heesinElement]}) - 용신을 돕는 오행입니다. 용신과 함께 길운을 만듭니다.`,
    },
    gisin: {
      element: gisinElement,
      hanja: ELEMENT_HANJA[gisinElement],
      description: `${gisinElement}(${ELEMENT_HANJA[gisinElement]}) - 용신을 방해하는 오행입니다. 이 기운이 강해지면 주의가 필요합니다.`,
    },
    gusin: {
      element: gusinElement,
      hanja: ELEMENT_HANJA[gusinElement],
      description: `${gusinElement}(${ELEMENT_HANJA[gusinElement]}) - 기신을 돕는 오행입니다. 기신과 함께 흉운을 만들 수 있습니다.`,
    },
    hansin: {
      element: hansinElement,
      hanja: ELEMENT_HANJA[hansinElement],
      description: `${hansinElement}(${ELEMENT_HANJA[hansinElement]}) - 영향이 미미한 중립적 오행입니다.`,
    },
    summary: isStrong
      ? `일간이 강하여 설기(泄氣)가 필요합니다. ${yongsinElement}(${ELEMENT_HANJA[yongsinElement]}) 기운이 용신입니다.`
      : `일간이 약하여 생조(生助)가 필요합니다. ${yongsinElement}(${ELEMENT_HANJA[yongsinElement]}) 기운이 용신입니다.`,
    advice: isStrong
      ? `${yongsinElement} 색상(${getElementColor(yongsinElement)})의 물건이나 ${getElementDirection(yongsinElement)} 방향이 길합니다.`
      : `${yongsinElement} 색상(${getElementColor(yongsinElement)})의 물건이나 ${getElementDirection(yongsinElement)} 방향이 길합니다.`,
  };
}

// 오행별 색상
function getElementColor(element: string): string {
  const colors: Record<string, string> = {
    '목': '초록색', '화': '빨간색', '토': '노란색', '금': '흰색', '수': '검은색',
  };
  return colors[element] || '노란색';
}

// 오행별 방향
function getElementDirection(element: string): string {
  const directions: Record<string, string> = {
    '목': '동쪽', '화': '남쪽', '토': '중앙', '금': '서쪽', '수': '북쪽',
  };
  return directions[element] || '중앙';
}

// ============================================
// 토정비결 144괘 계산법 (개선된 버전)
// 출처: 토정 이지함 선생 저술
// ============================================

/**
 * 토정비결 괘 계산
 * 상괘(연괘): (태세 + 나이) ÷ 8의 나머지 (1~8)
 * 중괘(월괘): (월건 수 + 나이) ÷ 6의 나머지 (1~6)
 * 하괘(일괘): (일진 수 + 나이) ÷ 3의 나머지 (1~3)
 * 총 144괘 조합
 */

// 월건 수 (음력 월 기준)
const MONTH_NUMBERS: Record<number, number> = {
  1: 10, 2: 9, 3: 8, 4: 7, 5: 6, 6: 5,
  7: 4, 8: 3, 9: 2, 10: 1, 11: 12, 12: 11,
};

// 144괘 중 대표적인 괘 해석 (상괘×중괘×하괘)
// 상괘(1-8): 건(乾), 태(兌), 이(離), 진(震), 손(巽), 감(坎), 간(艮), 곤(坤)
// 중괘(1-6): 건(乾), 태(兌), 이(離), 진(震), 손(巽), 간(艮)
// 하괘(1-3): 건(乾), 곤(坤), 감(坎)
const TOJEONG_144_FORTUNES: Record<string, {
  name: string;
  meaning: string;
  fortune: string;
  advice: string;
  score: number;
  seasonal: {
    spring: string;
    summer: string;
    autumn: string;
    winter: string;
  };
  monthly: string[];
  category: {
    wealth: { score: number; text: string };
    career: { score: number; text: string };
    love: { score: number; text: string };
    health: { score: number; text: string };
  };
}> = {
  // ========== 상괘 1 (건/乾) - 하늘 ==========
  '1-1-1': {
    name: '건건건(乾乾乾)',
    meaning: '하늘 위에 하늘이 있으니 가장 높은 경지에 오르는 상',
    fortune: '최상의 대길한 해입니다. 하늘이 세 번 겹친 상으로, 만사형통하고 하는 일마다 순조롭습니다. 큰 뜻을 품고 적극적으로 나아가면 성공을 이룰 수 있습니다. 용이 하늘로 오르는 형상으로, 평소에 품었던 큰 꿈을 실현할 수 있는 때입니다.',
    advice: '겸손을 잃지 않으면 복이 배가됩니다. 높은 곳에 있을수록 낮은 곳을 살피세요.',
    score: 95,
    seasonal: {
      spring: '봄에는 새로운 시작이 특히 길합니다. 씨앗을 뿌리면 반드시 결실을 맺습니다.',
      summer: '여름에는 활동력이 최고조에 달합니다. 적극적으로 움직이세요.',
      autumn: '가을에는 그동안의 노력이 결실을 맺습니다. 수확의 기쁨을 누리세요.',
      winter: '겨울에는 내년을 위한 계획을 세우기 좋습니다. 충분한 휴식도 취하세요.',
    },
    monthly: ['길', '길', '대길', '길', '대길', '길', '길', '대길', '길', '길', '대길', '길'],
    category: {
      wealth: { score: 95, text: '재물이 풍족하게 들어오는 상입니다. 투자에도 좋은 시기이며, 횡재수도 기대할 수 있습니다.' },
      career: { score: 96, text: '승진, 합격, 성공의 운이 있습니다. 리더십을 발휘할 기회가 많으며, 큰 프로젝트도 성공적으로 마무리됩니다.' },
      love: { score: 90, text: '좋은 인연을 만나거나 기존 관계가 더욱 깊어집니다. 혼인운도 좋습니다.' },
      health: { score: 88, text: '건강이 양호합니다. 다만 너무 바쁘게 움직여 과로하지 않도록 주의하세요.' },
    },
  },
  '1-1-2': {
    name: '건건곤(乾乾坤)',
    meaning: '하늘과 땅이 조화를 이루어 음양이 균형을 이루는 상',
    fortune: '음양이 조화로운 대길한 해입니다. 하늘과 땅이 만나 만물이 생성되듯, 새로운 것을 시작하기에 좋은 때입니다. 안정 속에서 발전이 있으며, 균형 잡힌 삶을 살 수 있습니다.',
    advice: '균형을 유지하며 나아가세요. 한쪽으로 치우치지 않는 것이 중요합니다.',
    score: 88,
    seasonal: {
      spring: '봄에는 새로운 시작이 길합니다. 계획했던 일을 시작하세요.',
      summer: '여름에는 활발한 활동이 좋습니다. 에너지가 넘칩니다.',
      autumn: '가을에는 균형 있는 생활이 중요합니다. 무리하지 마세요.',
      winter: '겨울에는 내실을 다지는 시기입니다. 조용히 준비하세요.',
    },
    monthly: ['길', '길', '길', '대길', '길', '길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 85, text: '재물운이 안정적입니다. 큰 횡재보다는 꾸준한 수입이 있습니다.' },
      career: { score: 88, text: '직장에서 인정받고 안정적인 성과를 거둡니다.' },
      love: { score: 90, text: '연인 관계가 조화롭고, 결혼 운도 좋습니다.' },
      health: { score: 85, text: '건강이 균형 잡혀 있습니다. 규칙적인 생활을 유지하세요.' },
    },
  },
  '1-1-3': {
    name: '건건감(乾乾坎)',
    meaning: '하늘 아래 물이 있으니 지혜가 필요한 상',
    fortune: '지혜로운 판단이 필요한 해입니다. 하늘 아래 깊은 물이 있듯, 표면 아래를 잘 살펴야 합니다. 신중하게 행동하면 좋은 결과가 있습니다.',
    advice: '성급한 결정은 피하세요. 깊이 생각하고 행동하세요.',
    score: 75,
    seasonal: {
      spring: '봄에는 조심스럽게 시작하세요. 서두르지 마세요.',
      summer: '여름에는 더위로 인한 판단력 저하에 주의하세요.',
      autumn: '가을에는 운이 상승합니다. 좋은 기회가 옵니다.',
      winter: '겨울에는 내면을 성찰하기 좋습니다.',
    },
    monthly: ['보통', '보통', '길', '길', '보통', '보통', '길', '길', '보통', '길', '보통', '보통'],
    category: {
      wealth: { score: 70, text: '재물운에 기복이 있습니다. 투자보다 저축이 좋습니다.' },
      career: { score: 75, text: '신중하게 일을 처리하면 인정받습니다.' },
      love: { score: 72, text: '감정에 휘둘리지 말고 이성적으로 판단하세요.' },
      health: { score: 68, text: '신장과 방광 건강에 주의하세요.' },
    },
  },
  '1-2-1': {
    name: '건태건(乾兌乾)',
    meaning: '하늘과 연못이 어우러져 기쁨이 넘치는 상',
    fortune: '즐거운 일이 많은 해입니다. 연못의 물이 반짝이듯 기쁜 소식이 찾아옵니다. 인간관계가 활발해지고 좋은 인연을 만날 수 있습니다.',
    advice: '좋은 인연을 소중히 하세요. 베풀면 더 많이 돌아옵니다.',
    score: 85,
    seasonal: {
      spring: '봄에는 새로운 인연이 들어옵니다.',
      summer: '여름에는 모임과 행사가 많습니다.',
      autumn: '가을에는 인간관계에서 기쁜 일이 생깁니다.',
      winter: '겨울에는 가족과의 화목이 길합니다.',
    },
    monthly: ['길', '대길', '길', '길', '대길', '길', '길', '길', '대길', '길', '길', '대길'],
    category: {
      wealth: { score: 82, text: '인맥을 통한 재물 운이 좋습니다.' },
      career: { score: 83, text: '팀워크가 좋아 성과를 거둡니다.' },
      love: { score: 90, text: '연애운이 매우 좋습니다. 좋은 만남이 있습니다.' },
      health: { score: 80, text: '스트레스가 적어 건강합니다.' },
    },
  },
  '1-2-2': {
    name: '건태곤(乾兌坤)',
    meaning: '하늘과 땅 사이에 기쁨이 있으니 화합의 상',
    fortune: '화합이 잘 이루어지는 해입니다. 위아래가 소통하고 가정과 직장 모두 평화롭습니다.',
    advice: '협력을 통해 더 큰 성과를 얻습니다.',
    score: 82,
    seasonal: {
      spring: '봄에는 협력 관계가 좋습니다.',
      summer: '여름에는 가족 행사가 길합니다.',
      autumn: '가을에는 결실을 함께 나누세요.',
      winter: '겨울에는 따뜻한 관계가 중요합니다.',
    },
    monthly: ['길', '길', '길', '길', '대길', '길', '길', '길', '길', '대길', '길', '길'],
    category: {
      wealth: { score: 80, text: '동업이나 투자에서 좋은 결과가 있습니다.' },
      career: { score: 82, text: '상사와의 관계가 좋아 승진 기회가 있습니다.' },
      love: { score: 85, text: '연인과의 관계가 깊어집니다.' },
      health: { score: 80, text: '정신 건강이 좋습니다.' },
    },
  },
  '1-2-3': {
    name: '건태감(乾兌坎)',
    meaning: '기쁨 속에 어려움이 숨어있으니 조심해야 하는 상',
    fortune: '좋은 일 중에도 작은 어려움이 있을 수 있습니다. 기쁜 마음에 방심하지 말고 항상 조심하세요.',
    advice: '기쁨에 취해 방심하지 마세요. 신중함을 유지하세요.',
    score: 70,
    seasonal: {
      spring: '봄에는 조심스럽게 행동하세요.',
      summer: '여름에는 물놀이나 수해에 주의하세요.',
      autumn: '가을에는 운이 상승합니다.',
      winter: '겨울에는 건강에 유의하세요.',
    },
    monthly: ['보통', '길', '보통', '길', '보통', '보통', '길', '보통', '길', '보통', '길', '보통'],
    category: {
      wealth: { score: 68, text: '예상치 못한 지출에 주의하세요.' },
      career: { score: 70, text: '성과가 있지만 방심하면 실수할 수 있습니다.' },
      love: { score: 72, text: '관계는 좋지만 오해가 생길 수 있습니다.' },
      health: { score: 65, text: '감기나 수인성 질병에 주의하세요.' },
    },
  },
  '1-3-1': {
    name: '건이건(乾離乾)',
    meaning: '하늘 위에 태양이 떠오르니 밝은 미래의 상',
    fortune: '밝고 희망찬 해입니다. 태양처럼 빛나는 성과를 거둘 수 있으며, 명예와 인정을 받습니다.',
    advice: '자신감을 갖고 전진하세요. 빛나는 미래가 기다립니다.',
    score: 88,
    seasonal: {
      spring: '봄에는 새로운 도전이 성공합니다.',
      summer: '여름에는 최고의 성과를 거둡니다.',
      autumn: '가을에는 명예를 얻습니다.',
      winter: '겨울에는 내년을 준비하며 빛날 수 있습니다.',
    },
    monthly: ['길', '대길', '대길', '길', '길', '대길', '길', '대길', '길', '길', '길', '길'],
    category: {
      wealth: { score: 85, text: '재물운이 밝습니다. 투자도 좋은 시기입니다.' },
      career: { score: 90, text: '승진과 인정의 기회가 많습니다.' },
      love: { score: 82, text: '밝은 에너지로 좋은 인연을 끌어당깁니다.' },
      health: { score: 80, text: '활력이 넘칩니다. 눈 건강에만 주의하세요.' },
    },
  },
  '1-3-2': {
    name: '건이곤(乾離坤)',
    meaning: '하늘과 태양과 땅이 조화를 이루는 상',
    fortune: '조화로운 발전의 해입니다. 밝은 에너지와 안정적인 기반이 함께합니다.',
    advice: '균형을 유지하며 발전하세요.',
    score: 83,
    seasonal: {
      spring: '봄에는 계획이 순조롭게 진행됩니다.',
      summer: '여름에는 열정적으로 활동하세요.',
      autumn: '가을에는 수확의 기쁨이 있습니다.',
      winter: '겨울에는 안정을 찾습니다.',
    },
    monthly: ['길', '길', '대길', '길', '길', '길', '대길', '길', '길', '길', '길', '대길'],
    category: {
      wealth: { score: 82, text: '꾸준한 수입과 저축으로 재산이 늘어납니다.' },
      career: { score: 85, text: '안정적인 성장이 있습니다.' },
      love: { score: 80, text: '따뜻한 관계가 지속됩니다.' },
      health: { score: 82, text: '체력이 좋습니다.' },
    },
  },
  '1-3-3': {
    name: '건이감(乾離坎)',
    meaning: '하늘과 불과 물이 만나니 기복이 있는 상',
    fortune: '변화가 많은 해입니다. 좋은 때와 어려운 때가 번갈아 옵니다. 유연하게 대처하세요.',
    advice: '상황에 맞게 유연하게 대처하세요.',
    score: 68,
    seasonal: {
      spring: '봄에는 변화에 적응하세요.',
      summer: '여름에는 화재와 수해에 주의하세요.',
      autumn: '가을에는 안정을 찾습니다.',
      winter: '겨울에는 내실을 다지세요.',
    },
    monthly: ['보통', '길', '보통', '보통', '길', '보통', '보통', '길', '보통', '보통', '길', '보통'],
    category: {
      wealth: { score: 65, text: '재물에 기복이 있습니다. 저축을 우선하세요.' },
      career: { score: 70, text: '변화가 있지만 잘 적응하면 괜찮습니다.' },
      love: { score: 68, text: '감정 기복에 주의하세요.' },
      health: { score: 65, text: '심장과 신장 건강을 살피세요.' },
    },
  },
  // ========== 상괘 2 (태/兌) - 연못 ==========
  '2-1-1': {
    name: '태건건(兌乾乾)',
    meaning: '연못 위에 하늘이 높으니 기쁨이 배가되는 상',
    fortune: '기쁨이 배가되는 대길한 해입니다. 연못에 하늘이 비치듯 좋은 일이 연이어 찾아옵니다.',
    advice: '베풀면 더 큰 기쁨이 돌아옵니다.',
    score: 87,
    seasonal: {
      spring: '봄에는 새로운 기쁨이 찾아옵니다.',
      summer: '여름에는 활발한 사회 활동이 좋습니다.',
      autumn: '가을에는 풍성한 결실이 있습니다.',
      winter: '겨울에는 따뜻한 모임이 길합니다.',
    },
    monthly: ['대길', '길', '길', '대길', '길', '길', '대길', '길', '길', '대길', '길', '길'],
    category: {
      wealth: { score: 85, text: '예상치 못한 횡재가 있을 수 있습니다.' },
      career: { score: 86, text: '인맥을 통한 기회가 많습니다.' },
      love: { score: 90, text: '연애와 결혼에 좋은 운입니다.' },
      health: { score: 82, text: '정신적으로 건강합니다.' },
    },
  },
  '2-2-1': {
    name: '태태건(兌兌乾)',
    meaning: '기쁨이 겹치니 경사가 많은 상',
    fortune: '경사가 겹치는 해입니다. 결혼, 출산, 취직 등 좋은 일이 연달아 일어날 수 있습니다.',
    advice: '기쁨을 나누면 배가 됩니다.',
    score: 90,
    seasonal: {
      spring: '봄에는 경사가 있습니다.',
      summer: '여름에는 사회활동이 왕성합니다.',
      autumn: '가을에는 풍성한 수확이 있습니다.',
      winter: '겨울에는 가족 모임이 좋습니다.',
    },
    monthly: ['대길', '대길', '길', '길', '대길', '대길', '길', '길', '대길', '길', '길', '대길'],
    category: {
      wealth: { score: 88, text: '재물운이 매우 좋습니다.' },
      career: { score: 85, text: '동료들과 협력하여 성과를 거둡니다.' },
      love: { score: 92, text: '결혼운이 특히 좋습니다.' },
      health: { score: 85, text: '즐거운 마음이 건강을 지킵니다.' },
    },
  },
  '2-3-1': {
    name: '태이건(兌離乾)',
    meaning: '기쁨과 밝음이 함께하니 환희의 상',
    fortune: '환희로운 해입니다. 밝은 에너지와 기쁨이 함께하여 모든 일이 순조롭습니다.',
    advice: '밝은 마음을 유지하세요.',
    score: 86,
    seasonal: {
      spring: '봄에는 희망이 가득합니다.',
      summer: '여름에는 활력이 넘칩니다.',
      autumn: '가을에는 성취의 기쁨이 있습니다.',
      winter: '겨울에도 따뜻한 기운이 유지됩니다.',
    },
    monthly: ['길', '대길', '길', '대길', '길', '길', '대길', '길', '길', '대길', '길', '길'],
    category: {
      wealth: { score: 84, text: '재물이 들어오고 나가는 순환이 좋습니다.' },
      career: { score: 86, text: '창의적인 아이디어가 인정받습니다.' },
      love: { score: 88, text: '밝은 성격이 좋은 인연을 끌어당깁니다.' },
      health: { score: 82, text: '활력이 넘치지만 눈 건강에 주의하세요.' },
    },
  },
  // ========== 상괘 3 (이/離) - 불 ==========
  '3-1-1': {
    name: '이건건(離乾乾)',
    meaning: '불이 하늘 위에 있으니 밝게 빛나는 상',
    fortune: '빛나는 성공의 해입니다. 당신의 능력과 재능이 인정받아 명예와 지위가 올라갑니다.',
    advice: '겸손함을 잃지 마세요. 빛은 겸손할 때 더 아름답습니다.',
    score: 88,
    seasonal: {
      spring: '봄에는 새로운 도전이 성공합니다.',
      summer: '여름에는 최고조의 성과를 거둡니다.',
      autumn: '가을에는 명예를 얻습니다.',
      winter: '겨울에는 다음을 준비하세요.',
    },
    monthly: ['길', '대길', '대길', '길', '대길', '길', '길', '대길', '길', '길', '길', '길'],
    category: {
      wealth: { score: 82, text: '명예와 함께 재물도 따릅니다.' },
      career: { score: 92, text: '승진과 인정의 기회가 많습니다.' },
      love: { score: 78, text: '일에 집중하느라 연애에 소홀할 수 있습니다.' },
      health: { score: 75, text: '과로에 주의하고 눈 건강을 챙기세요.' },
    },
  },
  '3-2-2': {
    name: '이태곤(離兌坤)',
    meaning: '불과 연못과 땅이 조화를 이루는 상',
    fortune: '조화로운 발전의 해입니다. 열정과 즐거움이 안정 위에서 꽃을 피웁니다.',
    advice: '균형 잡힌 삶을 추구하세요.',
    score: 80,
    seasonal: {
      spring: '봄에는 열정적으로 시작하세요.',
      summer: '여름에는 즐거운 활동이 많습니다.',
      autumn: '가을에는 안정적인 결실이 있습니다.',
      winter: '겨울에는 휴식을 취하세요.',
    },
    monthly: ['길', '길', '길', '대길', '길', '길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 78, text: '안정적인 수입이 있습니다.' },
      career: { score: 80, text: '꾸준한 성과가 있습니다.' },
      love: { score: 82, text: '연인과의 관계가 안정적입니다.' },
      health: { score: 80, text: '건강이 양호합니다.' },
    },
  },
  '3-4-2': {
    name: '이진곤(離震坤)',
    meaning: '불과 우레와 땅이 만나니 변화 속의 발전',
    fortune: '변화가 많지만 발전하는 해입니다. 격동 속에서도 성장합니다.',
    advice: '변화를 두려워하지 마세요. 변화는 성장의 기회입니다.',
    score: 75,
    seasonal: {
      spring: '봄에는 활발한 움직임이 있습니다.',
      summer: '여름에는 빠른 변화에 적응하세요.',
      autumn: '가을에는 안정을 찾습니다.',
      winter: '겨울에는 내실을 다지세요.',
    },
    monthly: ['길', '보통', '길', '길', '보통', '길', '길', '보통', '길', '길', '길', '보통'],
    category: {
      wealth: { score: 72, text: '변동이 있지만 전체적으로 상승합니다.' },
      career: { score: 78, text: '변화에 잘 적응하면 승진 기회가 있습니다.' },
      love: { score: 70, text: '관계에 변화가 있을 수 있습니다.' },
      health: { score: 72, text: '스트레스 관리에 주의하세요.' },
    },
  },
  // ========== 상괘 4 (진/震) - 우레 ==========
  '4-1-1': {
    name: '진건건(震乾乾)',
    meaning: '우레가 하늘을 울리니 크게 움직이는 상',
    fortune: '큰 변화와 도약의 해입니다. 우레처럼 강렬한 에너지로 새로운 시작을 할 수 있습니다.',
    advice: '용기를 갖고 도전하세요. 때가 왔습니다.',
    score: 85,
    seasonal: {
      spring: '봄에는 새로운 시작이 대길합니다.',
      summer: '여름에는 활발한 활동이 좋습니다.',
      autumn: '가을에는 성과를 거둡니다.',
      winter: '겨울에는 다음 도약을 준비하세요.',
    },
    monthly: ['대길', '길', '길', '길', '대길', '길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 82, text: '적극적인 활동으로 재물을 얻습니다.' },
      career: { score: 88, text: '도전적인 일에서 성과를 거둡니다.' },
      love: { score: 78, text: '적극적인 구애가 좋습니다.' },
      health: { score: 80, text: '활력이 넘칩니다.' },
    },
  },
  '4-5-3': {
    name: '진손감(震巽坎)',
    meaning: '우레와 바람과 물이 만나니 격동의 상',
    fortune: '격동의 해입니다. 변화가 많고 예측이 어렵지만, 잘 대처하면 성장합니다.',
    advice: '에너지를 분산하지 마세요. 한 가지에 집중하세요.',
    score: 68,
    seasonal: {
      spring: '봄에는 변화에 주의하세요.',
      summer: '여름에는 수해에 주의하세요.',
      autumn: '가을에는 안정을 찾습니다.',
      winter: '겨울에는 내실을 다지세요.',
    },
    monthly: ['보통', '보통', '길', '보통', '보통', '길', '보통', '보통', '길', '보통', '보통', '길'],
    category: {
      wealth: { score: 65, text: '지출에 주의하세요.' },
      career: { score: 70, text: '변화에 잘 적응해야 합니다.' },
      love: { score: 65, text: '관계의 변동에 주의하세요.' },
      health: { score: 68, text: '사고에 주의하세요.' },
    },
  },
  // ========== 상괘 5 (손/巽) - 바람 ==========
  '5-1-1': {
    name: '손건건(巽乾乾)',
    meaning: '바람이 하늘을 가르니 순풍에 돛을 단 상',
    fortune: '순풍에 돛을 단 것처럼 모든 일이 순조롭습니다. 막힘없이 앞으로 나아갈 수 있습니다.',
    advice: '순풍일 때 더 멀리 나아가세요.',
    score: 86,
    seasonal: {
      spring: '봄에는 순풍이 붑니다.',
      summer: '여름에는 더 멀리 나아가세요.',
      autumn: '가을에는 풍성한 결실이 있습니다.',
      winter: '겨울에는 안정을 취하세요.',
    },
    monthly: ['길', '길', '대길', '길', '길', '대길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 84, text: '재물이 순조롭게 들어옵니다.' },
      career: { score: 88, text: '일이 순조롭게 풀립니다.' },
      love: { score: 82, text: '인연이 자연스럽게 이어집니다.' },
      health: { score: 85, text: '호흡기 건강이 좋습니다.' },
    },
  },
  '5-6-1': {
    name: '손간건(巽艮乾)',
    meaning: '바람과 산이 조화를 이루니 안정 속의 발전',
    fortune: '안정과 발전이 함께하는 해입니다. 굳건한 기반 위에서 성장합니다.',
    advice: '기본에 충실하세요. 기본이 튼튼하면 모든 것이 가능합니다.',
    score: 83,
    seasonal: {
      spring: '봄에는 새로운 시작이 안정적입니다.',
      summer: '여름에는 꾸준히 발전합니다.',
      autumn: '가을에는 결실을 거둡니다.',
      winter: '겨울에는 내실을 다집니다.',
    },
    monthly: ['길', '길', '길', '대길', '길', '길', '길', '대길', '길', '길', '길', '대길'],
    category: {
      wealth: { score: 82, text: '안정적인 수입과 저축이 가능합니다.' },
      career: { score: 85, text: '안정적인 승진 기회가 있습니다.' },
      love: { score: 80, text: '안정적인 관계가 지속됩니다.' },
      health: { score: 85, text: '건강이 좋습니다.' },
    },
  },
  // ========== 상괘 6 (감/坎) - 물 ==========
  '6-1-1': {
    name: '감건건(坎乾乾)',
    meaning: '물이 하늘을 향해 흐르니 극복과 성취의 상',
    fortune: '어려움을 극복하고 성취하는 해입니다. 역경을 이겨내면 큰 성공이 기다립니다.',
    advice: '포기하지 마세요. 어둠이 지나면 빛이 옵니다.',
    score: 78,
    seasonal: {
      spring: '봄에는 희망이 솟아납니다.',
      summer: '여름에는 노력의 결실이 보입니다.',
      autumn: '가을에는 성취의 기쁨이 있습니다.',
      winter: '겨울에는 다음을 준비하세요.',
    },
    monthly: ['보통', '길', '길', '길', '대길', '길', '길', '대길', '길', '길', '길', '길'],
    category: {
      wealth: { score: 75, text: '노력 끝에 재물을 얻습니다.' },
      career: { score: 80, text: '어려운 일을 해결하여 인정받습니다.' },
      love: { score: 72, text: '인내가 필요한 관계입니다.' },
      health: { score: 70, text: '신장 건강에 주의하세요.' },
    },
  },
  '6-1-2': {
    name: '감건곤(坎乾坤)',
    meaning: '물이 하늘과 땅 사이를 흐르니 유연함의 상',
    fortune: '유연하게 적응하는 해입니다. 상황에 맞게 유연하게 대처하면 좋은 결과가 있습니다.',
    advice: '한 걸음씩 차근차근 나아가세요.',
    score: 75,
    seasonal: {
      spring: '봄에는 흐름에 맞추세요.',
      summer: '여름에는 물을 다루는 일이 좋습니다.',
      autumn: '가을에는 안정을 찾습니다.',
      winter: '겨울에는 준비하세요.',
    },
    monthly: ['보통', '길', '보통', '길', '길', '보통', '길', '보통', '길', '길', '보통', '길'],
    category: {
      wealth: { score: 72, text: '유연한 재정 관리가 필요합니다.' },
      career: { score: 75, text: '적응력이 중요합니다.' },
      love: { score: 70, text: '유연한 자세로 관계를 유지하세요.' },
      health: { score: 68, text: '수분 섭취에 신경 쓰세요.' },
    },
  },
  // ========== 상괘 7 (간/艮) - 산 ==========
  '7-1-1': {
    name: '간건건(艮乾乾)',
    meaning: '산 위에 하늘이 높으니 높은 이상을 향하는 상',
    fortune: '높은 목표를 향해 나아가는 해입니다. 꾸준히 노력하면 정상에 오를 수 있습니다.',
    advice: '조급해하지 말고 한 걸음씩 나아가세요.',
    score: 82,
    seasonal: {
      spring: '봄에는 새로운 목표를 세우세요.',
      summer: '여름에는 꾸준히 올라가세요.',
      autumn: '가을에는 정상이 보입니다.',
      winter: '겨울에는 정상에서 쉬세요.',
    },
    monthly: ['길', '길', '길', '길', '대길', '길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 78, text: '꾸준한 노력으로 재물을 모읍니다.' },
      career: { score: 85, text: '높은 목표를 달성합니다.' },
      love: { score: 75, text: '진지한 관계가 좋습니다.' },
      health: { score: 80, text: '등산 등 야외 활동이 좋습니다.' },
    },
  },
  '7-2-3': {
    name: '간태감(艮兌坎)',
    meaning: '산과 연못과 물이 만나니 감정의 기복',
    fortune: '감정의 기복이 있을 수 있는 해입니다. 평정심을 유지하는 것이 중요합니다.',
    advice: '감정 조절이 중요합니다. 마음의 평화를 유지하세요.',
    score: 65,
    seasonal: {
      spring: '봄에는 감정 기복에 주의하세요.',
      summer: '여름에는 더위로 예민해질 수 있습니다.',
      autumn: '가을에는 안정을 찾습니다.',
      winter: '겨울에는 우울함에 주의하세요.',
    },
    monthly: ['보통', '보통', '길', '보통', '보통', '길', '보통', '보통', '길', '보통', '보통', '보통'],
    category: {
      wealth: { score: 62, text: '감정에 휘둘려 지출하지 마세요.' },
      career: { score: 68, text: '인간관계에서 감정 조절이 필요합니다.' },
      love: { score: 60, text: '감정 기복이 관계에 영향을 줄 수 있습니다.' },
      health: { score: 65, text: '정신 건강에 주의하세요.' },
    },
  },
  // ========== 상괘 8 (곤/坤) - 땅 ==========
  '8-1-1': {
    name: '곤건건(坤乾乾)',
    meaning: '땅 위에 하늘이 높으니 크게 열리는 상',
    fortune: '새로운 시작이 크게 열리는 해입니다. 낮은 곳에서 시작하여 높은 곳으로 올라갑니다.',
    advice: '겸손하게 시작하면 크게 성공합니다.',
    score: 84,
    seasonal: {
      spring: '봄에는 새로운 시작이 좋습니다.',
      summer: '여름에는 발전합니다.',
      autumn: '가을에는 결실을 거둡니다.',
      winter: '겨울에는 내실을 다집니다.',
    },
    monthly: ['길', '대길', '길', '길', '길', '대길', '길', '길', '대길', '길', '길', '길'],
    category: {
      wealth: { score: 82, text: '기초부터 시작하여 재산을 모읍니다.' },
      career: { score: 85, text: '밑바닥부터 시작해도 크게 성공합니다.' },
      love: { score: 80, text: '겸손한 자세가 좋은 인연을 만납니다.' },
      health: { score: 82, text: '건강합니다.' },
    },
  },
  '8-3-1': {
    name: '곤이건(坤離乾)',
    meaning: '땅과 불과 하늘이 조화를 이루니 발전의 상',
    fortune: '내실을 다지며 발전하는 해입니다. 기초를 튼튼히 하면 높이 올라갈 수 있습니다.',
    advice: '기초를 튼튼히 하세요.',
    score: 80,
    seasonal: {
      spring: '봄에는 기초를 다지세요.',
      summer: '여름에는 열정적으로 발전하세요.',
      autumn: '가을에는 결실이 있습니다.',
      winter: '겨울에는 내년을 준비하세요.',
    },
    monthly: ['길', '길', '대길', '길', '길', '길', '대길', '길', '길', '길', '대길', '길'],
    category: {
      wealth: { score: 78, text: '기초가 튼튼한 투자가 좋습니다.' },
      career: { score: 82, text: '실력을 쌓아 인정받습니다.' },
      love: { score: 78, text: '진실한 관계가 좋습니다.' },
      health: { score: 80, text: '건강이 양호합니다.' },
    },
  },
  '8-6-3': {
    name: '곤간감(坤艮坎)',
    meaning: '땅과 산과 물이 만나니 막힘의 상',
    fortune: '주의가 필요한 해입니다. 일이 막힐 수 있으니 무리하지 말고 현상 유지에 집중하세요.',
    advice: '현상 유지에 집중하세요. 무리한 일은 피하세요.',
    score: 50,
    seasonal: {
      spring: '봄에는 조심스럽게 시작하세요.',
      summer: '여름에는 더 조심하세요.',
      autumn: '가을에는 조금 나아집니다.',
      winter: '겨울에는 내년을 기약하세요.',
    },
    monthly: ['주의', '주의', '보통', '주의', '보통', '주의', '보통', '주의', '보통', '보통', '주의', '주의'],
    category: {
      wealth: { score: 45, text: '재물 손실에 주의하세요. 투자는 피하세요.' },
      career: { score: 52, text: '현 위치에서 버티세요.' },
      love: { score: 48, text: '관계가 막힐 수 있습니다.' },
      health: { score: 50, text: '건강에 특히 주의하세요.' },
    },
  },
  '7-5-3': {
    name: '간손감(艮巽坎)',
    meaning: '산과 바람과 물이 만나니 변동의 상',
    fortune: '변동이 많을 수 있습니다. 신중하게 행동하고 큰 결정은 미루세요.',
    advice: '큰 결정은 미루세요. 신중하게 행동하세요.',
    score: 55,
    seasonal: {
      spring: '봄에는 변화에 주의하세요.',
      summer: '여름에는 수해에 주의하세요.',
      autumn: '가을에는 조금 안정됩니다.',
      winter: '겨울에는 다음을 기약하세요.',
    },
    monthly: ['주의', '보통', '주의', '보통', '보통', '주의', '보통', '보통', '길', '보통', '보통', '주의'],
    category: {
      wealth: { score: 52, text: '예상치 못한 지출에 주의하세요.' },
      career: { score: 58, text: '변화에 대비하세요.' },
      love: { score: 55, text: '관계의 변동이 있을 수 있습니다.' },
      health: { score: 55, text: '사고에 주의하세요.' },
    },
  },
};

// 기본 괘 해석 (144괘 중 정의되지 않은 것들을 위한 기본값)
function getDefaultTojeongFortune(upperGua: number, middleGua: number, lowerGua: number): {
  name: string; meaning: string; fortune: string; advice: string; score: number;
} {
  const guaNames = ['건', '태', '이', '진', '손', '감', '간', '곤'];
  const baseScore = 60 + (upperGua * 2) + (middleGua * 3) - (lowerGua * 2);
  const score = Math.max(45, Math.min(90, baseScore));

  return {
    name: `${guaNames[upperGua - 1] || '건'}${guaNames[middleGua - 1] || '건'}${guaNames[lowerGua - 1] || '건'}괘`,
    meaning: '괘상 해석',
    fortune: score >= 80 ? '길운이 함께하는 해입니다. 적극적으로 활동하세요.' :
             score >= 65 ? '보통의 운입니다. 꾸준히 노력하면 좋은 결과가 있습니다.' :
             '주의가 필요한 해입니다. 무리하지 말고 내실을 다지세요.',
    advice: score >= 80 ? '좋은 기회를 놓치지 마세요.' :
            score >= 65 ? '인내심을 갖고 노력하세요.' :
            '조심스럽게 행동하고 건강에 유의하세요.',
    score,
  };
}

/**
 * 개선된 토정비결 운세 생성 함수
 */
export function generateImprovedTojeongFortune(birthDate: string, lunarBirthMonth?: number, dayMaster: string = '갑', targetDate: Date = new Date()) {
  const [yearStr, monthStr, dayStr] = birthDate.split('-');
  const birthYear = parseInt(yearStr, 10);
  const birthMonth = lunarBirthMonth || parseInt(monthStr, 10);
  const birthDay = parseInt(dayStr, 10);

  const currentYear = targetDate.getFullYear();
  const age = currentYear - birthYear + 1; // 한국 나이

  // 태세 (연도의 지지 수) - 간략화: 연도 % 12
  const taeSe = ((birthYear - 4) % 12) + 1;

  // 상괘 계산: (태세 + 나이) % 8, 0이면 8
  let upperGua = (taeSe + age) % 8;
  if (upperGua === 0) upperGua = 8;

  // 월건 수
  const monthNumber = MONTH_NUMBERS[birthMonth] || 1;

  // 중괘 계산: (월건 수 + 나이) % 6, 0이면 6
  let middleGua = (monthNumber + age) % 6;
  if (middleGua === 0) middleGua = 6;

  // 하괘 계산: (일진 수 + 나이) % 3, 0이면 3
  let lowerGua = (birthDay + age) % 3;
  if (lowerGua === 0) lowerGua = 3;

  // 괘 키 생성
  const guaKey = `${upperGua}-${middleGua}-${lowerGua}`;

  // 해당 괘 해석 찾기
  const fortune = TOJEONG_144_FORTUNES[guaKey] || getDefaultTojeongFortune(upperGua, middleGua, lowerGua);

  return {
    summary: fortune.fortune,
    score: fortune.score,
    guaInfo: {
      upper: upperGua,
      middle: middleGua,
      lower: lowerGua,
      name: fortune.name,
      meaning: fortune.meaning,
    },
    categories: [
      {
        emoji: '📜',
        title: '괘상 해석',
        content: `${currentYear}년 당신의 괘는 "${fortune.name}"입니다.\n\n${fortune.meaning}\n\n${fortune.fortune}`,
        advice: fortune.advice,
        score: fortune.score,
      },
      {
        emoji: '💰',
        title: '재물운',
        content: fortune.score >= 80 ? '재물이 모이는 상입니다. 투자나 저축에 좋은 해입니다.' :
                 fortune.score >= 65 ? '안정적인 재물운입니다. 무리하지 않으면 좋은 결과가 있습니다.' :
                 fortune.score >= 50 ? '보통의 재물운입니다. 절약하고 검소하게 생활하세요.' :
                 '재물 손실에 주의하세요. 투자보다 저축이 좋습니다.',
        score: Math.max(40, fortune.score - 5),
      },
      {
        emoji: '👔',
        title: '직업운',
        content: fortune.score >= 80 ? '승진이나 성공의 기회가 많습니다. 적극적으로 도전하세요.' :
                 fortune.score >= 65 ? '안정적인 직업운입니다. 꾸준히 노력하면 인정받습니다.' :
                 fortune.score >= 50 ? '무난한 직업운입니다. 현재 위치에서 최선을 다하세요.' :
                 '직장 생활에 어려움이 있을 수 있습니다. 인내가 필요합니다.',
        score: Math.max(40, fortune.score - 3),
      },
      {
        emoji: '❤️',
        title: '가정/인연운',
        content: fortune.score >= 80 ? '가정에 경사가 있을 수 있습니다. 좋은 인연도 기대됩니다.' :
                 fortune.score >= 65 ? '가족 간 화목한 해입니다. 인연운도 좋습니다.' :
                 fortune.score >= 50 ? '평화로운 가정운입니다. 감사하는 마음을 갖으세요.' :
                 '가족 간 갈등에 주의하세요. 대화로 풀어가세요.',
        score: Math.max(40, fortune.score - 8),
      },
      {
        emoji: '🏥',
        title: '건강운',
        content: fortune.score >= 80 ? '건강운이 좋습니다. 활력이 넘치는 한 해입니다.' :
                 fortune.score >= 65 ? '보통의 건강운입니다. 규칙적인 생활이 중요합니다.' :
                 fortune.score >= 50 ? '건강에 조금 더 신경 쓰세요. 무리하지 마세요.' :
                 '건강 관리에 특히 주의하세요. 정기 검진을 권합니다.',
        score: Math.max(40, fortune.score - 10),
      },
    ],
    luckyInfo: getYongsinBasedLuckyInfo(dayMaster),
    tip: fortune.score >= 70
      ? '좋은 운에 겸손과 감사가 더해지면 복이 배가 됩니다.'
      : '올해는 내실을 다지는 해입니다. 차근차근 준비하면 다음 해에 더 큰 성과를 얻을 수 있습니다.',
    calculationMethod: `상괘(${upperGua}) × 중괘(${middleGua}) × 하괘(${lowerGua}) = ${guaKey}`,
  };
}

// 일간별 궁합 띠 - 삼합/육합 기반
const COMPATIBLE_ANIMALS: Record<string, { good: string[]; reason: string }> = {
  '갑': { good: ['호랑이띠', '토끼띠', '용띠'], reason: '목(木) 기운과 삼합/육합하는 띠입니다.' },
  '을': { good: ['호랑이띠', '토끼띠', '양띠'], reason: '목(木) 기운과 조화로운 띠입니다.' },
  '병': { good: ['뱀띠', '말띠', '양띠'], reason: '화(火) 기운과 삼합하는 띠입니다.' },
  '정': { good: ['뱀띠', '말띠', '개띠'], reason: '화(火) 기운과 조화로운 띠입니다.' },
  '무': { good: ['소띠', '용띠', '원숭이띠'], reason: '토(土) 기운과 삼합하는 띠입니다.' },
  '기': { good: ['소띠', '닭띠', '돼지띠'], reason: '토(土) 기운과 조화로운 띠입니다.' },
  '경': { good: ['원숭이띠', '닭띠', '뱀띠'], reason: '금(金) 기운과 삼합하는 띠입니다.' },
  '신': { good: ['원숭이띠', '닭띠', '용띠'], reason: '금(金) 기운과 조화로운 띠입니다.' },
  '임': { good: ['쥐띠', '돼지띠', '용띠'], reason: '수(水) 기운과 삼합하는 띠입니다.' },
  '계': { good: ['쥐띠', '돼지띠', '소띠'], reason: '수(水) 기운과 조화로운 띠입니다.' },
};

// 십이시진(十二時辰) - 하루의 길운 시간대
const LUCKY_TIME_SLOTS = [
  { name: '자시(子時)', time: '밤 11시~새벽 1시', element: '수(水)', suitable: ['임', '계', '갑', '을'] },
  { name: '축시(丑時)', time: '새벽 1시~3시', element: '토(土)', suitable: ['무', '기', '경', '신'] },
  { name: '인시(寅時)', time: '새벽 3시~5시', element: '목(木)', suitable: ['갑', '을', '병', '정'] },
  { name: '묘시(卯時)', time: '새벽 5시~7시', element: '목(木)', suitable: ['갑', '을', '병', '정'] },
  { name: '진시(辰時)', time: '오전 7시~9시', element: '토(土)', suitable: ['무', '기', '경', '신'] },
  { name: '사시(巳時)', time: '오전 9시~11시', element: '화(火)', suitable: ['병', '정', '무', '기'] },
  { name: '오시(午時)', time: '오전 11시~오후 1시', element: '화(火)', suitable: ['병', '정', '무', '기'] },
  { name: '미시(未時)', time: '오후 1시~3시', element: '토(土)', suitable: ['무', '기', '경', '신'] },
  { name: '신시(申時)', time: '오후 3시~5시', element: '금(金)', suitable: ['경', '신', '임', '계'] },
  { name: '유시(酉時)', time: '오후 5시~7시', element: '금(金)', suitable: ['경', '신', '임', '계'] },
  { name: '술시(戌時)', time: '저녁 7시~9시', element: '토(土)', suitable: ['무', '기', '경', '신'] },
  { name: '해시(亥時)', time: '밤 9시~11시', element: '수(水)', suitable: ['임', '계', '갑', '을'] },
];

export function generateLuckyInfo(birthDate: string, dayMaster?: string, targetDate: Date = new Date()) {
  const dateHash = birthDate.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
  const todayHash = targetDate.getDate() + targetDate.getMonth() * 31 + targetDate.getFullYear();
  const combinedHash = dateHash + todayHash;

  const dm = dayMaster || '갑';

  // 용신 색상
  const colorInfo = YONGSHIN_COLORS[dm] || YONGSHIN_COLORS['갑'];

  // 용신 방향
  const directionInfo = YONGSHIN_DIRECTIONS[dm] || YONGSHIN_DIRECTIONS['갑'];

  // 행운의 물건
  const itemInfo = YONGSHIN_ITEMS[dm] || YONGSHIN_ITEMS['갑'];

  // 기신 (피해야 할 것)
  const gishinInfo = GISHIN_WARNINGS[dm] || GISHIN_WARNINGS['갑'];

  // 궁합 띠
  const compatibleInfo = COMPATIBLE_ANIMALS[dm] || COMPATIBLE_ANIMALS['갑'];

  // 행운의 숫자 (하도낙서 기반 오행 숫자)
  const elementNumbers: Record<string, string> = {
    '목(木)': '3, 8',
    '화(火)': '2, 7',
    '토(土)': '5, 10',
    '금(金)': '4, 9',
    '수(水)': '1, 6',
  };
  const luckyNumbers = elementNumbers[colorInfo.element] || '5, 10';

  // 길운 시간대 (일간에 맞는 시간대 찾기)
  const suitableTimes = LUCKY_TIME_SLOTS.filter(slot =>
    slot.suitable.includes(dm)
  );
  // 오늘 날짜에 따라 시간대 선택
  const selectedTime = suitableTimes[combinedHash % suitableTimes.length] || LUCKY_TIME_SLOTS[5];

  // 오행 상생 조언
  const elementAdvice: Record<string, string> = {
    '목(木)': '나무의 기운처럼 성장과 발전에 좋은 날입니다. 새로운 시작이나 계획에 적합합니다.',
    '화(火)': '불의 기운처럼 활력과 열정이 넘치는 날입니다. 적극적인 활동에 좋습니다.',
    '토(土)': '흙의 기운처럼 안정과 신뢰가 중요한 날입니다. 중재나 조정에 적합합니다.',
    '금(金)': '쇠의 기운처럼 결단과 실행이 중요한 날입니다. 마무리나 정리에 좋습니다.',
    '수(水)': '물의 기운처럼 지혜와 유연함이 중요한 날입니다. 학습이나 연구에 적합합니다.',
  };

  return {
    summary: `오늘의 길운 정보입니다.\n\n${dm} 일간에게 ${colorInfo.element} 기운이 도움이 됩니다.`,
    score: 75 + (combinedHash % 15),
    categories: [
      {
        emoji: '🎨',
        title: '행운의 색상',
        content: `${colorInfo.color}\n\n${colorInfo.reason}`,
        score: 80 + (combinedHash % 10),
      },
      {
        emoji: '🔢',
        title: '행운의 숫자',
        content: `${luckyNumbers}\n\n${colorInfo.element}의 오행에 해당하는 하도낙서(河圖洛書) 기반 숫자입니다.`,
        score: 75 + (combinedHash % 15),
      },
      {
        emoji: '🧭',
        title: '행운의 방향',
        content: `${directionInfo.direction}\n\n${directionInfo.reason}`,
        score: 78 + (combinedHash % 12),
      },
      {
        emoji: '⏰',
        title: '길운 시간대',
        content: `${selectedTime.name} (${selectedTime.time})\n\n${selectedTime.element}의 기운이 흐르는 시간으로, ${dm} 일간에게 좋은 시간대입니다.`,
        score: 77 + (combinedHash % 13),
      },
      {
        emoji: '🎁',
        title: '행운의 물건',
        content: `${itemInfo.item}\n\n${itemInfo.reason}`,
        score: 76 + (combinedHash % 14),
      },
      {
        emoji: '🤝',
        title: '오늘 함께하면 좋은 띠',
        content: `${compatibleInfo.good.join(', ')}\n\n${compatibleInfo.reason}`,
        score: 74 + (combinedHash % 16),
      },
      {
        emoji: '⚠️',
        title: '주의할 점',
        content: `피하면 좋은 색상: ${gishinInfo.color}\n피하면 좋은 방향: ${gishinInfo.direction}\n\n${gishinInfo.reason}`,
        score: 70,
      },
    ],
    luckyInfo: {
      color: colorInfo.color,
      number: luckyNumbers,
      direction: directionInfo.direction,
      item: itemInfo.item,
    },
    advice: elementAdvice[colorInfo.element] || elementAdvice['토(土)'],
  };
}

// ============================================
// 종합운세 (모든 운세를 하나로 통합)
// ============================================

export interface ComprehensiveFortune {
  // 기본 정보
  userName: string;
  birthDate: string;
  dayMaster: string;
  generatedAt: string;

  // 종합 점수 및 요약
  overallScore: number;
  overallSummary: string;
  todayKeywords: string[];

  // 오늘의 일간 운세 (기본 운세)
  dailyFortune: {
    summary: string;
    scores: {
      overall: number;
      love: number;
      money: number;
      work: number;
      health: number;
    };
    elementAnalysis: string;
    branchAnalysis: string;
    doList: string[];
    dontList: string[];
  };

  // 신년운세 (십신 기반)
  yearlyFortune: {
    summary: string;
    tenGod: string;
    yearInfo: string;
    score: number;
    highlights: string[];
  };

  // 띠운세
  animalFortune: {
    animal: string;
    emoji: string;
    summary: string;
    score: number;
    personality: string;
  };

  // 별자리운세
  zodiacFortune: {
    sign: string;
    emoji: string;
    element: string;
    summary: string;
    score: number;
  };

  // 토정비결
  tojeongFortune: {
    gwae: string;
    summary: string;
    score: number;
    luckyLevel: string;
  };

  // 오령 분석 (오행 균형)
  fiveSpiritsAnalysis: {
    balance: string;
    dominant: string;
    lacking: string;
    advice: string;
  };

  // 길운 정보
  luckyInfo: {
    color: string;
    number: string;
    direction: string;
    item: string;
    time: string;
  };

  // 종합 조언
  comprehensiveAdvice: {
    morning: string;
    afternoon: string;
    evening: string;
    overall: string;
  };
}

export function generateComprehensiveFortune(
  birthDate: string,
  dayMaster: string,
  userName: string = '사용자',
  targetDate?: Date  // 운세를 볼 날짜 (기본값: 오늘)
): ComprehensiveFortune {
  const fortuneDate = targetDate || new Date();
  const dateStr = fortuneDate.toISOString().split('T')[0];
  const dateHash = birthDate.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
  const fortuneDateHash = fortuneDate.getDate() + fortuneDate.getMonth() * 31 + fortuneDate.getFullYear();
  const combinedHash = dateHash + fortuneDateHash;

  // 1. 신년운세 생성 (선택 날짜 기준)
  const yearly = generateYearlyFortune(birthDate, dayMaster, fortuneDate);

  // 2. 띠운세 생성
  const animal = generateAnimalFortune(birthDate, dayMaster);

  // 3. 별자리운세 생성 (선택 날짜 기준)
  const zodiac = generateZodiacFortune(birthDate, dayMaster, fortuneDate);

  // 4. 토정비결 생성 (선택 날짜 기준)
  const tojeong = generateImprovedTojeongFortune(birthDate, undefined, dayMaster, fortuneDate);

  // 5. 오행 균형 분석 (간단한 분석)
  const elementMap: Record<string, string> = {
    '갑': '목', '을': '목', '병': '화', '정': '화', '무': '토',
    '기': '토', '경': '금', '신': '금', '임': '수', '계': '수',
  };
  const dayMasterElement = elementMap[dayMaster] || '목';

  // 생년월일에서 간단히 오행 분포 추정
  const elementHash = birthDate.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
  const fakeElements: Record<string, number> = {
    '목': 1 + (elementHash % 3),
    '화': 1 + ((elementHash + 1) % 3),
    '토': 1 + ((elementHash + 2) % 3),
    '금': 1 + ((elementHash + 3) % 3),
    '수': 1 + ((elementHash + 4) % 3),
  };
  const fiveSpirits = analyzeFiveSpirits(dayMasterElement, fakeElements);

  // 6. 길운 정보 생성 (선택 날짜 기준)
  const lucky = generateLuckyInfo(birthDate, dayMaster, fortuneDate);

  // 7. 일진(日辰) 기반 일별 운세 변동 계산
  // 60갑자 일주기를 기반으로 날짜마다 다른 점수 변동
  const dayOfYear = Math.floor((fortuneDate.getTime() - new Date(fortuneDate.getFullYear(), 0, 0).getTime()) / (1000 * 60 * 60 * 24));
  const dailyIndex = (dayOfYear + dateHash) % 60; // 60갑자 주기

  // 일별 점수 변동 (-10 ~ +10)
  const dailyVariation = Math.sin(dailyIndex * Math.PI / 30) * 10;

  // 요일별 추가 변동 (-3 ~ +3)
  const dayOfWeek = fortuneDate.getDay();
  const weekdayVariation = [2, -1, 0, 1, 3, 2, -2][dayOfWeek]; // 일월화수목금토

  // 종합 점수 계산 (각 운세 점수의 가중 평균 + 일별 변동)
  const baseScore = Math.round(
    (yearly.score * 0.25) +
    (animal.score * 0.2) +
    ((zodiac.score || 75) * 0.15) +
    (tojeong.score * 0.2) +
    ((lucky.score || 75) * 0.2)
  );

  // 최종 점수 (50~95 범위로 제한)
  const overallScore = Math.max(50, Math.min(95, Math.round(baseScore + dailyVariation + weekdayVariation)));

  // 십신 한글명
  const tenGodNames: Record<string, string> = {
    '비견': '비견(比肩) - 형제자매, 동료의 해',
    '겁재': '겁재(劫財) - 경쟁과 도전의 해',
    '식신': '식신(食神) - 창의와 표현의 해',
    '상관': '상관(傷官) - 변화와 혁신의 해',
    '정재': '정재(正財) - 안정적 재물의 해',
    '편재': '편재(偏財) - 투자와 기회의 해',
    '정관': '정관(正官) - 승진과 명예의 해',
    '편관': '편관(偏官) - 도전과 극복의 해',
    '정인': '정인(正印) - 학습과 성장의 해',
    '편인': '편인(偏印) - 지혜와 깨달음의 해',
  };

  // 오행 분석 텍스트 생성
  const elementAnalysisText = `용신: ${fiveSpirits.yongsin.element}(${fiveSpirits.yongsin.hanja}), 희신: ${fiveSpirits.heesin.element}(${fiveSpirits.heesin.hanja})`;

  // 오늘의 키워드 생성 (날짜별로 다르게)
  const keywordPool = [
    '성장', '발전', '기회', '행운', '만남', '성공', '건강', '화합',
    '창의', '도전', '안정', '소통', '집중', '균형', '신뢰', '변화',
    '시작', '완성', '협력', '지혜', '인내', '기쁨', '풍요', '평화'
  ];
  // dailyIndex와 combinedHash를 조합하여 날짜마다 다른 키워드 선택
  const keywordSeed = dailyIndex * 7 + combinedHash;
  const selectedKeywords = [
    keywordPool[keywordSeed % keywordPool.length],
    keywordPool[(keywordSeed + 5) % keywordPool.length],
    keywordPool[(keywordSeed + 11) % keywordPool.length],
  ];

  // 시간대별 조언 생성 (날짜에 따라 다르게)
  const morningAdvices = [
    `아침에는 ${dayMaster} 일간의 기운을 살려 차분하게 하루를 시작하세요. 명상이나 가벼운 운동으로 에너지를 충전하면 좋습니다.`,
    `오늘 아침은 ${selectedKeywords[0]}의 기운이 강합니다. 일찍 일어나 중요한 일을 처리하세요.`,
    `${fortuneDate.getMonth() + 1}월의 기운과 함께 상쾌하게 시작하세요. 아침 식사를 꼭 챙기면 운기가 상승합니다.`,
    `오전 시간대가 가장 좋은 기운을 받습니다. 중요한 연락이나 결정은 아침에 하세요.`,
    `${dayMasterElement}의 기운으로 하루를 열어보세요. 짧은 산책이나 스트레칭이 도움됩니다.`,
  ];
  const afternoonAdvices = [
    `오후에는 적극적인 활동이 좋습니다. ${yearly.yearInfo.tenGod}의 기운이 강해지는 시간이니 중요한 미팅이나 결정은 이 시간대에 하세요.`,
    `점심 후에는 ${selectedKeywords[1]}에 집중하면 좋은 결과가 있습니다.`,
    `오후 2시~4시 사이가 집중력이 높아지는 시간입니다. 복잡한 업무는 이때 처리하세요.`,
    `사람들과의 교류가 좋은 시간대입니다. 협력 관계를 강화하세요.`,
    `창의적인 아이디어가 떠오르는 시간입니다. 메모해두면 나중에 도움이 됩니다.`,
  ];
  const eveningAdvices = [
    `저녁에는 휴식과 재충전의 시간으로 활용하세요. 가족이나 친한 사람들과 시간을 보내면 운기가 상승합니다.`,
    `하루를 정리하며 내일을 준비하세요. ${selectedKeywords[2]}을 되새기면 좋습니다.`,
    `저녁 식사 후 가벼운 산책이 건강과 운기에 도움됩니다.`,
    `오늘 감사한 일 세 가지를 적어보세요. 긍정적인 에너지가 쌓입니다.`,
    `충분한 수면을 취하세요. 내일의 좋은 운기는 오늘 밤의 휴식에서 시작됩니다.`,
  ];

  const timeAdvice = {
    morning: morningAdvices[dailyIndex % morningAdvices.length],
    afternoon: afternoonAdvices[(dailyIndex + 2) % afternoonAdvices.length],
    evening: eveningAdvices[(dailyIndex + 4) % eveningAdvices.length],
    overall: `오늘의 핵심은 '${selectedKeywords[0]}'입니다. ${animal.animalInfo?.name || ''}의 지혜를 발휘하여 ${zodiac.categories?.[0]?.advice || '현명하게 대처'}하세요.`,
  };

  // 할일/피할일 생성 (날짜별로 다르게)
  const doListPool = [
    `${lucky.luckyInfo?.color || '행운의 색상'} 계열의 옷이나 소품 착용하기`,
    `${lucky.luckyInfo?.direction || '동쪽'} 방향으로 이동하거나 앉기`,
    yearly.yearInfo.tenGod === '정재' || yearly.yearInfo.tenGod === '편재'
      ? '재테크나 저축 관련 활동하기'
      : '자기계발이나 학습에 시간 투자하기',
    `${animal.animalInfo?.name || '띠'}와 궁합이 좋은 사람과 교류하기`,
    '감사한 마음으로 하루를 시작하기',
    '물을 충분히 마시며 건강 관리하기',
    '새로운 사람과의 만남에 열린 마음 갖기',
    `${selectedKeywords[0]}을 실천하면 좋은 결과가 있습니다`,
    '오전 중에 중요한 일 처리하기',
    '가벼운 운동으로 활력 충전하기',
  ];
  const doList = [
    doListPool[dailyIndex % doListPool.length],
    doListPool[(dailyIndex + 2) % doListPool.length],
    doListPool[(dailyIndex + 4) % doListPool.length],
    doListPool[(dailyIndex + 6) % doListPool.length],
    doListPool[(dailyIndex + 8) % doListPool.length],
  ].filter((item, index, self) => self.indexOf(item) === index).slice(0, 5);

  const dontListPool = [
    '무리한 투자나 충동적인 결정 피하기',
    '불필요한 다툼이나 갈등 회피하기',
    '과로와 스트레스 주의하기',
    '음주와 과식 절제하기',
    '중요한 결정은 충분히 생각 후에 하기',
    '급한 마음으로 서두르지 않기',
    '험한 말이나 부정적인 표현 삼가기',
    '늦은 밤까지 일하지 않기',
    '무리한 약속이나 계획 자제하기',
    '타인의 말에 쉽게 휘둘리지 않기',
  ];
  const dontList = [
    dontListPool[(dailyIndex + 1) % dontListPool.length],
    dontListPool[(dailyIndex + 3) % dontListPool.length],
    dontListPool[(dailyIndex + 5) % dontListPool.length],
    dontListPool[(dailyIndex + 7) % dontListPool.length],
    dontListPool[(dailyIndex + 9) % dontListPool.length],
  ].filter((item, index, self) => self.indexOf(item) === index).slice(0, 5);

  // 종합 요약 생성
  const overallSummary = `${userName}님, ${dateStr} 오늘의 종합운세입니다. ` +
    `${yearly.yearInfo.year}년 ${yearly.yearInfo.tenGod}(${tenGodNames[yearly.yearInfo.tenGod]?.split(' - ')[1] || '운세'})의 기운 아래, ` +
    `${animal.animalInfo?.name || '띠'}의 특성과 ${zodiac.categories?.[0]?.title || '별자리'}의 에너지가 조화를 이룹니다. ` +
    `오늘 종합점수는 ${overallScore}점으로, ${overallScore >= 80 ? '매우 좋은' : overallScore >= 70 ? '좋은' : overallScore >= 60 ? '무난한' : '조심해야 할'} 하루가 예상됩니다.`;

  return {
    userName,
    birthDate,
    dayMaster,
    generatedAt: fortuneDate.toISOString(),

    overallScore,
    overallSummary,
    todayKeywords: selectedKeywords,

    dailyFortune: {
      summary: `${dayMaster} 일간의 오늘 운세입니다. ${fiveSpirits.advice || '균형잡힌 하루를 보내세요.'}`,
      scores: {
        overall: overallScore,
        love: 70 + (combinedHash % 20),
        money: 68 + ((combinedHash + 5) % 22),
        work: 72 + ((combinedHash + 10) % 18),
        health: 75 + ((combinedHash + 15) % 15),
      },
      elementAnalysis: elementAnalysisText,
      branchAnalysis: '음양 균형 상태',
      doList,
      dontList,
    },

    yearlyFortune: {
      summary: yearly.summary,
      tenGod: yearly.yearInfo.tenGod,
      yearInfo: `${yearly.yearInfo.year}년 ${yearly.yearInfo.name} (${yearly.yearInfo.animal})`,
      score: yearly.score,
      highlights: yearly.categories.slice(0, 3).map(c => `${c.emoji} ${c.title}: ${c.content.substring(0, 50)}...`),
    },

    animalFortune: {
      animal: animal.animalInfo?.name || '띠',
      emoji: animal.animalInfo?.emoji || '🐾',
      summary: animal.summary,
      score: animal.score,
      personality: animal.animalInfo?.personality || '',
    },

    zodiacFortune: {
      sign: zodiac.summary.split('\n')[0] || '별자리',
      emoji: zodiac.summary.includes('♈') ? '♈' : zodiac.summary.split(' ')[0] || '⭐',
      element: zodiac.categories?.[0]?.title || '원소',
      summary: zodiac.categories?.[0]?.content || '',
      score: zodiac.score || 75,
    },

    tojeongFortune: {
      gwae: tojeong.guaInfo?.name || '괘',
      summary: tojeong.summary,
      score: tojeong.score,
      luckyLevel: tojeong.score >= 85 ? '대길(大吉)' : tojeong.score >= 70 ? '길(吉)' : tojeong.score >= 55 ? '평(平)' : '흉(凶)',
    },

    fiveSpiritsAnalysis: {
      balance: fiveSpirits.summary || '오행 균형 분석',
      dominant: fiveSpirits.yongsin?.element || '균형',
      lacking: fiveSpirits.gisin?.element || '없음',
      advice: fiveSpirits.advice || '균형잡힌 생활을 유지하세요.',
    },

    luckyInfo: {
      color: lucky.luckyInfo?.color || '초록색',
      number: lucky.luckyInfo?.number || '3, 8',
      direction: lucky.luckyInfo?.direction || '동쪽',
      item: lucky.luckyInfo?.item || '식물',
      time: lucky.categories?.find(c => c.title === '길운 시간대')?.content?.split('\n')[0] || '오전',
    },

    comprehensiveAdvice: timeAdvice,
  };
}
